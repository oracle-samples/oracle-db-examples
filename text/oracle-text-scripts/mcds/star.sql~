connect sys/password as sysdba

drop user testuser cascade;

grant connect,resource,ctxapp,unlimited tablespace to testuser identified by testuser;

connect testuser/testuser

create table testtable (fitemguid varchar2(50), fitemname varchar2(50), fsomething varchar2(40));

insert into testtable values ('abcdefg', 'Baseballs.png', 'helloworld');

begin
  ctx_ddl.create_preference('"FT_CLOUDOTSCOLL2_DST"','MULTI_COLUMN_DATASTORE');
  ctx_ddl.set_attribute('"FT_CLOUDOTSCOLL2_DST"','COLUMNS','*');
end;
/

begin
  ctx_ddl.create_preference('"FT_CLOUDOTSCOLL2_FIL"','NULL_FILTER');
end;
/

begin
  ctx_ddl.create_section_group('"FT_CLOUDOTSCOLL2_SGP"','BASIC_SECTION_GROUP');
  ctx_ddl.add_sdata_section('"FT_CLOUDOTSCOLL2_SGP"','SDFITEMNAME','SDFITEMNAME','VARCHAR2');
  ctx_ddl.add_sdata_section('"FT_CLOUDOTSCOLL2_SGP"','SDFOWNERFULLNAME','SDFOWNERFULLNAME','VARCHAR2');
  ctx_ddl.add_sdata_section('"FT_CLOUDOTSCOLL2_SGP"','SDFLASTMODIFIERFULLNAME','SDFLASTMODIFIERFULLNAME','VARCHAR2');
  ctx_ddl.add_sdata_section('"FT_CLOUDOTSCOLL2_SGP"','SDXCAASGUID','SDXCAASGUID','VARCHAR2');
  ctx_ddl.add_sdata_section('"FT_CLOUDOTSCOLL2_SGP"','SDXPUBLISHEDTARGETS','SDXPUBLISHEDTARGETS','VARCHAR2');
  ctx_ddl.add_sdata_section('"FT_CLOUDOTSCOLL2_SGP"','SDFITEMTYPE','SDFITEMTYPE','VARCHAR2');
  ctx_ddl.add_sdata_column('"FT_CLOUDOTSCOLL2_SGP"','FLASTMODIFIEDDATE','"FLASTMODIFIEDDATE"');
  ctx_ddl.add_sdata_section('"FT_CLOUDOTSCOLL2_SGP"','SDDDOCFORMATTYPE','SDDDOCFORMATTYPE','VARCHAR2');
  ctx_ddl.add_sdata_section('"FT_CLOUDOTSCOLL2_SGP"','SDXAPPROVALSTATE','SDXAPPROVALSTATE','VARCHAR2');
  ctx_ddl.add_sdata_column('"FT_CLOUDOTSCOLL2_SGP"','FCREATEDATE','"FCREATEDATE"');
  ctx_ddl.add_sdata_column('"FT_CLOUDOTSCOLL2_SGP"','XPUBLISHEDVERSION','"XPUBLISHEDVERSION"');
  ctx_ddl.add_sdata_section('"FT_CLOUDOTSCOLL2_SGP"','SDFITEMGUID','SDFITEMGUID','VARCHAR2');
  ctx_ddl.add_sdata_section('"FT_CLOUDOTSCOLL2_SGP"','SDFTARGETGUID','SDFTARGETGUID','VARCHAR2');
  ctx_ddl.add_sdata_column('"FT_CLOUDOTSCOLL2_SGP"','DFILESIZE','"DFILESIZE"');
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','XAPPROVALSTATE','XAPPROVALSTATE',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','FLASTMODIFIER','FLASTMODIFIER',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','DDOCFORMATTYPE','DDOCFORMATTYPE',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','FOWNER','FOWNER',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','XCAASGUID','XCAASGUID',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','COLLECTIONGUIDS','COLLECTIONGUIDS',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','FCREATOR','FCREATOR',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','FOWNERLOGINNAME','FOWNERLOGINNAME',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','FCREATORLOGINNAME','FCREATORLOGINNAME',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','FLASTMODIFIERLOGINNAME','FLASTMODIFIERLOGINNAME',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','OTSMETA','OTSMETA',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','DRENDITION1','DRENDITION1',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','FCREATORFULLNAME','FCREATORFULLNAME',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','DRENDITION2','DRENDITION2',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','FITEMTYPE','FITEMTYPE',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','FPARENTGUIDS','FPARENTGUIDS',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','FITEMGUID','FITEMGUID',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','FPARENTGUID','FPARENTGUID',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','DREVLABEL','DREVLABEL',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','XPUBLISHEDTARGETS','XPUBLISHEDTARGETS',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','FTARGETGUID','FTARGETGUID',FALSE);
  ctx_ddl.add_zone_section('"FT_CLOUDOTSCOLL2_SGP"','FITEMNAME','FITEMNAME');
  ctx_ddl.add_zone_section('"FT_CLOUDOTSCOLL2_SGP"','FFOLDERDESCRIPTION','FFOLDERDESCRIPTION');
  ctx_ddl.add_zone_section('"FT_CLOUDOTSCOLL2_SGP"','FOWNERFULLNAME','FOWNERFULLNAME');
  ctx_ddl.add_zone_section('"FT_CLOUDOTSCOLL2_SGP"','DCONTENTS','DCONTENTS');
  ctx_ddl.add_zone_section('"FT_CLOUDOTSCOLL2_SGP"','FLASTMODIFIERFULLNAME','FLASTMODIFIERFULLNAME');
  ctx_ddl.add_zone_section('"FT_CLOUDOTSCOLL2_SGP"','CUSTOMMETADATA','CUSTOMMETADATA');
  ctx_ddl.add_zone_section('"FT_CLOUDOTSCOLL2_SGP"','DEXTENSION','DEXTENSION');
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','XTAG','XTAG',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','XIDCTESTSEARCHDISABLEMETAFIELD','XIDCTESTSEARCHDISABLEMETAFIELD',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','XIDCTESTSEARCHDELETEMETAFIELD','XIDCTESTSEARCHDELETEMETAFIELD',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','XSEARCHUNASSIGNMETAFIELD','XSEARCHUNASSIGNMETAFIELD',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','XTAGS','XTAGS',FALSE);
  ctx_ddl.add_field_section('"FT_CLOUDOTSCOLL2_SGP"','XCATEGORIES','XCATEGORIES',FALSE);
end;
/

begin
  ctx_ddl.create_preference('"FT_CLOUDOTSCOLL2_LEX"','WORLD_LEXER');
end;
/

begin
  ctx_ddl.create_preference('"FT_CLOUDOTSCOLL2_WDL"','BASIC_WORDLIST');
  ctx_ddl.set_attribute('"FT_CLOUDOTSCOLL2_WDL"','STEMMER','ENGLISH');
  ctx_ddl.set_attribute('"FT_CLOUDOTSCOLL2_WDL"','FUZZY_MATCH','GENERIC');
end;
/

begin
  ctx_ddl.create_stoplist('"FT_CLOUDOTSCOLL2_SPL"','BASIC_STOPLIST');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','Mr');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','Mrs');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','Ms');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','a');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','all');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','almost');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','also');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','although');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','an');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','and');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','any');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','are');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','as');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','at');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','be');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','because');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','been');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','both');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','but');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','by');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','can');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','could');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','d');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','did');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','do');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','does');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','either');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','for');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','from');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','had');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','has');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','have');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','having');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','he');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','her');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','here');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','hers');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','him');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','his');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','how');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','however');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','i');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','if');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','in');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','into');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','is');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','it');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','its');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','just');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','ll');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','me');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','might');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','my');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','no');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','non');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','nor');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','not');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','of');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','on');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','one');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','only');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','onto');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','or');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','our');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','ours');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','s');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','shall');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','she');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','should');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','since');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','so');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','some');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','still');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','such');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','t');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','than');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','that');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','the');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','their');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','them');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','then');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','there');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','therefore');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','these');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','they');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','this');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','those');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','though');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','through');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','thus');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','to');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','too');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','until');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','ve');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','very');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','was');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','we');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','were');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','what');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','when');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','where');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','whether');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','which');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','while');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','who');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','whose');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','why');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','will');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','with');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','would');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','yet');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','you');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','your');
  ctx_ddl.add_stopword('"FT_CLOUDOTSCOLL2_SPL"','yours');
end;
/

begin
  ctx_ddl.create_preference('"FT_CLOUDOTSCOLL2_STO"','BASIC_STORAGE');
  ctx_ddl.set_attribute('"FT_CLOUDOTSCOLL2_STO"','R_TABLE_CLAUSE','lob (data) store as (cache)');
  ctx_ddl.set_attribute('"FT_CLOUDOTSCOLL2_STO"','I_INDEX_CLAUSE','compress 2');
end;
/

create index testindex
  on testtable
      ("FITEMGUID")
  indextype is ctxsys.context
  parameters('
    datastore       "FT_CLOUDOTSCOLL2_DST"
    filter          "FT_CLOUDOTSCOLL2_FIL"
    section group   "FT_CLOUDOTSCOLL2_SGP"
    lexer           "FT_CLOUDOTSCOLL2_LEX"
    wordlist        "FT_CLOUDOTSCOLL2_WDL"
    stoplist        "FT_CLOUDOTSCOLL2_SPL"
    storage         "FT_CLOUDOTSCOLL2_STO"
    sync (manual)
  ')
/

select token_text, token_type from dr$testindex$i;

select fitemname from testtable where contains (fitemguid, 'baseballs') > 0;

