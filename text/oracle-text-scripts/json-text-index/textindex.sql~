drop table reviews_json;

create table reviews_json
  (pid number  primary key,
   json_text   clob,
   senti_score number,
   constraint reviewtextisjson check (json_text is json));

insert into reviews_json values (1, '{ "title":"the greatest thing", "review": "this stuff is fantastic" }', null);

insert into reviews_json values (2, '{ "title":"awful", "review": "this stuff is just terrible" }', null);


exec ctx_ddl.drop_preference  ('json_ds')
exec ctx_ddl.create_preference('json_ds', 'MULTI_COLUMN_DATASTORE')
begin
   ctx_ddl.set_attribute    (
      'json_ds', 
      'COLUMNS', 
      'json_value(json_text, ''$.title''), json_value(json_text, ''$.review'''
   );
end;
/

create index reviews_text_index 
   on reviews_json(json_text) 
   indextype is ctxsys.context;

