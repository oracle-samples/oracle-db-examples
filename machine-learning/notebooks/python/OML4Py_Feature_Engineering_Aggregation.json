{"paragraphs":[{"text":"%md\n\n## OML4Py Feature Engineering: Aggregation\nIn this notebook, we demonstrate how to fill in missing values using OML4Py.\n\nWe use the SH schema SALES table, which contains transaction records for each customer and products purchased. We create features by aggregating the amount sold for each customer and product pair.\n\nCopyright (c) 2021 Oracle Corporation \n###### <a href=\"https://oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0</a>\n---","user":"OMLUSER","dateUpdated":"2021-08-23T22:23:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>OML4Py Feature Engineering: Aggregation</h2>\n<p>In this notebook, we demonstrate how to fill in missing values using OML4Py.</p>\n<p>We use the SH schema SALES table, which contains transaction records for each customer and products purchased. We create features by aggregating the amount sold for each customer and product pair.</p>\n<p>Copyright (c) 2021 Oracle Corporation</p>\n<h6><a href=\"https: //oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0</a></h6>\n<hr />\n"}]},"interrupted":false,"jobName":"paragraph_1627066207493_1514716054","id":"20210723-185007_619785989","dateCreated":"2020-12-15T15:00:28+0000","dateStarted":"2021-08-23T22:23:37+0000","dateFinished":"2021-08-23T22:23:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"focus":true,"$$hashKey":"object:40"},{"title":"For more information ...","text":"%md\n\nOML4Py documentation on Cross-Tabulation: <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/cross-tabulate-data.html\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/cross-tabulate-data.html');\"> https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/cross-tabulate-data.html </a>\nOML4Py documentation on Combining Data: <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/combine-data.html\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/combine-data.html');\"> https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/combine-data.html </a>","user":"OMLUSER","dateUpdated":"2021-08-23T22:25:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>OML4Py documentation on Cross-Tabulation: <a href=\"https: //docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/cross-tabulate-data.html\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/cross-tabulate-data.html');\"> https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/cross-tabulate-data.html </a>\n<br  />OML4Py documentation on Combining Data: <a href=\"https: //docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/combine-data.html\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/combine-data.html');\"> https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/combine-data.html </a></p>\n"}]},"interrupted":false,"jobName":"paragraph_1627066207493_-1017710746","id":"20210723-185007_839474544","dateCreated":"2020-12-17T18:43:49+0000","dateStarted":"2021-08-23T22:25:38+0000","dateFinished":"2021-08-23T22:25:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:41"},{"title":"Import python libraries and set display options","text":"%python\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport pandas as pd\nimport oml\nfrom oml import automl\n\npd.set_option('display.max_rows', 500)\npd.set_option('display.max_columns', 500)\npd.set_option('display.width', 1000)","user":"OMLUSER","dateUpdated":"2021-07-30T18:08:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"interrupted":false,"jobName":"paragraph_1627066207493_-1314835189","id":"20210723-185007_1988034706","dateCreated":"2020-12-13T01:00:28+0000","dateStarted":"2021-07-30T18:08:42+0000","dateFinished":"2021-07-30T18:08:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:42"},{"title":"Get a proxy object to SALES data and view a few records","text":"%python\n\nSALES_DF = oml.sync(query = 'select cust_id, prod_id, amount_sold from sh.sales')\n\nz.show(SALES_DF.head())","user":"OMLUSER","dateUpdated":"2021-07-30T18:08:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"CUST_ID":"string","PROD_ID":"string","AMOUNT_SOLD":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"CUST_ID\tPROD_ID\tAMOUNT_SOLD\n524.0\t13.0\t1205.99\n2128.0\t13.0\t1250.25\n3212.0\t13.0\t1250.25\n3375.0\t13.0\t1250.25\n5204.0\t13.0\t1250.25\n"}]},"interrupted":false,"jobName":"paragraph_1627066207493_-239330042","id":"20210723-185007_645608636","dateCreated":"2020-12-13T01:00:53+0000","dateStarted":"2021-07-30T18:08:43+0000","dateFinished":"2021-07-30T18:08:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:43"},{"title":"View multiple records for each customer and product pair with count","text":"%python\n\nz.show(SALES_DF.crosstab(['CUST_ID', 'PROD_ID']))","user":"OMLUSER","dateUpdated":"2021-07-30T18:08:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"CUST_ID":"string","PROD_ID":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"CUST_ID\tPROD_ID\tcount\n2\t20\t1\n2\t30\t9\n2\t46\t1\n2\t117\t1\n2\t119\t1\n2\t120\t3\n2\t140\t7\n2\t148\t8\n3\t30\t5\n3\t35\t4\n3\t36\t3\n3\t48\t4\n3\t113\t2\n3\t133\t3\n3\t134\t1\n3\t135\t2\n3\t148\t3\n4\t24\t1\n4\t26\t1\n4\t28\t1\n4\t31\t1\n4\t33\t2\n4\t37\t2\n4\t48\t2\n4\t113\t2\n4\t116\t3\n4\t119\t4\n4\t123\t2\n4\t125\t1\n4\t126\t1\n4\t141\t1\n4\t142\t1\n4\t146\t1\n4\t148\t1\n6\t37\t9\n6\t38\t7\n6\t43\t6\n6\t44\t4\n6\t48\t8\n6\t128\t6\n6\t133\t9\n6\t144\t3\n7\t23\t3\n7\t25\t2\n7\t28\t3\n7\t30\t4\n7\t34\t3\n7\t43\t1\n7\t113\t7\n7\t125\t3\n7\t126\t4\n7\t128\t6\n7\t129\t4\n7\t131\t4\n7\t135\t4\n8\t27\t1\n8\t31\t2\n8\t114\t1\n8\t119\t2\n8\t123\t2\n8\t128\t2\n8\t130\t4\n8\t140\t4\n9\t15\t3\n9\t16\t3\n9\t21\t3\n9\t25\t2\n9\t30\t8\n9\t31\t6\n9\t36\t3\n9\t38\t2\n9\t40\t5\n9\t48\t4\n9\t115\t2\n9\t125\t2\n9\t126\t3\n9\t127\t5\n9\t134\t2\n9\t138\t1\n9\t148\t2\n10\t27\t1\n10\t28\t5\n10\t30\t5\n10\t31\t5\n10\t32\t4\n10\t126\t6\n10\t130\t8\n10\t131\t4\n10\t140\t9\n10\t146\t7\n10\t148\t9\n11\t25\t5\n11\t28\t1\n11\t30\t1\n11\t40\t3\n11\t48\t4\n11\t119\t4\n11\t132\t5\n11\t148\t4\n12\t20\t2\n12\t31\t2\n12\t32\t2\n12\t41\t2\n12\t115\t2\n12\t120\t7\n12\t123\t2\n12\t124\t3\n12\t128\t3\n12\t139\t2\n12\t148\t6\n13\t23\t5\n13\t26\t4\n13\t27\t6\n13\t29\t3\n13\t34\t2\n13\t35\t3\n13\t42\t2\n13\t43\t1\n13\t119\t1\n13\t121\t3\n13\t130\t4\n13\t131\t3\n13\t137\t5\n13\t140\t5\n13\t142\t3\n13\t148\t5\n14\t15\t1\n14\t19\t2\n14\t28\t1\n14\t32\t3\n14\t40\t3\n14\t48\t4\n14\t119\t1\n14\t120\t3\n14\t125\t5\n14\t146\t2\n15\t24\t6\n15\t28\t4\n15\t41\t2\n15\t42\t2\n15\t115\t2\n15\t120\t3\n15\t127\t4\n15\t142\t2\n15\t144\t1\n15\t146\t2\n17\t16\t3\n17\t17\t4\n17\t24\t5\n17\t30\t4\n17\t36\t1\n17\t39\t3\n17\t41\t1\n17\t44\t1\n17\t118\t4\n17\t121\t1\n17\t124\t6\n17\t125\t6\n17\t126\t2\n17\t129\t8\n17\t130\t4\n17\t131\t4\n17\t135\t3\n17\t139\t4\n17\t144\t1\n18\t30\t1\n18\t34\t1\n18\t39\t5\n18\t44\t1\n18\t114\t3\n18\t115\t3\n18\t116\t5\n18\t118\t4\n18\t120\t5\n18\t121\t3\n18\t125\t3\n18\t131\t4\n18\t138\t1\n18\t144\t1\n18\t148\t2\n19\t24\t1\n19\t30\t1\n19\t47\t2\n19\t129\t1\n19\t148\t1\n20\t30\t6\n20\t32\t4\n20\t34\t3\n20\t36\t1\n20\t37\t9\n20\t38\t3\n20\t46\t3\n20\t48\t8\n20\t121\t2\n20\t123\t2\n20\t126\t2\n20\t130\t4\n22\t14\t1\n22\t17\t1\n22\t28\t2\n22\t29\t3\n22\t46\t4\n22\t116\t1\n22\t121\t1\n22\t127\t4\n22\t132\t4\n22\t145\t1\n22\t148\t1\n23\t17\t2\n23\t23\t2\n23\t34\t2\n23\t42\t2\n23\t47\t3\n23\t48\t4\n23\t115\t6\n23\t117\t6\n23\t126\t2\n23\t134\t1\n23\t135\t2\n23\t137\t5\n23\t138\t1\n23\t140\t2\n23\t143\t1\n23\t145\t2\n26\t16\t6\n26\t20\t1\n26\t32\t1\n26\t36\t5\n26\t37\t5\n26\t40\t6\n26\t43\t1\n26\t113\t4\n26\t115\t2\n26\t123\t4\n26\t124\t4\n26\t125\t4\n26\t126\t2\n26\t129\t1\n26\t132\t7\n26\t138\t2\n27\t13\t5\n27\t20\t3\n27\t21\t3\n27\t26\t7\n27\t41\t7\n27\t46\t5\n27\t114\t2\n27\t115\t3\n27\t121\t2\n27\t123\t2\n27\t125\t2\n27\t127\t3\n27\t137\t2\n27\t141\t1\n27\t143\t1\n27\t146\t2\n27\t147\t2\n28\t13\t2\n28\t28\t3\n28\t30\t3\n28\t35\t2\n28\t37\t1\n28\t47\t2\n28\t48\t1\n28\t118\t2\n28\t120\t2\n28\t137\t2\n28\t140\t2\n28\t146\t2\n32\t15\t2\n32\t21\t2\n32\t23\t8\n32\t26\t7\n32\t28\t5\n32\t29\t3\n32\t37\t2\n32\t40\t9\n32\t42\t6\n32\t45\t2\n32\t48\t9\n32\t115\t4\n32\t116\t5\n32\t117\t4\n32\t128\t4\n32\t132\t4\n32\t133\t5\n32\t137\t1\n32\t138\t2\n32\t141\t1\n32\t145\t1\n32\t148\t2\n33\t17\t4\n33\t20\t2\n33\t26\t1\n33\t29\t1\n33\t33\t4\n33\t34\t3\n33\t35\t3\n33\t37\t4\n33\t44\t1\n33\t48\t3\n33\t115\t1\n33\t116\t2\n33\t119\t5\n33\t121\t2\n33\t125\t5\n33\t127\t5\n33\t132\t3\n33\t140\t1\n33\t142\t1\n33\t144\t1\n33\t147\t3\n34\t23\t6\n34\t24\t9\n34\t25\t2\n34\t35\t3\n34\t39\t2\n34\t48\t3\n34\t113\t4\n34\t130\t6\n34\t136\t3\n34\t148\t6\n36\t13\t1\n36\t25\t5\n36\t27\t7\n36\t31\t3\n36\t32\t1\n36\t33\t5\n36\t34\t1\n36\t41\t4\n36\t120\t6\n36\t131\t5\n36\t132\t6\n36\t134\t3\n36\t135\t3\n36\t146\t3\n36\t148\t4\n37\t20\t2\n37\t25\t3\n37\t27\t3\n37\t32\t2\n37\t39\t3\n37\t48\t4\n37\t113\t1\n37\t127\t2\n37\t130\t3\n37\t134\t1\n37\t146\t1\n38\t24\t11\n38\t27\t7\n38\t33\t13\n38\t37\t5\n38\t40\t12\n38\t41\t10\n38\t48\t12\n40\t18\t2\n40\t19\t1\n40\t20\t1\n40\t23\t1\n40\t30\t1\n40\t31\t1\n40\t33\t1\n40\t120\t2\n40\t125\t2\n40\t126\t2\n40\t135\t1\n40\t146\t3\n40\t148\t3\n41\t19\t2\n41\t23\t3\n41\t24\t9\n41\t25\t5\n41\t32\t3\n41\t33\t4\n41\t36\t2\n41\t37\t1\n41\t47\t2\n41\t130\t5\n41\t137\t5\n41\t142\t2\n41\t148\t4\n42\t13\t1\n42\t25\t4\n42\t30\t4\n42\t33\t2\n42\t41\t3\n42\t48\t4\n42\t113\t5\n42\t119\t7\n42\t124\t3\n42\t127\t4\n42\t128\t4\n42\t132\t5\n42\t138\t2\n42\t144\t1\n44\t13\t1\n44\t23\t1\n44\t25\t2\n44\t29\t4\n44\t45\t1\n44\t117\t1\n44\t121\t1\n44\t131\t1\n44\t132\t3\n44\t137\t1\n44\t145\t1\n49\t25\t5\n49\t119\t1\n53\t26\t1\n53\t118\t1\n55\t124\t1\n55\t127\t1\n58\t22\t1\n58\t28\t1\n58\t30\t1\n58\t36\t2\n58\t43\t2\n58\t130\t1\n58\t148\t1\n60\t24\t1\n60\t29\t1\n60\t36\t1\n60\t117\t1\n60\t127\t1\n60\t138\t1\n62\t37\t2\n62\t42\t1\n62\t48\t2\n62\t116\t3\n62\t121\t1\n62\t123\t3\n62\t133\t2\n64\t22\t1\n64\t26\t1\n64\t29\t2\n64\t36\t1\n64\t120\t1\n64\t127\t1\n66\t116\t1\n68\t36\t1\n68\t43\t1\n68\t120\t1\n68\t121\t1\n68\t122\t1\n68\t145\t2\n68\t146\t1\n71\t20\t1\n71\t29\t2\n71\t33\t1\n71\t45\t1\n71\t130\t2\n75\t113\t2\n75\t118\t3\n75\t120\t1\n75\t124\t2\n75\t131\t1\n75\t135\t1\n75\t142\t1\n77\t16\t1\n77\t37\t1\n77\t113\t1\n77\t131\t1\n79\t23\t2\n79\t31\t2\n79\t34\t1\n79\t41\t1\n79\t47\t3\n79\t116\t1\n79\t123\t1\n79\t128\t1\n79\t130\t2\n79\t139\t1\n79\t146\t1\n81\t23\t1\n81\t28\t1\n81\t114\t1\n81\t127\t1\n81\t130\t3\n82\t23\t1\n82\t128\t1\n85\t42\t1\n85\t47\t1\n85\t128\t1\n85\t137\t1\n85\t145\t1\n86\t25\t1\n86\t123\t1\n91\t124\t1\n91\t131\t2\n92\t23\t1\n92\t47\t1\n92\t129\t2\n96\t26\t1\n96\t47\t1\n96\t115\t1\n97\t116\t1\n97\t118\t1\n100\t26\t1\n100\t32\t1\n100\t42\t2\n100\t139\t2\n100\t141\t1\n200\t18\t1\n200\t23\t2\n200\t26\t2\n200\t27\t1\n200\t28\t2\n200\t123\t3\n200\t126\t2\n200\t127\t2\n200\t131\t1\n200\t132\t1\n200\t140\t2\n300\t17\t2\n300\t20\t2\n300\t37\t2\n300\t47\t3\n300\t124\t3\n300\t127\t1\n300\t133\t1\n400\t37\t7\n400\t39\t7\n400\t43\t3\n400\t45\t1\n400\t120\t6\n400\t131\t6\n400\t144\t1\n500\t15\t2\n500\t16\t7\n500\t21\t5\n500\t22\t2\n500\t23\t2\n500\t30\t3\n500\t31\t4\n500\t34\t2\n500\t44\t2\n500\t45\t5\n500\t47\t5\n500\t116\t2\n500\t118\t1\n500\t130\t5\n500\t133\t5\n500\t136\t1\n500\t147\t3\n600\t18\t8\n600\t20\t2\n600\t21\t3\n600\t22\t1\n600\t24\t5\n600\t30\t5\n600\t31\t3\n600\t36\t3\n600\t40\t6\n600\t43\t2\n600\t45\t4\n600\t120\t3\n600\t135\t3\n600\t148\t1\n800\t23\t6\n800\t46\t8\n800\t48\t10\n800\t120\t8\n800\t123\t3\n800\t128\t4\n800\t131\t3\n1300\t19\t1\n1300\t23\t1\n1300\t24\t4\n1300\t25\t2\n1300\t26\t2\n1300\t30\t3\n1300\t33\t4\n1300\t39\t5\n1300\t125\t3\n1300\t146\t2\n1400\t38\t1\n1400\t39\t3\n1400\t45\t1\n1400\t113\t2\n1400\t124\t2\n1400\t140\t1\n1600\t26\t1\n1600\t34\t1\n1600\t35\t1\n1600\t45\t1\n1600\t48\t4\n1600\t119\t3\n1600\t120\t2\n1600\t123\t2\n1600\t124\t5\n1600\t132\t1\n1600\t142\t1\n1600\t148\t2\n1700\t13\t6\n1700\t15\t5\n1700\t17\t6\n1700\t18\t5\n1700\t21\t6\n1700\t22\t3\n1700\t23\t4\n1700\t29\t5\n1700\t45\t8\n1700\t117\t2\n1700\t124\t3\n2000\t15\t1\n2000\t19\t1\n2000\t27\t5\n2000\t114\t6\n2000\t115\t1\n2000\t117\t5\n2000\t127\t4\n2000\t128\t5\n2000\t146\t5\n2300\t19\t3\n2300\t28\t4\n2300\t30\t1\n2300\t31\t1\n2300\t39\t2\n2300\t130\t5\n2300\t146\t1\n2400\t21\t1\n2400\t25\t1\n2400\t115\t1\n2400\t118\t4\n2400\t119\t8\n2400\t137\t3\n2400\t146\t1\n2600\t30\t12\n2600\t40\t12\n2600\t120\t6\n2600\t126\t2\n2700\t17\t1\n2700\t40\t1\n2700\t48\t2\n2700\t125\t1\n2700\t129\t2\n2700\t147\t4\n2700\t148\t3\n2900\t25\t5\n2900\t31\t6\n2900\t36\t8\n2900\t39\t6\n2900\t42\t5\n2900\t113\t4\n2900\t119\t4\n2900\t128\t4\n2900\t133\t3\n2900\t138\t2\n2900\t141\t4\n2900\t142\t2\n2900\t148\t4\n3300\t16\t1\n3300\t24\t5\n3300\t30\t6\n3300\t31\t3\n3300\t34\t1\n3300\t47\t3\n3300\t118\t1\n3300\t120\t1\n3300\t130\t1\n3300\t133\t1\n3300\t137\t1\n3300\t141\t1\n3300\t145\t1\n3300\t146\t1\n3300\t148\t1\n3500\t24\t7\n3500\t37\t5\n3500\t41\t6\n3500\t113\t5\n3500\t130\t8\n3500\t140\t3\n3500\t143\t1\n3600\t31\t9\n3600\t33\t10\n3600\t41\t8\n3600\t42\t7\n3600\t47\t1\n3600\t48\t7\n3600\t118\t6\n3600\t125\t2\n3600\t126\t1\n3600\t131\t2\n3600\t133\t2\n3600\t134\t3\n3600\t135\t3\n3600\t140\t5\n3700\t16\t1\n3700\t25\t1\n3700\t28\t2\n3700\t40\t2\n3700\t116\t1\n3700\t117\t1\n3700\t119\t4\n3700\t124\t4\n3700\t125\t2\n3700\t126\t1\n3700\t127\t1\n3700\t129\t1\n3700\t147\t1\n3900\t13\t1\n3900\t18\t3\n3900\t26\t1\n3900\t34\t2\n3900\t41\t1\n3900\t46\t1\n3900\t48\t4\n3900\t115\t1\n3900\t124\t2\n3900\t125\t2\n3900\t127\t2\n3900\t131\t1\n3900\t135\t1\n3900\t140\t3\n4100\t20\t2\n4200\t18\t2\n4200\t20\t2\n4200\t28\t3\n4200\t31\t6\n4200\t35\t6\n4200\t40\t7\n4200\t41\t4\n4200\t44\t1\n4200\t48\t6\n4200\t115\t4\n4200\t121\t1\n4200\t123\t4\n4200\t124\t6\n4200\t125\t5\n4200\t128\t7\n4200\t129\t4\n4200\t130\t2\n4200\t133\t3\n4200\t134\t2\n4200\t135\t2\n4200\t139\t3\n4200\t140\t4\n4700\t26\t2\n4700\t33\t2\n4700\t113\t1\n4700\t117\t3\n4700\t119\t3\n4700\t131\t1\n4900\t15\t3\n4900\t16\t4\n4900\t17\t5\n4900\t19\t5\n4900\t21\t5\n4900\t23\t4\n4900\t25\t5\n4900\t26\t5\n4900\t27\t6\n4900\t34\t5\n4900\t48\t9\n4900\t113\t2\n4900\t124\t3\n4900\t125\t3\n5900\t15\t1\n5900\t20\t1\n5900\t29\t2\n5900\t32\t1\n5900\t36\t1\n5900\t37\t6\n5900\t48\t6\n5900\t116\t4\n5900\t118\t4\n5900\t121\t1\n5900\t124\t7\n5900\t127\t3\n5900\t131\t6\n5900\t145\t2\n5900\t148\t3\n6400\t15\t2\n6400\t26\t3\n6400\t31\t5\n6400\t34\t1\n6400\t45\t1\n6400\t114\t1\n6400\t123\t2\n6400\t133\t2\n6900\t19\t4\n6900\t24\t6\n6900\t30\t5\n6900\t35\t2\n6900\t40\t7\n6900\t43\t2\n6900\t48\t7\n6900\t119\t6\n6900\t120\t7\n6900\t123\t5\n6900\t134\t3\n6900\t135\t2\n7100\t13\t3\n7100\t15\t4\n7100\t24\t6\n7100\t26\t1\n7100\t46\t1\n7100\t114\t5\n7100\t115\t2\n7100\t120\t5\n7100\t131\t2\n7100\t132\t4\n7100\t140\t4\n7100\t145\t4\n7200\t38\t5\n7200\t42\t6\n7200\t45\t10\n7200\t120\t2\n7200\t121\t3\n7200\t130\t3\n7200\t137\t5\n7200\t142\t2\n7200\t147\t1\n7300\t13\t2\n7300\t28\t4\n7300\t32\t4\n7300\t37\t3\n7300\t43\t2\n7300\t114\t3\n7300\t118\t3\n7300\t119\t3\n7300\t120\t2\n7300\t131\t2\n7300\t132\t2\n7300\t141\t3\n7300\t148\t3\n7400\t13\t1\n7400\t14\t1\n7400\t16\t3\n7400\t18\t2\n7400\t19\t5\n7400\t21\t1\n7400\t23\t3\n7400\t25\t4\n7400\t30\t4\n7400\t31\t3\n7400\t36\t1\n7400\t40\t3\n7400\t45\t2\n7400\t113\t1\n7400\t115\t1\n7400\t116\t1\n7400\t130\t2\n7400\t135\t1\n7400\t139\t1\n7400\t146\t1\n7500\t23\t2\n7500\t28\t1\n7500\t30\t3\n7500\t45\t2\n7500\t113\t1\n7500\t118\t1\n7500\t119\t2\n7500\t130\t2\n7500\t131\t1\n7500\t135\t2\n7500\t136\t1\n7500\t137\t1\n7700\t13\t3\n7700\t14\t1\n7700\t22\t7\n7700\t25\t8\n7700\t26\t9\n7700\t29\t6\n7700\t32\t1\n7700\t38\t3\n7700\t43\t1\n7700\t44\t1\n7700\t116\t8\n7700\t125\t1\n7700\t126\t1\n7700\t134\t2\n7700\t139\t4\n7700\t143\t8\n7700\t144\t2\n7700\t145\t7\n7900\t13\t2\n7900\t15\t6\n7900\t18\t4\n7900\t20\t1\n7900\t25\t5\n7900\t26\t5\n7900\t29\t5\n7900\t34\t4\n7900\t44\t3\n7900\t45\t2\n7900\t48\t4\n7900\t137\t3\n7900\t138\t3\n7900\t139\t5\n7900\t141\t2\n7900\t142\t3\n7900\t145\t3\n7900\t147\t4\n8400\t19\t3\n8400\t20\t2\n8400\t29\t8\n8400\t30\t2\n8400\t36\t9\n8400\t42\t1\n8400\t117\t6\n8400\t119\t6\n8400\t120\t5\n8400\t137\t8\n8400\t138\t7\n8400\t144\t4\n8500\t17\t5\n8500\t25\t6\n8500\t32\t2\n8500\t33\t3\n8500\t35\t3\n8500\t124\t3\n8500\t125\t1\n8500\t132\t4\n8500\t137\t2\n8500\t138\t1\n8500\t140\t3\n8500\t141\t2\n8500\t143\t1\n8900\t38\t2\n8900\t43\t1\n8900\t115\t1\n8900\t118\t1\n8900\t121\t4\n9500\t19\t6\n9500\t25\t1\n9500\t34\t4\n9500\t40\t6\n9500\t44\t1\n9500\t114\t5\n9500\t118\t3\n9500\t119\t5\n9500\t120\t6\n9500\t125\t6\n9500\t133\t5\n9500\t138\t1\n9500\t148\t2\n9900\t16\t1\n9900\t17\t2\n9900\t19\t3\n9900\t26\t3\n9900\t35\t3\n9900\t40\t5\n9900\t42\t2\n9900\t46\t3\n9900\t115\t2\n9900\t118\t2\n9900\t120\t1\n9900\t124\t4\n9900\t128\t7\n9900\t133\t2\n103\t33\t5\n103\t124\t3\n103\t133\t4\n105\t39\t1\n105\t40\t2\n105\t148\t1\n112\t16\t1\n112\t19\t1\n112\t20\t3\n112\t24\t6\n112\t27\t1\n112\t32\t2\n112\t45\t1\n112\t46\t4\n112\t48\t3\n112\t115\t1\n112\t133\t2\n114\t28\t1\n114\t41\t1\n114\t46\t1\n114\t48\t2\n115\t24\t2\n115\t26\t1\n115\t37\t2\n115\t40\t2\n115\t120\t1\n115\t127\t1\n115\t128\t1\n115\t129\t1\n116\t19\t4\n116\t23\t3\n116\t25\t3\n116\t28\t4\n116\t30\t5\n116\t31\t2\n116\t36\t1\n116\t46\t1\n116\t113\t1\n116\t119\t1\n116\t128\t2\n116\t133\t1\n117\t14\t4\n117\t22\t4\n117\t27\t1\n117\t28\t5\n117\t34\t6\n117\t40\t6\n117\t42\t4\n117\t45\t7\n"}]},"interrupted":false,"jobName":"paragraph_1627066207493_261373045","id":"20210723-185007_190819953","dateCreated":"2020-12-13T01:02:16+0000","dateStarted":"2021-07-30T18:08:44+0000","dateFinished":"2021-07-30T18:08:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:44"},{"title":"Compute cross tabulation using min, max, mean, and count for each customer and product","text":"%python\n\nMAX_DF   = SALES_DF.crosstab(['CUST_ID', 'PROD_ID'], values = 'AMOUNT_SOLD', aggfunc = oml.DataFrame.max)\nMIN_DF   = SALES_DF.crosstab(['CUST_ID', 'PROD_ID'], values = 'AMOUNT_SOLD', aggfunc = oml.DataFrame.min)\nMEAN_DF  = SALES_DF.crosstab(['CUST_ID', 'PROD_ID'], values = 'AMOUNT_SOLD', aggfunc = oml.DataFrame.mean)\nCOUNT_DF = SALES_DF.crosstab(['CUST_ID', 'PROD_ID'], values = 'AMOUNT_SOLD', aggfunc = oml.DataFrame.count)\n\n\n","user":"OMLUSER","dateUpdated":"2021-07-30T18:08:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"interrupted":false,"jobName":"paragraph_1627066207493_747089537","id":"20210723-185007_1933938871","dateCreated":"2020-12-13T01:04:09+0000","dateStarted":"2021-07-30T18:08:45+0000","dateFinished":"2021-07-30T18:08:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:45"},{"title":"Join all results","text":"%python\n\nAGG_DF = MAX_DF.merge(MIN_DF,   on = ['CUST_ID', 'PROD_ID'], how = 'inner', suffixes =['', '']) \nAGG_DF = AGG_DF.merge(MEAN_DF,  on = ['CUST_ID', 'PROD_ID'], how = 'inner', suffixes =['', ''])\nAGG_DF = AGG_DF.merge(COUNT_DF, on = ['CUST_ID', 'PROD_ID'], how = 'inner', suffixes =['', ''])","user":"OMLUSER","dateUpdated":"2021-07-30T18:08:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"interrupted":false,"jobName":"paragraph_1627066207493_-1071978864","id":"20210723-185007_2108712413","dateCreated":"2020-12-13T01:14:41+0000","dateStarted":"2021-07-30T18:08:47+0000","dateFinished":"2021-07-30T18:08:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:46"},{"title":"View aggregated data","text":"%python\n\nz.show(AGG_DF.round(2).head())","user":"OMLUSER","dateUpdated":"2021-07-30T18:08:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"CUST_ID":"string","PROD_ID":"string","max(AMOUNT_SOLD)":"string","min(AMOUNT_SOLD)":"string","mean(AMOUNT_SOLD)":"string","count(AMOUNT_SOLD)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"CUST_ID\tPROD_ID\tmax(AMOUNT_SOLD)\tmin(AMOUNT_SOLD)\tmean(AMOUNT_SOLD)\tcount(AMOUNT_SOLD)\n7128.0\t113.0\t27.52\t27.52\t27.52\t2.0\n7653.0\t113.0\t27.91\t27.52\t27.62\t5.0\n224.0\t113.0\t27.52\t23.36\t26.13\t3.0\n6421.0\t113.0\t27.52\t23.36\t26.13\t3.0\n9586.0\t113.0\t27.62\t24.9\t26.26\t2.0\n"}]},"interrupted":false,"jobName":"paragraph_1627066207493_-1097853645","id":"20210723-185007_34693123","dateCreated":"2020-12-13T01:15:31+0000","dateStarted":"2021-07-30T18:08:47+0000","dateFinished":"2021-07-30T18:08:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:47"},{"text":"%md\n\n# End of Script\n","user":"OMLUSER","dateUpdated":"2021-07-30T18:08:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>End of Script</h1>\n"}]},"interrupted":false,"jobName":"paragraph_1627066207493_1828139974","id":"20210723-185007_1959488022","dateCreated":"2020-12-13T01:16:22+0000","dateStarted":"2021-07-30T18:08:50+0000","dateFinished":"2021-07-30T18:08:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:48"},{"text":"%md\n","user":"OMLUSER","dateUpdated":"2021-07-30T18:08:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1627066207493_-1909195115","id":"20210723-185007_735353872","dateCreated":"2020-12-15T19:23:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:49"}],"name":"OML4Py Feature Engineering Aggregation","id":"68817","noteParams":{},"noteForms":{},"angularObjects":{"MDW381939C745:shared_process":[],"ORA7CC90ACC73:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}