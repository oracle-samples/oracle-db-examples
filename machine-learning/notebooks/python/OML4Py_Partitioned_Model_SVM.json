{"paragraphs":[{"text":"%md\n#OML4Py Partitioned Model\nOracle Machine Learning enables automatically building an ensemble model comprised of multiple sub-models, one for each data partition. Sub-models exist and are used as one model, which results in simplified scoring using the top-level model only. The proper sub-model is chosen by the system based on partition value(s) in the row of data to be scored. Partitioned models achieve potentially better accuracy through multiple targeted models. \n\nIn this notebook, we build an SVM model to predict the number of years a customer resides at their residence but partitioned on customer gender. The model is then used to predict the target, then predict the target with prediction details. \n\n\nCopyright (c) 2021 Oracle Corporation \n###### <a href=\"https://oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0</a>\n---","user":"OMLUSER","dateUpdated":"2021-08-23T22:45:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>OML4Py Partitioned Model</h1>\n<p>Oracle Machine Learning enables automatically building an ensemble model comprised of multiple sub-models, one for each data partition. Sub-models exist and are used as one model, which results in simplified scoring using the top-level model only. The proper sub-model is chosen by the system based on partition value(s) in the row of data to be scored. Partitioned models achieve potentially better accuracy through multiple targeted models.</p>\n<p>In this notebook, we build an SVM model to predict the number of years a customer resides at their residence but partitioned on customer gender. The model is then used to predict the target, then predict the target with prediction details.</p>\n<p>Copyright (c) 2021 Oracle Corporation</p>\n<h6><a href=\"https: //oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0</a></h6>\n<hr />\n"}]},"interrupted":false,"jobName":"paragraph_1627065690297_-129914162","id":"20210723-184130_753384786","dateCreated":"2020-06-05T19:16:06+0000","dateStarted":"2021-08-23T22:45:02+0000","dateFinished":"2021-08-23T22:45:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"focus":true,"$$hashKey":"object:40"},{"title":"For more information ...","text":"%md\n\nOracle ADW Documentation <a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" onclick=\"return ! window.open('https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html');\">https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html</a>\nOML folder on Oracle Github : <a href=\"https://github.com/oracle/oracle-db-examples/tree/master/machine-learning\" onclick=\"return ! window.open('https://github.com/oracle/oracle-db-examples/tree/master/machine-learning');\">https://github.com/oracle/oracle-db-examples/tree/master/machine-learning</a>\nOML web page: <a href=\"https://www.oracle.com/machine-learning\" onclick=\"return ! window.open('https://www.oracle.com/machine-learning');\">https://www.oracle.com/machine-learning</a>\nOML Partitioned Model: <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmprg/partitioned-model.html\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmprg/partitioned-model.html');\">https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmprg/partitioned-model.html</a>","user":"OMLUSER","dateUpdated":"2021-08-23T22:50:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Oracle ADW Documentation <a href=\"https: //docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" onclick=\"return ! window.open('https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html');\">https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html</a>\n<br  />OML folder on Oracle Github : <a href=\"https: //github.com/oracle/oracle-db-examples/tree/master/machine-learning\" onclick=\"return ! window.open('https://github.com/oracle/oracle-db-examples/tree/master/machine-learning');\">https://github.com/oracle/oracle-db-examples/tree/master/machine-learning</a>\n<br  />OML web page: <a href=\"https: //www.oracle.com/machine-learning\" onclick=\"return ! window.open('https://www.oracle.com/machine-learning');\">https://www.oracle.com/machine-learning</a>\n<br  />OML Partitioned Model: <a href=\"https: //docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmprg/partitioned-model.html\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmprg/partitioned-model.html');\">https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmprg/partitioned-model.html</a></p>\n"}]},"interrupted":false,"jobName":"paragraph_1627065690297_-254507486","id":"20210723-184130_1524406414","dateCreated":"2020-06-10T17:55:05+0000","dateStarted":"2021-08-23T22:50:18+0000","dateFinished":"2021-08-23T22:50:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:41"},{"title":"Import libraries and set display options","text":"%python\n\nimport oml\nimport pandas as pd\n\npd.set_option('display.max_rows', 500)\npd.set_option('display.max_columns', 500)\npd.set_option('display.width', 1000)","user":"OMLUSER","dateUpdated":"2021-08-18T06:16:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"interrupted":false,"jobName":"paragraph_1627065690297_930572754","id":"20210723-184130_1626423414","dateCreated":"2020-06-04T18:31:28+0000","dateStarted":"2021-08-18T06:16:11+0000","dateFinished":"2021-08-18T06:16:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:42"},{"title":"Prepare CUSTOMER_DEMO dataset using data from the SH schema","text":"%python\n\nCUSTOMERS = oml.sync(query = 'SELECT CUST_ID, CUST_GENDER, CUST_MARITAL_STATUS, CUST_YEAR_OF_BIRTH, CUST_INCOME_LEVEL, CUST_CREDIT_LIMIT FROM SH.CUSTOMERS')\nSUPPLEMENTARY_DEMOGRAPHICS = oml.sync(query = 'SELECT CUST_ID, EDUCATION, AFFINITY_CARD, HOUSEHOLD_SIZE, OCCUPATION, YRS_RESIDENCE, Y_BOX_GAMES FROM SH.SUPPLEMENTARY_DEMOGRAPHICS')\nCUSTOMERS_DEMO = CUSTOMERS.merge(SUPPLEMENTARY_DEMOGRAPHICS, how = \"inner\", on = 'CUST_ID', suffixes = [\"\", \"\"])\n","user":"OMLUSER","dateUpdated":"2021-08-18T06:16:18+0000","config":{"colWidth":8,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"interrupted":false,"jobName":"paragraph_1627065690297_1855568693","id":"20210723-184130_1571433468","dateCreated":"2020-06-03T20:50:23+0000","dateStarted":"2021-08-18T06:16:19+0000","dateFinished":"2021-08-18T06:16:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:43"},{"title":"Display number of rows and columns","text":"%python\n\nCUSTOMERS_DEMO.shape","user":"OMLUSER","dateUpdated":"2021-08-18T06:16:19+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(4500, 12)\n"}]},"interrupted":false,"jobName":"paragraph_1627065690297_2131627076","id":"20210723-184130_1278611510","dateCreated":"2020-06-03T20:54:15+0000","dateStarted":"2021-08-18T06:16:20+0000","dateFinished":"2021-08-18T06:16:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:44"},{"title":"Display a few rows of CUSTOMERS_DEMO data","text":"%python\n\nz.show(CUSTOMERS_DEMO.head())","user":"OMLUSER","dateUpdated":"2021-08-18T06:16:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"CUST_ID":"string","CUST_GENDER":"string","CUST_MARITAL_STATUS":"string","CUST_YEAR_OF_BIRTH":"string","CUST_INCOME_LEVEL":"string","CUST_CREDIT_LIMIT":"string","EDUCATION":"string","AFFINITY_CARD":"string","HOUSEHOLD_SIZE":"string","OCCUPATION":"string","YRS_RESIDENCE":"string","Y_BOX_GAMES":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"CUST_ID\tCUST_GENDER\tCUST_MARITAL_STATUS\tCUST_YEAR_OF_BIRTH\tCUST_INCOME_LEVEL\tCUST_CREDIT_LIMIT\tEDUCATION\tAFFINITY_CARD\tHOUSEHOLD_SIZE\tOCCUPATION\tYRS_RESIDENCE\tY_BOX_GAMES\n102547\tF\tNeverM\t1986\tI: 170,000 - 189,999\t1500\t10th\t0\t1\tOther\t0\t1\n101050\tM\tNeverM\t1986\tL: 300,000 and above\t11000\t10th\t0\t1\tOther\t0\t1\n100040\tF\tNeverM\t1986\tJ: 190,000 - 249,999\t9000\t11th\t0\t1\tSales\t0\t1\n102117\tM\tNeverM\t1984\tB: 30,000 - 49,999\t7000\tHS-grad\t0\t1\tFarming\t0\t1\n101074\tM\tNeverM\t1986\tJ: 190,000 - 249,999\t9000\t10th\t0\t1\tHandler\t1\t1\n"}]},"interrupted":false,"jobName":"paragraph_1627065690297_577065553","id":"20210723-184130_1922099670","dateCreated":"2020-06-03T20:53:41+0000","dateStarted":"2021-08-18T06:16:20+0000","dateFinished":"2021-08-18T06:16:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:45"},{"title":"Create data for train and test datasets and drop missing values","text":"%python\n\ndat = CUSTOMERS_DEMO.split(ratio=(0.8, 0.2), seed = 6218945)\n\ndat[0] = dat[0].dropna()\n\ntrain_x = dat[0].drop('YRS_RESIDENCE')\ntrain_y = dat[0]['YRS_RESIDENCE']\ntest_dat = dat[1]","user":"OMLUSER","dateUpdated":"2021-08-18T06:16:28+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"interrupted":false,"jobName":"paragraph_1627065690297_1708205160","id":"20210723-184130_403240194","dateCreated":"2020-06-03T20:55:39+0000","dateStarted":"2021-08-18T06:16:28+0000","dateFinished":"2021-08-18T06:16:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:46"},{"title":"","text":"%md\n\n### Examples of possible setting overrides for Partitioning (Shared Settings)\n\nIf the user does not override the default settings, then relevant settings are determined by the algorithm\n\nA complete list of settings can be found in the Documentation link:\n\n-- Algorithm Settings: <a href=\"https://docs.oracle.com/en/database/oracle/oracle-database/21/arpls/DBMS_DATA_MINING.html#GUID-12408982-E738-4D0F-A2BC-84D895E07ABB\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/oracle-database/21/arpls/DBMS_DATA_MINING.html#GUID-12408982-E738-4D0F-A2BC-84D895E07ABB');\">Support Vector Machine</a>\n\n-- Shared Settings: <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/shared-settings.html#GUID-2EFF3880-F2E2-4449-A8CC-2CF516DD096B\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/shared-settings.html#GUID-2EFF3880-F2E2-4449-A8CC-2CF516DD096B');\">All algorithms</a>\n\n-- Requests the building of a partitioned model. \n    The setting value is a comma-separated list of the machine learning attributes to be used to determine the in-list partition key values. These attributes are taken from the input columns, unless an XFORM_LIST parameter is passed to the model. If XFORM_LIST parameter is passed to the model, then the attributes are taken from the attributes produced by these transformations.  \n     'odms_partition_columns' : '<Comma separated list of attributes>'\n     \n-- Controls the parallel building of partitioned models.     \n    ODMS_PARTITION_BUILD_INTRA builds each partition in parallel using all slaves.\n    ODMS_PARTITION_BUILD_INTER builds each partition entirely in a single slave, but multiple partitions may be built at the same time because multiple slaves are active.\n    ODMS_PARTITION_BUILD_HYBRID combines the other two types and is recommended for most situations to adapt to dynamic environments. This is the default value.\n     'odms_partition_build_type' : 'ODMS_PARTITION_BUILD_HYBRID'","user":"OMLUSER","dateUpdated":"2021-08-23T22:50:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/markdown","title":false,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Examples of possible setting overrides for Partitioning (Shared Settings)</h3>\n<p>If the user does not override the default settings, then relevant settings are determined by the algorithm</p>\n<p>A complete list of settings can be found in the Documentation link:</p>\n<p>&ndash; Algorithm Settings: <a href=\"https: //docs.oracle.com/en/database/oracle/oracle-database/21/arpls/DBMS_DATA_MINING.html#GUID-12408982-E738-4D0F-A2BC-84D895E07ABB\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/oracle-database/21/arpls/DBMS_DATA_MINING.html#GUID-12408982-E738-4D0F-A2BC-84D895E07ABB');\">Support Vector Machine</a></p>\n<p>&ndash; Shared Settings: <a href=\"https: //docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/shared-settings.html#GUID-2EFF3880-F2E2-4449-A8CC-2CF516DD096B\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/shared-settings.html#GUID-2EFF3880-F2E2-4449-A8CC-2CF516DD096B');\">All algorithms</a></p>\n<p>&ndash; Requests the building of a partitioned model.</p>\n<pre><code>The setting value is a comma-separated list of the machine learning attributes to be used to determine the in-list partition key values. These attributes are taken from the input columns, unless an XFORM_LIST parameter is passed to the model. If XFORM_LIST parameter is passed to the model, then the attributes are taken from the attributes produced by these transformations.  \n 'odms_partition_columns' : '&lt;Comma separated list of attributes&gt;'\n</code></pre>\n<p>&ndash; Controls the parallel building of partitioned models.</p>\n<pre><code>ODMS_PARTITION_BUILD_INTRA builds each partition in parallel using all slaves.\nODMS_PARTITION_BUILD_INTER builds each partition entirely in a single slave, but multiple partitions may be built at the same time because multiple slaves are active.\nODMS_PARTITION_BUILD_HYBRID combines the other two types and is recommended for most situations to adapt to dynamic environments. This is the default value.\n 'odms_partition_build_type' : 'ODMS_PARTITION_BUILD_HYBRID'\n</code></pre>\n"}]},"interrupted":false,"jobName":"paragraph_1629266685498_101441724","id":"20210818-060445_1529718856","dateCreated":"2021-08-18T06:04:45+0000","dateStarted":"2021-08-18T06:18:34+0000","dateFinished":"2021-08-18T06:18:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:47"},{"title":"Build Partitioned Model using the SVM algorithm to predict YRS_RESIDENCE, partitioned by CUST_GENDER","text":"%python\n\ntry:\n    oml.drop(model = 'SVM_PARTITIONED_REGRESSION_MODEL') \nexcept:\n    pass\n\nsetting = {'svms_kernel_function' :'dbms_data_mining.svms_linear',\n           'odms_partition_columns':'CUST_GENDER'}\nsvm_mod = oml.svm(\"regression\", **setting)\n \nsvm_mod.fit(train_x, train_y , model_name = 'SVM_PARTITIONED_REGRESSION_MODEL')","user":"OMLUSER","dateUpdated":"2021-08-18T06:16:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nModel Name: SVM_PARTITIONED_REGRESSION_MODEL\n\nModel Owner: OMLUSER\n\nAlgorithm Name: Support Vector Machine\n\nMining Function: REGRESSION\n\nTarget: YRS_RESIDENCE\n\nSettings: \n                   setting name                 setting value\n0                     ALGO_NAME  ALGO_SUPPORT_VECTOR_MACHINES\n1                  ODMS_DETAILS                   ODMS_ENABLE\n2           ODMS_MAX_PARTITIONS                          1000\n3  ODMS_MISSING_VALUE_TREATMENT       ODMS_MISSING_VALUE_AUTO\n4        ODMS_PARTITION_COLUMNS                   CUST_GENDER\n5                 ODMS_SAMPLING         ODMS_SAMPLING_DISABLE\n6                     PREP_AUTO                            ON\n7           SVMS_CONV_TOLERANCE                         .0001\n8                  SVMS_EPSILON                            .1\n9          SVMS_KERNEL_FUNCTION                   SVMS_LINEAR\n\nComputed Settings: \n  partition name            setting name    setting value\n0              F  SVMS_COMPLEXITY_FACTOR                3\n1              F     SVMS_NUM_ITERATIONS               30\n2              F             SVMS_SOLVER  SVMS_SOLVER_IPM\n3              M  SVMS_COMPLEXITY_FACTOR                3\n4              M     SVMS_NUM_ITERATIONS               30\n5              M             SVMS_SOLVER  SVMS_SOLVER_IPM\n\nGlobal Statistics: \n  partition name attribute name attribute value\n0              F      CONVERGED             YES\n1              F     ITERATIONS              15\n2              F       NUM_ROWS            1213\n3              M      CONVERGED             YES\n4              M     ITERATIONS              16\n5              M       NUM_ROWS            2381\n\nAttributes: \nAFFINITY_CARD\nCUST_CREDIT_LIMIT\nCUST_GENDER\nCUST_ID\nCUST_INCOME_LEVEL\nCUST_MARITAL_STATUS\nCUST_YEAR_OF_BIRTH\nEDUCATION\nHOUSEHOLD_SIZE\nOCCUPATION\nY_BOX_GAMES\n\nPartition: YES\n\n\n"}]},"interrupted":false,"jobName":"paragraph_1627065690297_-839688759","id":"20210723-184130_343005236","dateCreated":"2020-06-03T21:10:30+0000","dateStarted":"2021-08-18T06:16:30+0000","dateFinished":"2021-08-18T06:16:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:48"},{"title":"Predict on the test set and display prediction result - note the use of the top level model only","text":"%python\n\ny_pred_part = svm_mod.predict(test_dat, test_dat)\n\nz.show(y_pred_part[['PARTITION_NAME', 'PREDICTION'] + y_pred_part.columns].round(4).head())","user":"OMLUSER","dateUpdated":"2021-08-18T06:16:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"PARTITION_NAME":"string","PREDICTION":"string","CUST_ID":"string","CUST_GENDER":"string","CUST_MARITAL_STATUS":"string","CUST_YEAR_OF_BIRTH":"string","CUST_INCOME_LEVEL":"string","CUST_CREDIT_LIMIT":"string","EDUCATION":"string","AFFINITY_CARD":"string","HOUSEHOLD_SIZE":"string","OCCUPATION":"string","YRS_RESIDENCE":"string","Y_BOX_GAMES":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"PARTITION_NAME\tPREDICTION\tCUST_ID\tCUST_GENDER\tCUST_MARITAL_STATUS\tCUST_YEAR_OF_BIRTH\tCUST_INCOME_LEVEL\tCUST_CREDIT_LIMIT\tEDUCATION\tAFFINITY_CARD\tHOUSEHOLD_SIZE\tOCCUPATION\tYRS_RESIDENCE\tY_BOX_GAMES\tPREDICTION\tPARTITION_NAME\nF\t4.3611\t100134\tF\tDivorc.\t1965\tL: 300,000 and above\t9000\tAssoc-A\t0\t2\tCleric.\t2\t0\t4.3611\tF\nF\t3.4255\t102828\tF\tNeverM\t1967\tE: 90,000 - 109,999\t10000\tHS-grad\t0\t1\tMachine\t4\t0\t3.4255\tF\nM\t3.1581\t103401\tM\tDivorc.\t1975\tI: 170,000 - 189,999\t10000\tHS-grad\t0\t2\tCrafts\t4\t1\t3.1581\tM\nM\t3.6503\t104077\tM\tNeverM\t1975\tL: 300,000 and above\t9000\tProfsc\t0\t2\tProf.\t3\t1\t3.6503\tM\nM\t1.9144\t101940\tM\tNeverM\t1981\tJ: 190,000 - 249,999\t7000\t< Bach.\t0\t1\t?\t2\t1\t1.9144\tM\n"}]},"interrupted":false,"jobName":"paragraph_1627065690297_-1880176841","id":"20210723-184130_1748684076","dateCreated":"2020-06-03T21:22:07+0000","dateStarted":"2021-08-18T06:16:35+0000","dateFinished":"2021-08-18T06:16:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:49"},{"title":"Show model global statistics for each partitioned sub-model","text":"%python\nz.show(svm_mod.global_stats)","user":"OMLUSER","dateUpdated":"2021-08-18T06:16:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"partition name":"string","attribute name":"string","attribute value":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"partition name\tattribute name\tattribute value\nF\tCONVERGED\tYES\nF\tITERATIONS\t15.0\nF\tNUM_ROWS\t1213.0\nM\tCONVERGED\tYES\nM\tITERATIONS\t16.0\nM\tNUM_ROWS\t2381.0\n"}]},"interrupted":false,"jobName":"paragraph_1627065690297_-710934966","id":"20210723-184130_496064420","dateCreated":"2020-06-03T21:22:23+0000","dateStarted":"2021-08-18T06:16:36+0000","dateFinished":"2021-08-18T06:16:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:50"},{"title":"Materialize the test dataset","text":"%python\n\ntry:\n    oml.drop(table = 'TEST_DATA')\nexcept:\n    pass\n_ = test_dat.materialize(table = 'TEST_DATA')","user":"OMLUSER","dateUpdated":"2021-08-18T06:16:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"interrupted":false,"jobName":"paragraph_1627065690297_-1401671057","id":"20210723-184130_1122894321","dateCreated":"2020-06-04T18:35:36+0000","dateStarted":"2021-08-18T06:16:37+0000","dateFinished":"2021-08-18T06:16:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:51"},{"title":"Display prediction details","text":"%python\n\ny_pred_part = svm_mod.predict(test_dat, supplemental_cols = test_dat[['CUST_ID', 'YRS_RESIDENCE']], topN_attrs = True)\nz.show(y_pred_part.head())","user":"OMLUSER","dateUpdated":"2021-08-18T06:16:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"PARTITION_NAME":"string","CUST_ID":"string","YRS_RESIDENCE":"string","PREDICTION":"string","NAME_1":"string","VALUE_1":"string","WEIGHT_1":"string","NAME_2":"string","VALUE_2":"string","WEIGHT_2":"string","NAME_3":"string","VALUE_3":"string","WEIGHT_3":"string","NAME_4":"string","VALUE_4":"string","WEIGHT_4":"string","NAME_5":"string","VALUE_5":"string","WEIGHT_5":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"PARTITION_NAME\tCUST_ID\tYRS_RESIDENCE\tPREDICTION\tNAME_1\tVALUE_1\tWEIGHT_1\tNAME_2\tVALUE_2\tWEIGHT_2\tNAME_3\tVALUE_3\tWEIGHT_3\tNAME_4\tVALUE_4\tWEIGHT_4\tNAME_5\tVALUE_5\tWEIGHT_5\nF\t100077\t4\t4.138059998358802\tCUST_YEAR_OF_BIRTH\t1959\t.397\tCUST_INCOME_LEVEL\tK: 250,000 - 299,999\t.086\tCUST_MARITAL_STATUS\tMarried\t.062\tCUST_CREDIT_LIMIT\t15000\t.01\tY_BOX_GAMES\t0\t.007\nF\t100117\t4\t3.568163602154671\tCUST_MARITAL_STATUS\tDivorc.\t.154\tCUST_INCOME_LEVEL\tI: 170,000 - 189,999\t.092\tY_BOX_GAMES\t0\t.016\tCUST_CREDIT_LIMIT\t9000\t.005\tAFFINITY_CARD\t0\t-.041\nF\t100170\t3\t4.849064595592929\tCUST_YEAR_OF_BIRTH\t1943\t.593\tCUST_INCOME_LEVEL\tF: 110,000 - 129,999\t.028\tY_BOX_GAMES\t0\t.003\tCUST_CREDIT_LIMIT\t3000\t-.003\tAFFINITY_CARD\t0\t-.008\nF\t100223\t3\t2.7120801984886125\tCUST_INCOME_LEVEL\tK: 250,000 - 299,999\t.089\tEDUCATION\tAssoc-V\t.044\tCUST_CREDIT_LIMIT\t9000\t.002\tY_BOX_GAMES\t1\t-.013\tAFFINITY_CARD\t0\t-.019\nF\t100277\t6\t5.8816473850180415\tCUST_YEAR_OF_BIRTH\t1946\t.808\tCUST_INCOME_LEVEL\tL: 300,000 and above\t.05\tCUST_MARITAL_STATUS\tDivorc.\t.049\tY_BOX_GAMES\t0\t.005\tCUST_CREDIT_LIMIT\t7000\t-.001\n"}]},"interrupted":false,"jobName":"paragraph_1627065690297_1130527543","id":"20210723-184130_1489289696","dateCreated":"2021-06-08T18:42:17+0000","dateStarted":"2021-08-18T06:16:38+0000","dateFinished":"2021-08-18T06:16:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:52"},{"title":"Demonstrate using the SQL interface so score data and display prediction details","text":"%sql\n\nSELECT CUST_ID,\n round(PREDICTION_YRS_RES,3) PRED_YRS_RES,\n RTRIM(TRIM(SUBSTR(OUTPRED.\"Attribute1\",17,100)),'rank=\"1\"/>') FIRST_ATTRIBUTE,\n RTRIM(TRIM(SUBSTR(OUTPRED.\"Attribute2\",17,100)),'rank=\"2\"/>') SECOND_ATTRIBUTE,\n RTRIM(TRIM(SUBSTR(OUTPRED.\"Attribute3\",17,100)),'rank=\"3\"/>') THIRD_ATTRIBUTE\nFROM (SELECT CUST_ID,\n      PREDICTION(SVM_PARTITIONED_REGRESSION_MODEL USING *) PREDICTION_YRS_RES,\n      PREDICTION_DETAILS(SVM_PARTITIONED_REGRESSION_MODEL USING *) PD\n      FROM TEST_DATA\n      WHERE CUST_ID < 100015\n      ORDER BY CUST_ID) OUT,\n      XMLTABLE('/Details'\n               PASSING OUT.PD\n               COLUMNS \n               \"Attribute1\" XMLType PATH 'Attribute[1]',\n               \"Attribute2\" XMLType PATH 'Attribute[2]',\n               \"Attribute3\" XMLType PATH 'Attribute[3]') \n      OUTPRED\n","user":"OMLUSER","dateUpdated":"2021-08-18T06:16:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"CUST_ID":"string","PRED_YRS_RES":"string","FIRST_ATTRIBUTE":"string","SECOND_ATTRIBUTE":"string","THIRD_ATTRIBUTE":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/osql","runOnSelectionChange":true,"title":true},"settings":{"params":{"CUST_ID":"'101362'"},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"CUST_ID\tPRED_YRS_RES\tFIRST_ATTRIBUTE\tSECOND_ATTRIBUTE\tTHIRD_ATTRIBUTE\n100007\t4.092\t\"CUST_YEAR_OF_BIRTH\" actualValue=\"1963\" weight=\".319\" \t\"CUST_INCOME_LEVEL\" actualValue=\"L: 300,000 and above\" weight=\".128\" \t\"CUST_MARITAL_STATUS\" actualValue=\"Divorc.\" weight=\".126\" \n100010\t2.978\t\"CUST_CREDIT_LIMIT\" actualValue=\"9000\" weight=\".004\" \t\"CUST_ID\" actualValue=\"100010\" weight=\"-.001\" \t\"CUST_INCOME_LEVEL\" actualValue=\"L: 300,000 and above\" weight=\"-.033\" \n"}]},"interrupted":false,"jobName":"paragraph_1627065690297_250866306","id":"20210723-184130_1722360953","dateCreated":"2020-06-04T18:21:37+0000","dateStarted":"2021-08-18T06:16:45+0000","dateFinished":"2021-08-18T06:16:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:53"},{"text":"%md\n# End of Script\n\n","user":"OMLUSER","dateUpdated":"2021-08-18T06:16:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>End of Script</h1>\n"}]},"interrupted":false,"jobName":"paragraph_1627065690297_-743886264","id":"20210723-184130_1905419135","dateCreated":"2020-06-04T18:22:32+0000","dateStarted":"2021-08-18T06:16:46+0000","dateFinished":"2021-08-18T06:16:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:54"},{"text":"%md\n","user":"OMLUSER","dateUpdated":"2021-08-18T06:16:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1627065690297_-946156568","id":"20210723-184130_1128338741","dateCreated":"2020-06-10T20:22:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:55"}],"name":"OML4Py Partitioned Model SVM","id":"68742","noteParams":{},"noteForms":{},"angularObjects":{"MDW381939C745:shared_process":[],"ORA7A60DC9B32:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}