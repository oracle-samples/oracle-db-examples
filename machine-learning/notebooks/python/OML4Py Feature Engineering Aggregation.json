{"paragraphs":[{"text":"%md\n\n## OML4Py Feature Engineering: Aggregation\nIn this notebook, we demonstrate how to fill in missing values using OML4Py.\n\nWe use the SH schema SALES table, which contains transaction records for each customer and products purchased. We create features by aggregating the amount sold for each customer and product pair.\n\nCopyright (c) 2020 Oracle Corporation                             \n###### [The Universal Permissive License (UPL), Version 1.0](https://oss.oracle.com/licenses/upl/)\n---\n","user":"OMLUSER","dateUpdated":"2021-01-06T17:41:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>OML4Py Feature Engineering: Aggregation</h2>\n<p>In this notebook, we demonstrate how to fill in missing values using OML4Py.</p>\n<p>We use the SH schema SALES table, which contains transaction records for each customer and products purchased. We create features by aggregating the amount sold for each customer and product pair.</p>\n<p>Copyright (c) 2020 Oracle Corporation</p>\n<h6><a href=\"https://oss.oracle.com/licenses/upl/\">The Universal Permissive License (UPL), Version 1.0</a></h6>\n<hr />\n"}]},"interrupted":false,"jobName":"paragraph_1608233965258_896593029","id":"20201217-193925_1876123682","dateCreated":"2020-12-15T15:00:28+0000","dateStarted":"2021-01-06T17:41:44+0000","dateFinished":"2021-01-06T17:41:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"focus":true,"$$hashKey":"object:40"},{"title":"For more information ...","text":"%md\n\nOML4Py doc cross-tabulate data <https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/cross-tabulate-data.html>\nOML4Py doc combine data <https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/combine-data.html>","user":"OMLUSER","dateUpdated":"2021-01-06T17:41:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>OML4Py doc cross-tabulate data <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/cross-tabulate-data.html\">https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/cross-tabulate-data.html</a>\n<br  />OML4Py doc combine data <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/combine-data.html\">https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/combine-data.html</a></p>\n"}]},"interrupted":false,"jobName":"paragraph_1608233965258_380289303","id":"20201217-193925_952056206","dateCreated":"2020-12-17T18:43:49+0000","dateStarted":"2021-01-06T17:41:45+0000","dateFinished":"2021-01-06T17:41:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:41"},{"title":"Import python libraries and set display options","text":"%python\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport pandas as pd\nimport oml\nfrom oml import automl\n\npd.set_option('display.max_rows', 500)\npd.set_option('display.max_columns', 500)\npd.set_option('display.width', 1000)","user":"OMLUSER","dateUpdated":"2021-01-06T17:41:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"interrupted":false,"jobName":"paragraph_1608233965258_-691140944","id":"20201217-193925_578185239","dateCreated":"2020-12-13T01:00:28+0000","dateStarted":"2021-01-06T17:41:45+0000","dateFinished":"2021-01-06T17:41:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:42"},{"title":"Get a proxy object to SALES data and view a few records","text":"%python\n\nSALES_DF = oml.sync(query = 'select cust_id, prod_id, amount_sold from sh.sales')\n\nz.show(SALES_DF.head())","user":"OMLUSER","dateUpdated":"2021-01-06T17:41:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"CUST_ID":"string","PROD_ID":"string","AMOUNT_SOLD":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"CUST_ID\tPROD_ID\tAMOUNT_SOLD\n524.0\t13.0\t1205.99\n2128.0\t13.0\t1250.25\n3212.0\t13.0\t1250.25\n3375.0\t13.0\t1250.25\n5204.0\t13.0\t1250.25\n"}]},"interrupted":false,"jobName":"paragraph_1608233965258_-1351349844","id":"20201217-193925_725675360","dateCreated":"2020-12-13T01:00:53+0000","dateStarted":"2021-01-06T17:41:53+0000","dateFinished":"2021-01-06T17:41:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:43"},{"title":"View multiple records for each customer and product pair with count","text":"%python\n\nz.show(SALES_DF.crosstab(['CUST_ID', 'PROD_ID']))","user":"OMLUSER","dateUpdated":"2021-01-06T17:41:54+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"CUST_ID":"string","PROD_ID":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"CUST_ID\tPROD_ID\tcount\n2\t13\t4\n2\t14\t12\n2\t15\t5\n2\t17\t9\n2\t18\t14\n2\t20\t1\n2\t23\t4\n2\t25\t3\n2\t26\t4\n2\t30\t9\n2\t31\t8\n2\t32\t1\n2\t33\t3\n2\t40\t4\n2\t46\t1\n2\t48\t7\n2\t113\t4\n2\t114\t1\n2\t116\t1\n2\t117\t1\n2\t119\t1\n2\t120\t3\n2\t123\t6\n2\t125\t8\n2\t126\t8\n2\t127\t10\n2\t128\t9\n2\t130\t6\n2\t131\t3\n2\t132\t3\n2\t133\t3\n2\t140\t7\n2\t146\t5\n2\t148\t8\n3\t18\t3\n3\t23\t8\n3\t24\t9\n3\t25\t7\n3\t26\t6\n3\t27\t4\n3\t28\t10\n3\t30\t5\n3\t31\t7\n3\t33\t3\n3\t34\t4\n3\t35\t4\n3\t36\t3\n3\t37\t5\n3\t38\t4\n3\t39\t4\n3\t40\t6\n3\t41\t2\n3\t42\t2\n3\t43\t3\n3\t48\t4\n3\t113\t2\n3\t114\t1\n3\t115\t3\n3\t116\t4\n3\t117\t4\n3\t118\t5\n3\t119\t6\n3\t120\t3\n3\t121\t2\n3\t130\t5\n3\t131\t4\n3\t132\t2\n3\t133\t3\n3\t134\t1\n3\t135\t2\n3\t137\t3\n3\t139\t3\n3\t140\t3\n3\t141\t2\n3\t143\t1\n3\t144\t1\n3\t146\t2\n3\t148\t3\n4\t24\t1\n4\t26\t1\n4\t28\t1\n4\t30\t2\n4\t31\t1\n4\t33\t2\n4\t35\t1\n4\t37\t2\n4\t39\t3\n4\t40\t1\n4\t48\t2\n4\t113\t2\n4\t114\t3\n4\t116\t3\n4\t117\t2\n4\t118\t2\n4\t119\t4\n4\t120\t2\n4\t123\t2\n4\t124\t4\n4\t125\t1\n4\t126\t1\n4\t127\t3\n4\t128\t6\n4\t129\t1\n4\t130\t3\n4\t132\t1\n4\t133\t4\n4\t134\t1\n4\t135\t1\n4\t137\t2\n4\t139\t2\n4\t140\t1\n4\t141\t1\n4\t142\t1\n4\t146\t1\n4\t148\t1\n6\t15\t7\n6\t16\t3\n6\t19\t6\n6\t21\t9\n6\t23\t3\n6\t24\t3\n6\t25\t3\n6\t26\t3\n6\t27\t3\n6\t28\t3\n6\t36\t6\n6\t37\t9\n6\t38\t7\n6\t39\t9\n6\t40\t9\n6\t42\t7\n6\t43\t6\n6\t44\t4\n6\t45\t8\n6\t47\t8\n6\t48\t8\n6\t113\t7\n6\t118\t3\n6\t120\t8\n6\t121\t6\n6\t122\t6\n6\t123\t6\n6\t124\t6\n6\t125\t6\n6\t126\t6\n6\t127\t6\n6\t128\t6\n6\t129\t6\n6\t130\t9\n6\t131\t8\n6\t132\t9\n6\t133\t9\n6\t134\t9\n6\t135\t9\n6\t144\t3\n6\t147\t3\n7\t22\t1\n7\t23\t3\n7\t24\t4\n7\t25\t2\n7\t28\t3\n7\t29\t2\n7\t30\t4\n7\t31\t3\n7\t32\t2\n7\t33\t3\n7\t34\t3\n7\t35\t3\n7\t36\t4\n7\t37\t4\n7\t38\t2\n7\t40\t2\n7\t41\t3\n7\t42\t4\n7\t43\t1\n7\t44\t1\n7\t45\t2\n7\t46\t2\n7\t47\t3\n7\t48\t4\n7\t113\t7\n7\t114\t8\n7\t115\t7\n7\t116\t8\n7\t117\t8\n7\t118\t7\n7\t119\t8\n7\t120\t9\n7\t121\t7\n7\t122\t4\n7\t123\t3\n7\t124\t4\n7\t125\t3\n7\t126\t4\n7\t127\t4\n7\t128\t6\n7\t129\t4\n7\t130\t4\n7\t131\t4\n7\t132\t3\n7\t133\t4\n7\t134\t2\n7\t135\t4\n7\t137\t4\n7\t138\t3\n7\t139\t5\n7\t140\t4\n7\t141\t4\n7\t142\t4\n7\t143\t2\n7\t144\t1\n7\t145\t4\n7\t146\t4\n7\t147\t5\n7\t148\t5\n8\t18\t2\n8\t19\t4\n8\t20\t1\n8\t23\t3\n8\t25\t3\n8\t26\t1\n8\t27\t1\n8\t28\t4\n8\t30\t2\n8\t31\t2\n8\t40\t1\n8\t113\t1\n8\t114\t1\n8\t116\t1\n8\t117\t2\n8\t119\t2\n8\t120\t2\n8\t123\t2\n8\t125\t1\n8\t126\t1\n8\t127\t1\n8\t128\t2\n8\t130\t4\n8\t131\t2\n8\t132\t5\n8\t133\t1\n8\t140\t4\n8\t146\t2\n8\t148\t2\n9\t13\t5\n9\t15\t3\n9\t16\t3\n9\t18\t2\n9\t20\t8\n9\t21\t3\n9\t22\t2\n9\t23\t2\n9\t24\t2\n9\t25\t2\n9\t26\t3\n9\t27\t3\n9\t28\t3\n9\t29\t3\n9\t30\t8\n9\t31\t6\n9\t32\t4\n9\t33\t7\n9\t34\t2\n9\t35\t5\n9\t36\t3\n9\t37\t7\n9\t38\t2\n9\t40\t5\n9\t41\t1\n9\t42\t1\n9\t43\t2\n9\t44\t1\n9\t45\t4\n9\t46\t5\n9\t47\t4\n9\t48\t4\n9\t114\t2\n9\t115\t2\n9\t116\t5\n9\t117\t5\n9\t118\t6\n9\t119\t3\n9\t120\t1\n9\t122\t2\n9\t123\t2\n9\t124\t4\n9\t125\t2\n9\t126\t3\n9\t127\t5\n9\t128\t5\n9\t129\t5\n9\t130\t1\n9\t131\t1\n9\t133\t1\n9\t134\t2\n9\t135\t2\n9\t138\t1\n9\t139\t1\n9\t140\t1\n9\t141\t1\n9\t142\t1\n9\t144\t2\n9\t145\t1\n9\t146\t1\n9\t147\t2\n9\t148\t2\n10\t23\t5\n10\t25\t3\n10\t26\t3\n10\t27\t1\n10\t28\t5\n10\t30\t5\n10\t31\t5\n10\t32\t4\n10\t33\t2\n10\t40\t2\n10\t46\t1\n10\t48\t2\n10\t113\t7\n10\t114\t9\n10\t115\t1\n10\t116\t9\n10\t117\t9\n10\t119\t11\n10\t120\t8\n10\t123\t4\n10\t125\t6\n10\t126\t6\n10\t127\t6\n10\t128\t8\n10\t130\t8\n10\t131\t4\n10\t132\t3\n10\t133\t3\n10\t140\t9\n10\t146\t7\n10\t148\t9\n11\t13\t1\n11\t17\t2\n11\t19\t1\n11\t20\t1\n11\t23\t2\n11\t25\t5\n11\t26\t1\n11\t27\t3\n11\t28\t1\n11\t30\t1\n11\t32\t1\n11\t40\t3\n11\t46\t1\n11\t48\t4\n11\t113\t4\n11\t114\t2\n11\t116\t2\n11\t117\t3\n11\t119\t4\n11\t120\t4\n11\t123\t1\n11\t125\t1\n11\t126\t2\n11\t127\t2\n11\t128\t3\n11\t130\t9\n11\t131\t4\n11\t132\t5\n11\t133\t3\n11\t140\t3\n11\t146\t3\n11\t148\t4\n12\t18\t1\n12\t19\t6\n12\t20\t2\n12\t23\t4\n12\t24\t8\n12\t25\t5\n12\t26\t3\n12\t27\t1\n12\t28\t5\n12\t30\t2\n12\t31\t2\n12\t32\t2\n12\t33\t2\n12\t34\t2\n12\t36\t4\n12\t38\t2\n12\t40\t4\n12\t41\t2\n12\t42\t3\n12\t43\t1\n12\t48\t4\n12\t113\t4\n12\t114\t2\n12\t115\t2\n12\t116\t2\n12\t117\t2\n12\t118\t1\n12\t119\t3\n12\t120\t7\n12\t121\t3\n12\t123\t2\n12\t124\t3\n12\t125\t3\n12\t126\t1\n12\t127\t3\n12\t128\t3\n12\t130\t9\n12\t131\t8\n12\t132\t6\n12\t133\t7\n12\t134\t4\n12\t135\t1\n12\t137\t3\n12\t138\t4\n12\t139\t2\n12\t140\t7\n12\t141\t4\n12\t142\t3\n12\t143\t2\n12\t146\t4\n12\t148\t6\n13\t16\t6\n13\t18\t1\n13\t23\t5\n13\t25\t4\n13\t26\t4\n13\t27\t6\n13\t28\t7\n13\t29\t3\n13\t30\t3\n13\t31\t3\n13\t34\t2\n13\t35\t3\n13\t36\t5\n13\t37\t3\n13\t39\t3\n13\t40\t4\n13\t41\t1\n13\t42\t2\n13\t43\t1\n13\t44\t1\n13\t45\t1\n13\t47\t1\n13\t48\t4\n13\t113\t4\n13\t114\t1\n13\t115\t1\n13\t116\t1\n13\t118\t1\n13\t119\t1\n13\t120\t4\n13\t121\t3\n13\t130\t4\n13\t131\t3\n13\t132\t4\n13\t133\t4\n13\t134\t3\n13\t135\t3\n13\t137\t5\n13\t138\t1\n13\t139\t5\n13\t140\t5\n13\t141\t2\n13\t142\t3\n13\t143\t2\n13\t144\t1\n13\t145\t3\n13\t146\t5\n13\t148\t5\n14\t14\t4\n14\t15\t1\n14\t17\t5\n14\t18\t3\n14\t19\t2\n14\t20\t4\n14\t28\t1\n14\t30\t5\n14\t31\t4\n14\t32\t3\n14\t33\t1\n14\t40\t3\n14\t46\t1\n14\t48\t4\n14\t116\t1\n14\t117\t1\n14\t119\t1\n14\t120\t3\n14\t123\t4\n14\t125\t5\n14\t126\t2\n14\t127\t5\n14\t128\t5\n14\t130\t3\n14\t131\t3\n14\t132\t1\n14\t133\t1\n14\t140\t3\n14\t146\t2\n14\t148\t2\n15\t19\t6\n15\t20\t4\n15\t23\t2\n15\t24\t6\n15\t25\t4\n15\t26\t3\n15\t28\t4\n15\t30\t4\n15\t31\t4\n15\t32\t3\n15\t33\t4\n15\t34\t1\n15\t35\t3\n15\t36\t3\n15\t37\t2\n15\t38\t2\n15\t39\t4\n15\t40\t4\n15\t41\t2\n15\t42\t2\n15\t43\t1\n15\t46\t2\n15\t48\t3\n15\t113\t3\n15\t114\t2\n15\t115\t2\n15\t116\t4\n15\t117\t2\n15\t118\t3\n15\t119\t4\n15\t120\t3\n15\t121\t3\n15\t123\t3\n15\t124\t4\n15\t125\t4\n15\t126\t3\n15\t127\t4\n15\t128\t4\n15\t130\t5\n15\t131\t4\n15\t132\t3\n15\t133\t3\n15\t134\t3\n15\t135\t4\n15\t137\t2\n15\t138\t1\n15\t139\t4\n15\t140\t3\n15\t141\t1\n15\t142\t2\n15\t144\t1\n15\t146\t2\n15\t148\t2\n17\t14\t4\n17\t15\t4\n17\t16\t3\n17\t17\t4\n17\t21\t1\n17\t23\t4\n17\t24\t5\n17\t30\t4\n17\t31\t3\n17\t33\t6\n17\t34\t3\n17\t35\t3\n17\t36\t1\n17\t37\t3\n17\t38\t2\n17\t39\t3\n17\t40\t3\n17\t41\t1\n17\t42\t2\n17\t43\t1\n17\t44\t1\n17\t45\t2\n17\t47\t2\n17\t48\t4\n17\t113\t2\n17\t117\t4\n17\t118\t4\n17\t120\t3\n17\t121\t1\n17\t122\t1\n17\t123\t5\n17\t124\t6\n17\t125\t6\n17\t126\t2\n17\t127\t3\n17\t128\t6\n17\t129\t8\n17\t130\t4\n17\t131\t4\n17\t132\t2\n17\t134\t2\n17\t135\t3\n17\t137\t4\n17\t139\t4\n17\t140\t7\n17\t141\t1\n17\t142\t3\n17\t143\t1\n17\t144\t1\n17\t145\t2\n17\t146\t3\n17\t147\t4\n17\t148\t5\n18\t16\t3\n18\t18\t2\n18\t23\t1\n18\t25\t1\n18\t26\t1\n18\t30\t1\n18\t31\t1\n18\t34\t1\n18\t35\t1\n18\t36\t5\n18\t37\t6\n18\t39\t5\n18\t40\t5\n18\t41\t2\n18\t42\t3\n18\t43\t2\n18\t44\t1\n18\t45\t2\n18\t48\t5\n18\t113\t3\n18\t114\t3\n18\t115\t3\n18\t116\t5\n18\t117\t5\n18\t118\t4\n18\t119\t6\n18\t120\t5\n18\t121\t3\n18\t123\t4\n18\t124\t4\n18\t125\t3\n18\t126\t3\n18\t127\t4\n18\t128\t5\n18\t129\t2\n18\t130\t5\n18\t131\t4\n18\t132\t4\n18\t133\t4\n18\t134\t4\n18\t135\t5\n18\t137\t2\n18\t138\t1\n18\t139\t2\n18\t140\t2\n18\t141\t1\n18\t142\t1\n18\t143\t1\n18\t144\t1\n18\t145\t1\n18\t146\t1\n18\t148\t2\n19\t19\t3\n19\t24\t1\n19\t30\t1\n19\t31\t2\n19\t33\t1\n19\t35\t1\n19\t37\t1\n19\t40\t1\n19\t47\t2\n19\t118\t1\n19\t124\t1\n19\t129\t1\n19\t130\t1\n19\t133\t1\n19\t148\t1\n20\t23\t2\n20\t24\t4\n20\t25\t5\n20\t26\t3\n20\t27\t3\n20\t28\t4\n20\t30\t6\n20\t31\t3\n20\t32\t4\n20\t33\t4\n20\t34\t3\n20\t35\t3\n20\t36\t1\n20\t37\t9\n20\t38\t3\n20\t39\t10\n20\t40\t5\n20\t41\t2\n20\t42\t4\n20\t43\t3\n20\t44\t1\n20\t46\t3\n20\t48\t8\n20\t113\t5\n20\t114\t4\n20\t115\t2\n20\t116\t4\n20\t117\t5\n20\t118\t5\n20\t119\t7\n20\t120\t5\n20\t121\t2\n20\t123\t2\n20\t124\t3\n20\t125\t3\n20\t126\t2\n20\t127\t3\n20\t128\t4\n20\t130\t4\n20\t131\t4\n20\t132\t2\n20\t133\t4\n20\t135\t2\n22\t14\t1\n22\t15\t1\n22\t17\t1\n22\t18\t2\n22\t20\t1\n22\t21\t1\n22\t22\t1\n22\t23\t2\n22\t25\t3\n22\t26\t2\n22\t28\t2\n22\t29\t3\n22\t30\t3\n22\t31\t3\n22\t32\t1\n22\t34\t2\n22\t35\t1\n22\t37\t5\n22\t38\t2\n22\t39\t1\n22\t40\t7\n22\t41\t1\n22\t45\t2\n22\t46\t4\n22\t47\t9\n22\t48\t7\n22\t114\t4\n22\t115\t2\n22\t116\t1\n22\t117\t5\n22\t118\t3\n22\t119\t5\n22\t120\t5\n22\t121\t1\n22\t123\t1\n22\t124\t5\n22\t125\t5\n22\t127\t4\n22\t128\t5\n22\t129\t4\n22\t130\t6\n22\t131\t4\n22\t132\t4\n22\t133\t4\n22\t134\t1\n22\t135\t7\n22\t138\t1\n22\t141\t1\n22\t142\t1\n22\t144\t1\n22\t145\t1\n22\t147\t1\n22\t148\t1\n23\t13\t1\n23\t16\t2\n23\t17\t2\n23\t18\t5\n23\t20\t4\n23\t21\t1\n23\t23\t2\n23\t24\t6\n23\t25\t5\n23\t26\t1\n23\t27\t2\n23\t28\t3\n23\t29\t4\n23\t30\t5\n23\t31\t3\n23\t32\t4\n23\t33\t4\n23\t34\t2\n23\t35\t4\n23\t36\t2\n23\t37\t2\n23\t40\t5\n23\t41\t2\n23\t42\t2\n23\t43\t2\n23\t45\t2\n23\t46\t3\n23\t47\t3\n23\t48\t4\n23\t113\t4\n23\t115\t6\n23\t116\t6\n23\t117\t6\n23\t120\t3\n23\t121\t1\n23\t123\t2\n23\t124\t3\n23\t125\t2\n23\t126\t2\n23\t127\t3\n23\t128\t2\n23\t129\t3\n23\t130\t2\n23\t131\t2\n23\t132\t3\n23\t133\t2\n23\t134\t1\n23\t135\t2\n23\t137\t5\n23\t138\t1\n23\t139\t1\n23\t140\t2\n23\t141\t1\n23\t142\t1\n23\t143\t1\n23\t144\t1\n23\t145\t2\n23\t146\t3\n23\t147\t3\n23\t148\t3\n26\t13\t1\n26\t16\t6\n26\t20\t1\n26\t23\t5\n26\t24\t6\n26\t25\t6\n26\t26\t4\n26\t28\t5\n26\t30\t4\n26\t31\t5\n26\t32\t1\n26\t33\t4\n26\t34\t5\n26\t35\t4\n26\t36\t5\n26\t37\t5\n26\t38\t3\n26\t39\t7\n26\t40\t6\n26\t41\t5\n26\t42\t5\n26\t43\t1\n26\t44\t2\n26\t45\t7\n26\t46\t3\n26\t48\t5\n26\t113\t4\n26\t114\t3\n26\t115\t2\n26\t116\t2\n26\t117\t3\n26\t118\t4\n26\t119\t4\n26\t120\t3\n26\t121\t3\n26\t123\t4\n26\t124\t4\n26\t125\t4\n26\t126\t2\n26\t127\t4\n26\t128\t5\n26\t129\t1\n26\t130\t7\n26\t131\t3\n26\t132\t7\n26\t133\t4\n26\t134\t3\n26\t135\t5\n26\t137\t3\n26\t138\t2\n26\t139\t2\n26\t140\t4\n26\t141\t3\n26\t142\t2\n26\t143\t1\n26\t144\t1\n26\t145\t1\n26\t146\t3\n26\t148\t5\n27\t13\t5\n27\t14\t4\n27\t15\t6\n27\t16\t5\n27\t17\t3\n27\t18\t7\n27\t19\t3\n27\t20\t3\n27\t21\t3\n27\t22\t2\n27\t23\t3\n27\t24\t7\n27\t25\t8\n27\t26\t7\n27\t27\t4\n27\t28\t7\n27\t29\t2\n27\t30\t5\n27\t31\t6\n27\t32\t4\n27\t33\t5\n27\t34\t5\n27\t36\t5\n27\t37\t3\n27\t38\t4\n27\t40\t8\n27\t41\t7\n27\t42\t4\n27\t43\t5\n27\t44\t2\n27\t45\t3\n27\t46\t5\n27\t47\t3\n27\t48\t8\n27\t113\t2\n27\t114\t2\n27\t115\t3\n27\t116\t3\n27\t117\t2\n27\t118\t3\n27\t119\t3\n27\t120\t3\n27\t121\t2\n27\t122\t3\n27\t123\t2\n27\t124\t2\n27\t125\t2\n27\t126\t3\n27\t127\t3\n27\t128\t3\n27\t129\t3\n27\t130\t4\n27\t131\t3\n27\t132\t2\n27\t133\t3\n27\t134\t3\n27\t135\t2\n27\t137\t2\n27\t139\t1\n27\t140\t2\n27\t141\t1\n27\t142\t1\n27\t143\t1\n27\t144\t2\n27\t145\t1\n27\t146\t2\n27\t147\t2\n27\t148\t1\n28\t13\t2\n28\t15\t1\n28\t16\t1\n28\t21\t1\n28\t23\t3\n28\t24\t8\n28\t25\t3\n28\t26\t1\n28\t27\t3\n28\t28\t3\n28\t30\t3\n28\t33\t3\n28\t34\t1\n28\t35\t2\n28\t37\t1\n28\t40\t1\n28\t45\t1\n28\t47\t2\n28\t48\t1\n28\t115\t1\n28\t116\t2\n28\t117\t2\n28\t118\t2\n28\t119\t3\n28\t120\t2\n28\t129\t1\n28\t130\t2\n28\t131\t3\n28\t132\t1\n28\t133\t1\n28\t135\t2\n28\t137\t2\n28\t139\t3\n28\t140\t2\n28\t145\t1\n28\t146\t2\n28\t147\t4\n28\t148\t2\n32\t13\t4\n32\t14\t2\n32\t15\t2\n32\t17\t2\n32\t18\t1\n32\t19\t5\n32\t20\t2\n32\t21\t2\n"}]},"interrupted":false,"jobName":"paragraph_1608233965258_-523815560","id":"20201217-193925_1608931930","dateCreated":"2020-12-13T01:02:16+0000","dateStarted":"2021-01-06T17:41:54+0000","dateFinished":"2021-01-06T17:41:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:44"},{"title":"Compute cross tabulation using min, max, mean, and count for each customer and product","text":"%python\n\nMAX_DF   = SALES_DF.crosstab(['CUST_ID', 'PROD_ID'], values = 'AMOUNT_SOLD', aggfunc = oml.DataFrame.max)\nMIN_DF   = SALES_DF.crosstab(['CUST_ID', 'PROD_ID'], values = 'AMOUNT_SOLD', aggfunc = oml.DataFrame.min)\nMEAN_DF  = SALES_DF.crosstab(['CUST_ID', 'PROD_ID'], values = 'AMOUNT_SOLD', aggfunc = oml.DataFrame.mean)\nCOUNT_DF = SALES_DF.crosstab(['CUST_ID', 'PROD_ID'], values = 'AMOUNT_SOLD', aggfunc = oml.DataFrame.count)\n\n\n","user":"OMLUSER","dateUpdated":"2021-01-06T17:41:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"interrupted":false,"jobName":"paragraph_1608233965258_-764225942","id":"20201217-193925_517241697","dateCreated":"2020-12-13T01:04:09+0000","dateStarted":"2021-01-06T17:41:56+0000","dateFinished":"2021-01-06T17:41:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:45"},{"title":"Join all results","text":"%python\n\nAGG_DF = MAX_DF.merge(MIN_DF,   on = ['CUST_ID', 'PROD_ID'], how = 'inner', suffixes =['', ''])\nAGG_DF = AGG_DF.merge(MAX_DF,   on = ['CUST_ID', 'PROD_ID'], how = 'inner', suffixes =['', ''])\nAGG_DF = AGG_DF.merge(MEAN_DF,  on = ['CUST_ID', 'PROD_ID'], how = 'inner', suffixes =['', ''])\nAGG_DF = AGG_DF.merge(COUNT_DF, on = ['CUST_ID', 'PROD_ID'], how = 'inner', suffixes =['', ''])\n","user":"OMLUSER","dateUpdated":"2021-01-06T17:41:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"interrupted":false,"jobName":"paragraph_1608233965258_600009701","id":"20201217-193925_267619964","dateCreated":"2020-12-13T01:14:41+0000","dateStarted":"2021-01-06T17:41:58+0000","dateFinished":"2021-01-06T17:41:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:46"},{"title":"View aggregated data","text":"%python\n\nz.show(AGG_DF.head().round(2))","user":"OMLUSER","dateUpdated":"2021-01-06T17:41:58+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"CUST_ID":"string","PROD_ID":"string","max(AMOUNT_SOLD)":"string","min(AMOUNT_SOLD)":"string","mean(AMOUNT_SOLD)":"string","count(AMOUNT_SOLD)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/undefined","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"CUST_ID\tPROD_ID\tmax(AMOUNT_SOLD)\tmin(AMOUNT_SOLD)\tmax(AMOUNT_SOLD)\tmean(AMOUNT_SOLD)\tcount(AMOUNT_SOLD)\n3212.0\t13.0\t1250.25\t1205.99\t1250.25\t1232.34\t4.0\n3375.0\t13.0\t1250.25\t1250.25\t1250.25\t1250.25\t3.0\n13869.0\t13.0\t1250.25\t1205.99\t1250.25\t1234.33\t5.0\n2079.0\t13.0\t1232.16\t1205.99\t1232.16\t1218.82\t5.0\n9038.0\t13.0\t1222.87\t1205.99\t1222.87\t1212.1\t7.0\n"}]},"interrupted":false,"jobName":"paragraph_1608233965258_-40321537","id":"20201217-193925_594827535","dateCreated":"2020-12-13T01:15:31+0000","dateStarted":"2021-01-06T17:41:59+0000","dateFinished":"2021-01-06T17:42:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:47"},{"text":"%md\n\n# End of Script\n","user":"OMLUSER","dateUpdated":"2021-01-06T17:42:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>End of Script</h1>\n"}]},"interrupted":false,"jobName":"paragraph_1608233965258_53997671","id":"20201217-193925_1320018865","dateCreated":"2020-12-13T01:16:22+0000","dateStarted":"2021-01-06T17:42:03+0000","dateFinished":"2021-01-06T17:42:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:48"},{"text":"%md\n","user":"OMLUSER","dateUpdated":"2020-12-23T14:57:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1608233965258_-748750305","id":"20201217-193925_1939834486","dateCreated":"2020-12-15T19:23:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:49"}],"name":"OML4Py Feature Engineering Aggregation","id":"684397","noteParams":{},"noteForms":{},"angularObjects":{"ORACED2F65282:shared_process":[],"ORA3594E6BC19:shared_process":[],"ORA9D573F9398:shared_process":[],"MDW381939C745:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}