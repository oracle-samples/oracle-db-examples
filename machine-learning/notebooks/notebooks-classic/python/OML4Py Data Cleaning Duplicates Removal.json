{
  "paragraphs": [
    {
      "text": "%md\n\n## OML4Py Data Cleaning: Duplicates Removal\nIn this notebook, we demonstrate how to remove duplicate records using OML4Py.\n\nWe use the customer insurance lifetime value data set which contains customer financial information, lifetime value, and whether or not the customer bought insurance. \n\nThe dataset `CUSTOMER_INSURANCE_LTV_PY` is generated by the `\"OML Run-me-first\"` notebook, which `MUST` be run before this notebook.\n\n---\n\n##### `IMPORTANT`: The `\"OML Run-me-first\"` notebook is available under the menu Templates -\u003e Examples and is a pre-requisite to the current notebook.\n\n---\n\nCopyright (c) 2022 Oracle Corporation \n###### \u003ca href\u003d\"https://oss.oracle.com/licenses/upl/\" onclick\u003d\"return ! window.open(\u0027https://oss.oracle.com/licenses/upl/\u0027);\"\u003eThe Universal Permissive License (UPL), Version 1.0\u003c/a\u003e\n---\n\n",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T16:48:33+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "md",
          "editOnDblClick": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003ch2\u003eOML4Py Data Cleaning: Duplicates Removal\u003c/h2\u003e\n\u003cp\u003eIn this notebook, we demonstrate how to remove duplicate records using OML4Py.\u003c/p\u003e\n\u003cp\u003eWe use the customer insurance lifetime value data set which contains customer financial information, lifetime value, and whether or not the customer bought insurance.\u003c/p\u003e\n\u003cp\u003eThe dataset \u003ccode\u003eCUSTOMER_INSURANCE_LTV_PY\u003c/code\u003e is generated by the \u003ccode\u003e\"OML Run-me-first\"\u003c/code\u003e notebook, which \u003ccode\u003eMUST\u003c/code\u003e be run before this notebook.\u003c/p\u003e\n\u003chr /\u003e\n\u003ch5\u003e\u003ccode\u003eIMPORTANT\u003c/code\u003e: The \u003ccode\u003e\"OML Run-me-first\"\u003c/code\u003e notebook is available under the menu Templates -\u003e Examples and is a pre-requisite to the current notebook.\u003c/h5\u003e\n\u003chr /\u003e\n\u003cp\u003eCopyright (c) 2022 Oracle Corporation\u003c/p\u003e\n\u003ch6\u003e\u003ca href\u003d\"https: //oss.oracle.com/licenses/upl/\" onclick\u003d\"return ! window.open(\u0027https://oss.oracle.com/licenses/upl/\u0027);\"\u003eThe Universal Permissive License (UPL), Version 1.0\u003c/a\u003e\u003c/h6\u003e\n\u003chr /\u003e\n"
          }
        ]
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055262887_176182700",
      "id": "20220124-201422_1999379916",
      "dateCreated": "2020-12-15T19:51:52+0000",
      "dateStarted": "2022-03-10T16:48:34+0000",
      "dateFinished": "2022-03-10T16:48:35+0000",
      "status": "FINISHED"
    },
    {
      "title": "For more information ...",
      "text": "%md\n\nOML4Py clean data \u003ca href\u003d\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/clean-data.html\" onclick\u003d\"return ! window.open(\u0027https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/clean-data.html\u0027);\"\u003ehttps://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/clean-data.html\u003c/a\u003e\n\n---\n",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T16:48:35+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "md",
          "editOnDblClick": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cp\u003eOML4Py clean data \u003ca href\u003d\"https: //docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/clean-data.html\" onclick\u003d\"return ! window.open(\u0027https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/clean-data.html\u0027);\"\u003ehttps://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/clean-data.html\u003c/a\u003e\u003c/p\u003e\n\u003chr /\u003e\n"
          }
        ]
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055262887_-1096482265",
      "id": "20220124-201422_180981589",
      "dateCreated": "2020-12-17T18:26:26+0000",
      "dateStarted": "2022-03-10T16:48:36+0000",
      "dateFinished": "2022-03-10T16:48:36+0000",
      "status": "FINISHED"
    },
    {
      "title": "Import python libraries and set display options",
      "text": "%python\n\nimport warnings\nwarnings.filterwarnings(\u0027ignore\u0027)\n\nimport pandas as pd\nimport oml\nfrom oml import automl\n\npd.set_option(\u0027display.max_rows\u0027, 500)\npd.set_option(\u0027display.max_columns\u0027, 500)\npd.set_option(\u0027display.width\u0027, 1000)\n",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T16:48:36+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/undefined",
        "fontSize": 9.0,
        "editorHide": false,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "MARITAL_STATUS": "string",
                      "STATE": "string",
                      "CREDIT_BALANCE": "string",
                      "CUSTOMER_TENURE": "string",
                      "MORTGAGE_AMOUNT": "string",
                      "BANK_FUNDS": "string",
                      "NUM_DEPENDENTS": "string",
                      "HAS_CHILDREN": "string",
                      "INCOME": "string",
                      "CUSTOMER_ID": "string",
                      "GENDER": "string",
                      "PROFESSION": "string",
                      "CREDIT_CARD_LIMITS": "string",
                      "REGION": "string",
                      "HOME_OWNERSHIP": "string",
                      "NUM_ONLINE_TRANS": "string",
                      "BUY_INSURANCE": "string",
                      "MONTHLY_CHECKS": "string",
                      "NUM_TRANS_KIOSK": "string",
                      "AGE": "string",
                      "MONEY_MONTLY_OVERDRAWN": "string",
                      "LTV": "string",
                      "TOTAL_AUTOM_PAYMENTS": "string",
                      "NUM_TRANS_TELLER": "string",
                      "CHECKING_BALANCE": "string",
                      "NUM_TRANS_ATM": "string",
                      "LTV_BIN": "string",
                      "FIRST_NAME": "string",
                      "NUM_MORTGAGES": "string",
                      "CAR_OWNERSHIP": "string",
                      "LAST_NAME": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055262887_-811756060",
      "id": "20220124-201422_469290833",
      "dateCreated": "2020-11-13T03:32:30+0000",
      "dateStarted": "2022-03-10T16:48:36+0000",
      "dateFinished": "2022-03-10T16:48:46+0000",
      "status": "FINISHED"
    },
    {
      "title": "Get proxy object for CUSTOMER_INSURANCE_LTV_PY table",
      "text": "%python\n\nCUST_DF \u003d oml.sync(table \u003d \u0027CUSTOMER_INSURANCE_LTV_PY\u0027)",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T16:48:46+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/undefined",
        "fontSize": 9.0,
        "editorHide": false,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055262887_-670271292",
      "id": "20220124-201422_1825713803",
      "dateCreated": "2020-11-16T15:44:16+0000",
      "dateStarted": "2022-03-10T16:48:47+0000",
      "dateFinished": "2022-03-10T16:48:47+0000",
      "status": "FINISHED"
    },
    {
      "title": "Count number of unique customer IDs",
      "text": "%python\n\nCUST_DF[\u0027CUSTOMER_ID\u0027].nunique()",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T16:48:47+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 6.0,
        "editorMode": "ace/mode/undefined",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "13880\n"
          }
        ]
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055262887_-380782476",
      "id": "20220124-201422_2072485024",
      "dateCreated": "2020-11-16T15:45:12+0000",
      "dateStarted": "2022-03-10T16:48:47+0000",
      "dateFinished": "2022-03-10T16:48:47+0000",
      "status": "FINISHED"
    },
    {
      "title": "Show table dimensions - note there are more rows than customer IDs",
      "text": "%python\n\nCUST_DF.shape",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T16:48:47+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 6.0,
        "editorMode": "ace/mode/undefined",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "(14880, 31)\n"
          }
        ]
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055262887_1219149095",
      "id": "20220124-201422_1030887330",
      "dateCreated": "2020-11-16T15:45:52+0000",
      "dateStarted": "2022-03-10T16:48:48+0000",
      "dateFinished": "2022-03-10T16:48:48+0000",
      "status": "FINISHED"
    },
    {
      "title": "Remove duplicate rows",
      "text": "%python\n\nCUST_DF \u003d CUST_DF.drop_duplicates()",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T16:48:48+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/undefined",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055262888_1178828472",
      "id": "20220124-201422_1622000922",
      "dateCreated": "2020-11-13T04:12:22+0000",
      "dateStarted": "2022-03-10T16:48:49+0000",
      "dateFinished": "2022-03-10T16:48:49+0000",
      "status": "FINISHED"
    },
    {
      "title": "Check number of unique customer IDs",
      "text": "%python\n\nCUST_DF[\u0027CUSTOMER_ID\u0027].nunique()",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T16:48:49+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 6.0,
        "editorMode": "ace/mode/undefined",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "13880\n"
          }
        ]
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055262888_-889243014",
      "id": "20220124-201422_502663666",
      "dateCreated": "2020-11-13T03:34:49+0000",
      "dateStarted": "2022-03-10T16:48:50+0000",
      "dateFinished": "2022-03-10T16:48:50+0000",
      "status": "FINISHED"
    },
    {
      "title": "Check dimension of the OML dataframe - duplicated rows removed",
      "text": "%python\n\nCUST_DF.shape",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T16:48:50+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 6.0,
        "editorMode": "ace/mode/undefined",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "(13880, 31)\n"
          }
        ]
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055262888_-906248239",
      "id": "20220124-201422_1515451504",
      "dateCreated": "2020-11-16T15:48:56+0000",
      "dateStarted": "2022-03-10T16:48:50+0000",
      "dateFinished": "2022-03-10T16:48:51+0000",
      "status": "FINISHED"
    },
    {
      "text": "%md\n\n# End of Script\n",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T16:48:51+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "md",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003ch1\u003eEnd of Script\u003c/h1\u003e\n"
          }
        ]
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055262888_571947512",
      "id": "20220124-201422_2008098719",
      "dateCreated": "2020-11-16T15:49:04+0000",
      "dateStarted": "2022-03-10T16:48:51+0000",
      "dateFinished": "2022-03-10T16:48:51+0000",
      "status": "FINISHED"
    },
    {
      "text": "%md\n",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T16:48:51+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "md",
          "editOnDblClick": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055262888_1424717453",
      "id": "20220124-201422_2042276198",
      "dateCreated": "2020-12-16T15:46:24+0000",
      "dateStarted": "2022-03-10T16:48:52+0000",
      "dateFinished": "2022-03-10T16:48:52+0000",
      "status": "FINISHED"
    }
  ],
  "name": "OML4Py Data Cleaning Duplicates Removal",
  "id": "101039",
  "defaultInterpreterGroup": "spark",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "MDW381939C745:shared_process": [],
    "ORA7A60DC9B32:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {
    "isRunning": false
  }
}