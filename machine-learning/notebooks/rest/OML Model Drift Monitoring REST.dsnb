[{"layout":null,"template":null,"templateConfig":null,"name":"OML Model Drift Monitoring REST","description":null,"readOnly":false,"type":"low","paragraphs":[{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":null,"message":["%md"," "],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","# Model Monitoring","","Model monitoring plays an important role in MLOps by allowing users to monitor the performance of production machine learning models. Monitoring gives you the ability to identify when a model's performance is no longer satisfactory to meet business objectives and needs to be replaced with an updated model. The degradation of production models is a normal and expected event that can happen for several reasons. One of these reasons is data drift, where there is a change in the profile of the data on which predictions are being made. Another is concept drift, where the expectations of what constitutes correct predictions can change over time. For example, the statistical properties of a target variable, such as stocking inventory, may change over time as consumer preferences change. The large variety of factors that contribute to data and concept drift make model monitoring an important task. It enables users to be aware when these changes compromise the prediction quality of production models. ","","OML Services model monitoring is supported for classification and regression models and performance is tracked using model accuracy metrics. For classification, these quality metrics include:","* Accuracy","* Balanced accuracy","* AUC","* F1","* Precision","* Recall","","For regression, these accuracy metrics include:","* Mean squared error","* Mean absolute error","* Mean square log error","* Median absolute error","","### **Model monitoring workflow**","","In this notebook we highlight the following features of model monitoring through the REST interface:","","* Authenticate the database user and obtain a token","* Create a model monitoring job","* View the details and output of the model monitoring job","* Update, disable, and delete a model monitoring job","","The dataset used in this example is from the [UCI Machine Learning Repository](https://archive.ics.uci.edu/ml/datasets/individual+household+electric+power+consumption). It contains measurements of household electric power consumption in one household near Paris with a one-minute sampling rate over a period of almost 4 years.","","","Copyright (c) 2024 Oracle Corporation ","###### <a href=\"https://oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0<\/a>","---"],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"For more information...","message":["%md","","* <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/omlss/omlss/omls-model-monitoring.html\" target=\"_blank\">OML Model Monitoring<\/a>","* <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/omlss/omlss/index.html\" target=\"_blank\">OML Services REST API<\/a>","* <a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">ADB documentation<\/a>","* <a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML GitHub<\/a>","* <a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML website<\/a>","* <a href=\"https://asktom.oracle.com/pls/apex/asktom.search?oh=13662\" target=\"_blank\">OML Services demonstration<\/a>","","For data monitoring, refer to the Data Monitoring notebook in the template notebook examples."],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Before you begin","message":["%md","","This notebook walks through the steps to run a model monitoring job through a REST interface on a model deployed to OML Services. To follow these steps, you must already have your own model deployed to OML Services. ","","If you do not know how to deploy a model to OML Services you can:","* Use the example notebook \"OML4SQL Exporting Serialized Models\" for a guide on how to deploy a model to OML Services using the notebook interface.","* Deploy from OML AutoML UI as described here: <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml-automl-ui/amlui/deploy.html\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/machine-learning/oml-automl-ui/amlui/deploy.html');\">https://docs.oracle.com/en/database/oracle/machine-learning/oml-automl-ui/amlui/deploy.html<\/a>","","The **cURL** commands provided in this notebook are for illustrative purposes only. To run REST calls, use **cURL** in a Linux or Mac terminal or another REST client such as Postman."],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Step 1: Get an access token","message":["%md","","To send requests to OML Services, you must obtain an authentication token by using your Oracle Machine Learning account credentials. To authenticate and obtain a token, use **cURL** with the **-d** option to pass the credentials for your Oracle Machine Learning account against the Oracle Machine Learning user management cloud service REST endpoint */oauth2/v1/token*. ","","    $ curl -X POST --header 'Content-Type: application/json' --header 'Accept: application/json' -d '{\"grant_type\":\"password\", \"username\":\"'<yourusername>'\", ","    \"password\":\"' <yourpassword>'\"}' \"<OML service URL>/omlusers/api/oauth2/v1/token\"","    ","where   ","","* _-X POST_ specifies to use a POST request when communicating with the HTTP server","* _--header_ defines the headers required for the request (application/json)","* _-d <data>_ sends the username and password authentication credentials as data in a POST request to the HTTP server","* _Content-Type_ and _Accept_ define the response format (JSON)","* _yourusername_ is the user name of a Oracle Machine Learning user with the default OML_DEVELOPER role","* _yourpassword_ is the password for the user name","* _OML service URL_ is the REST server portion of the Oracle Machine Learning cloud service"],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Step 2: Create a model monitoring job","message":["%md","","Now that you have a token, you can submit your model monitoring job. This request is sent to the */omlmod/v1/jobs* endpoint as a POST request. There are many parameters that can be specified for a job request, as shown below and divided into required and optional parameters.","","*Required:*","* _jobName_ specifies the name of the submitted job.","* _jobType_ specifies the type of job to be run, and is set to MODEL_MONITORING for model monitoring jobs. ","* _outputData_ is the output data identifier. The results of the job will be written to a table named {jobId}_{ouputData}.","* _baselineData_ is a table/view that contains baseline data to monitor. At least 50 rows per period are required for model monitoring, otherwise analysis is skipped. ","* _newData_ is a table/view with new data to be compared against the baseline. At least 50 rows per period are required for model monitoring, otherwise analysis is skipped. ","* _modelList_ is a list of models to be monitored, identified by their modelIds. By default, up to 20 models can be monitored by a single job.","","*Optional:*","* _disableJob_ is a flag to disable the job at submission. If not set, the default is false and the job is enabled at submission.","* _outputSchemaName_ is the database schema that owns the output table. If not specifiedthe output schema will be the same as the input schema.","* _inputSchemaName_ is the database schema that owns the input table/view. If not specified, the input schema will be the same as the username in the request token.","* _jobFlag_ is the name of a JobFlag to be used to filter jobs.","* _timeColumn_ is the name of a date or timestamp column in the new data. If not provided the entire newData is treated as one period. ","* _frequency_ indicates the time window unit that the monitoring is done on in the new data, which can be \"day\", \"week\", \"month\", or \"year\". If not provided, the entire \"new\" data is used as a single time period. ","* _threshold_ is the threshold to trigger a drift alert. ","* _recompute_ is a flag on whether to update already computed periods. The default is False, meaning only time periods not present in the output result table will be computed. ","* _performanceMetric_ is The metric used to measure model performance. This is defaulted to MEAN\\_SQUARED\\_ERROR for regression models and BALANCED_ACCURACY for classification models.","* _caseidColumn_ is a case identifier column in the baseline and new data. Providing it improves the reproducability of results. ","* _startDate_ is used when timeColumn is specified. It is the start date and time of monitoring in newData. If not provided, the earliest date and time is used. ","* _endDate_ is used when timeColumn is specified. It is the end date and time of the monitoring in newData. If not provided, the last date and time is used.","* _jobDescription_ is a text description of the job.","* _jobServiceLevel_ is the service level for the job, which can be LOW, MEDIUM, or HIGH."],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Example model monitoring job","message":["%md","","Here is an example of a model monitoring job request using these parameters. To start, you will need the model ID(s) for the model(s) that you want to monitor. You can get the model ID by sending a GET request to the deployment endpoint and specifying the model URI. The model URI is provided by the user when deploying the model using the AutoML UI or when deploying the model through a REST client. Here, the model URI is **HousePowerNN**.  ","","Note that we are using *jq*, a command-line JSON processor available on Linux and Mac OS systems, to extract relevant components from the response."],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":"Retrieve model ID","message":["","$ curl -X GET \"<OML Service URL>/omlmod/v1/deployment/HousePowerNN\" \\","       --header \"Authorization: Bearer <token>\" | jq '.modelId'","","returns the model Id:","","  \"modelId\": \"0bf13d1f-86a6-465d-93d1-8985afd1bbdb\""],"enabled":false,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":null},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Inititate model monitoring job","message":["%md","","","Model monitoring jobs are initiated by sending a POST request to the */omlmod/v1/jobs* endpoint. The request body may include a single model, or a list of up to 20 models identified by their model IDs. The job start and end dates, job frequency, and maximum number of runs are specified in the **jobSchedule** property.","","The details for model monitoring are specified in **jobProperties**, including:","* model monitoring job name and type","* Autonomous Database service level","* table where the model monitoring details will be saved","* drift alert trigger threshold","* maximum number of runs","* baseline and new data to be used","* chosen balanced accuracy for the performance metric","","The optional start date and end date correspond to a DATE or TIMESTAMP column in the table or view denoted by **newData** and contained in the **timeColumn** field. ","","The job is submitted asynchronously, so it will run as scheduled and the results can be retrieved when the job completes."],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"cURL command to initiate model monitoring job","message":["","$ curl -X POST \"<OML Service URL>/omlmod/v1/jobs\" \\","         --header \"Authorization: Bearer <token>\" \\","         --header 'Content-Type: application/json' \\","         --data '{","            \"jobSchedule\": {","            \"jobStartDate\": \"2023-03-25T00:30:07Z\",                 # job start date and time ","            \"repeatInterval\": \"FREQ=DAILY\",                         # job frequency","            \"jobEndDate\": \"2023-03-30T20:50:06Z\",                   # job end date and time ","            \"maxRuns\": \"5\"                                          # max runs within the schedule","         },","         \"jobProperties\": {","            \"jobName\": \"MY_MODEL_MONITOR1\",                         # job name","            \"jobType\": \"MODEL_MONITORING\",                          # job type; MODEL_MONITORING","            \"disableJob\": false,                                    # flag to disable the job at submission","            \"jobServiceLevel\": \"LOW\",                               # Autonomous Database service level; either LOW, MEDIUM, and HIGH","            \"inputSchemaName\": \"OMLUSER\",                           # database schema that owns the input table/view","            \"outputSchemaName\": \"OMLUSER\",                          # database schema that owns the output table","            \"outputData\": \"Global_Active_Power_Monitor\",            # table where the job results will be saved in the format {jobID}_{outputData}","            \"jobDescription\": \"Global active power monitoring job\", # job description","            \"baselineData\": \"HOUSEHOLD_POWER_BASE\",                 # table/view containing baseline data ","            \"newData\": \"HOUSEHOLD_POWER_NEW\",                       # table/view with new data to compare against baseline","            \"frequency\": \"Year\",                                    # time window unit that the monitoring is done on in the new data","            \"threshold\": 0.15,                                      # threshold to trigger drift alert","            \"timeColumn\": \"DATES\",                                  # date or timestamp column in newData","            \"startDate\": \"2008-01-01T00:00:00Z\",                    # the start date and time of monitoring in the new data","            \"endDate\": \"2010-11-26T00:00:00Z\",                      # the end date and time of monitoring in the new data","            \"caseidColumn\": null,                                   # case identifier column in the baseline and new data","            \"performanceMetric\": \"MEAN_SQUARED_ERROR\",              # metric used to measure model performance","            \"modelList\": [                                          # model ID or list of model IDs to be monitored","                \"0bf13d1f-86a6-465d-93d1-8985afd1bbdb\"","             ],","            \"recompute\": false                                      # flag to determine whether to overwrite the results table","         }","    }' | jq","    "],"enabled":false,"result":{"startTime":1700071260844,"interpreter":"md.low","endTime":1700071260937,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":null},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"A successful job submission returns a job ID","message":["%md","","When the job is successfully submitted, you will receive a response similar to the following. Note the **jobId**, as you will use it to submit requests such as retrieving job details or performing an action on the job."],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":"Job ID returned ","message":["","{","  \"jobId\": \"OML$736F509B_FC1A_400A_AC75_553F1D6C5D97\",","  \"links\": [","    {","      \"rel\": \"self\",","      \"href\": \"<OML Service URL>/v1/jobs/OML%24736F509B_FC1A_400A_AC75_553F1D6C5D97\"","    }","  ]","}"],"enabled":false,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":null},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Step 3: View the details of a submitted job","message":["%md","","You can now view the details of your submitted job with a GET request to the */omlmod/v1/jobs/{jobId}* endpoint, where **jobId** is the ID provided in response to the successful submission of your model monitoring job in the previous step. The **jobStatus** *CREATED* indicates the job as been created. If your job has already ran at least once, you will see infomation returned about the last job run. "],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":"Submitted job details","message":["","$ export jobid='OML$736F509B_FC1A_400A_AC75_553F1D6C5D97'   # define the Job ID as a single-quoted variable ","","$ curl -X GET \"<OML Service URL>/omlmod/v1/jobs/<jobid>\"  \\","       --header 'Accept: application/json' \\","       --header 'Content-Type: application/json' \\","       --header \"Authorization: Bearer <token>\" | jq","","returns:","","{","  \"jobId\": \"OML$736F509B_FC1A_400A_AC75_553F1D6C5D97\",","  \"jobRequest\": {","    \"jobSchedule\": {","      \"jobStartDate\": \"2023-03-25T00:30:07Z\",","      \"repeatInterval\": \"FREQ=DAILY\",","      \"jobEndDate\": \"2023-03-30T00:30:07Z\",","      \"maxRuns\": 5","    },","    \"jobProperties\": {","      \"jobType\": \"MODEL_MONITORING\",","      \"inputSchemaName\": \"OMLUSER\",","      \"outputSchemaName\": \"OMLUSER\",","      \"outputData\": \"Global_Active_Power_Monitor\",","      \"jobDescription\": \"Global active power monitoring job\",","      \"jobName\": \"MY_MODEL_MONITOR1\",","      \"disableJob\": false,","      \"jobServiceLevel\": \"LOW\",","      \"baselineData\": \"HOUSEHOLD_POWER_BASE\",","      \"newData\": \"HOUSEHOLD_POWER_NEW\",","      \"timeColumn\": \"DATES\",","      \"startDate\": \"2008-01-01T00:00:00Z\",","      \"endDate\": \"2010-11-26T00:00:00Z\",","      \"frequency\": \"Year\",","      \"threshold\": 0.15,","      \"recompute\": false,","      \"caseidColumn\": null,","      \"modelList\": [","        \"0bf13d1f-86a6-465d-93d1-8985afd1bbdb\"","      ],","      \"performanceMetric\": \"MEAN_SQUARED_ERROR\"","    }","  },","  \"jobStatus\": \"CREATED\",","  \"dateSubmitted\": \"2023-03-25T00:26:16.127906Z\",","  \"links\": [","    {","      \"rel\": \"self\",","      \"href\": \"<OML Service URL>/omlmod/v1/jobs/OML%24736F509B_FC1A_400A_AC75_553F1D6C5D97\"","    }","  ],","  \"jobFlags\": [],","  \"state\": \"SCHEDULED\",","  \"enabled\": true,","  \"runCount\": 0,","  \"nextRunDate\": \"2023-03-25T00:30:07Z\"","}"],"enabled":false,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":null},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Step 4: Update a model monitoring job (optional)","message":["%md","","After an asynchronous job is submitted, you have the option to update the job. You can do this by sending a POST request with the updated options in the *updateProperties* field to the */omlmod/v1/jobs/{jobid}* endpoint. The following parameters can be updated with this request for a model monitoring job:","","* _startDate_","* _endDate_","* _threshold_","* _recompute_","* _modelList_","","In the example request below, using the same job ID, we update some of these original parameters in the **updateProperties** field. The trigger for the drift alert is updated to 0.20, and the flag *recompute* is set to update already computed periods so that each job run will recalculate all time periods present in the specified **timeColumn** in the data.","","A successful update will receive an HTTP 204 response with no content."],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":"Update job properties","message":["","$ curl -i -X POST \"<OML Service URL>/omlmod/v1/jobs/<jobid>\" \\    ","         --header \"Authorization: Bearer <token>\" \\","         --header 'Content-Type: application/json' \\","         --data '{","            \"updateProperties\": {","                \"threshold\": 0.20,","                \"recompute\": \"true\"","            }","         }'","         "],"enabled":false,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":null},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Step 5: View model monitoring job output","message":["%md","","Once your job has run, either according to its schedule or by the **RUN** action, you can view its output in the table you specified in your job request with the **outputData** parameter. The full name of the table is *{jobid}\\_{outputData}*. You can check if your job is finished by sending a request to view its details, as we did in step 3. If your job has run at least once you should see the **lastRunDetail** field with information on that run. The next paragraph queries the output table associated with this example. ","","It is important to note that the first row of results is the baseline time period. That is the reason the **HAS_DRIFT**, **DRIFT**, **THRESHOLD** columns are empty for this row, as drift is not calculated on data in the baseline time period. ","","","For more information on the output table, refer to the <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/omlss/omlss/omls-model-monitoring-output-table.html\" target=\"_blank\">OML Services documentation.<\/a>"],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Query to view model monitoring output","message":["%sql","","","SELECT IS_BASELINE, MODEL_ID, round(METRIC, 4), HAS_DRIFT, round(DRIFT, 4), MODEL_TYPE, ","       THRESHOLD, MODEL_METRICS ","FROM OML$736F509B_FC1A_400A_AC75_553F1D6C5D97_Global_Active_Power_Monitor"],"enabled":false,"result":{"startTime":1700071262025,"interpreter":"sql.low","endTime":1700071263764,"results":[{"message":"IS_BASELINE\tMODEL_ID\tROUND(METRIC,4)\tHAS_DRIFT\tROUND(DRIFT,4)\tMODEL_TYPE\tTHRESHOLD\tMODEL_METRICS\n0\t0bf13d1f-86a6-465d-93d1-8985afd1bbdb\t0.0017\t1\t0.1608\tREGRESSION\t0.15\t{\"R2\":0.99809,\"Mean squared error\":0.0017396,\"Mean absolute error\":0.027297,\"Median absolute error\":0.019593,\"prediction_statistics\":{\"population_stability_index\":0.025958,\"mean_value\":1.0815,\"min_value\":0.12529,\"max_value\":9.5666,\"standard_deviation\":0.94483,\"bin_distribution\":[{\"bin_upper_boundary\":2.0897,\"bin_percentage\":0.87908},{\"bin_upper_boundary\":4.0855,\"bin_percentage\":0.10714},{\"bin_upper_boundary\":6.0813,\"bin_percentage\":0.012538},{\"bin_upper_boundary\":8.0771,\"bin_percentage\":0.001173},{\"bin_upper_boundary\":null,\"bin_percentage\":0.000068328}]},\"most_impactful_features\":[{\"feature_name\":\"GLOBAL_INTENSITY\",\"feature_impact\":1016.4},{\"feature_name\":\"SUB_METERING_3\",\"feature_impact\":4.1294},{\"feature_name\":\"VOLTAGE\",\"feature_impact\":0.48653},{\"feature_name\":\"GLOBAL_REACTIVE_POWER\",\"feature_impact\":0.32686},{\"feature_name\":\"SUB_METERING_1\",\"feature_impact\":0.19106},{\"feature_name\":\"SUB_METERING_2\",\"feature_impact\":0.072071}]}\n1\t0bf13d1f-86a6-465d-93d1-8985afd1bbdb\t0.0015\t\t\tREGRESSION\t\t{\"R2\":0.99893,\"Mean squared error\":0.0014987,\"Mean absolute error\":0.02293,\"Median absolute error\":0.016582,\"prediction_statistics\":{\"mean_value\":1.1484,\"min_value\":0.093934,\"max_value\":10.073,\"standard_deviation\":1.1787,\"bin_distribution\":[{\"bin_upper_boundary\":2.0897,\"bin_percentage\":0.82757},{\"bin_upper_boundary\":4.0855,\"bin_percentage\":0.14257},{\"bin_upper_boundary\":6.0813,\"bin_percentage\":0.02613},{\"bin_upper_boundary\":8.0771,\"bin_percentage\":0.0035318},{\"bin_upper_boundary\":null,\"bin_percentage\":0.00020088}]},\"most_impactful_features\":[{\"feature_name\":\"GLOBAL_INTENSITY\",\"feature_impact\":1754.9},{\"feature_name\":\"SUB_METERING_3\",\"feature_impact\":3.0614},{\"feature_name\":\"VOLTAGE\",\"feature_impact\":0.92329},{\"feature_name\":\"GLOBAL_REACTIVE_POWER\",\"feature_impact\":0.28173},{\"feature_name\":\"SUB_METERING_1\",\"feature_impact\":0.22032},{\"feature_name\":\"SUB_METERING_2\",\"feature_impact\":0.10669}]}\n0\t0bf13d1f-86a6-465d-93d1-8985afd1bbdb\t0.0015\t0\t0.0103\tREGRESSION\t0.15\t{\"R2\":0.99865,\"Mean squared error\":0.0015141,\"Mean absolute error\":0.025352,\"Median absolute error\":0.019308,\"prediction_statistics\":{\"population_stability_index\":0.011901,\"mean_value\":1.0436,\"min_value\":0.045116,\"max_value\":9.8458,\"standard_deviation\":1.0626,\"bin_distribution\":[{\"bin_upper_boundary\":2.0897,\"bin_percentage\":0.8657},{\"bin_upper_boundary\":4.0855,\"bin_percentage\":0.11415},{\"bin_upper_boundary\":6.0813,\"bin_percentage\":0.017624},{\"bin_upper_boundary\":8.0771,\"bin_percentage\":0.0023127},{\"bin_upper_boundary\":null,\"bin_percentage\":0.00020623}]},\"most_impactful_features\":[{\"feature_name\":\"GLOBAL_INTENSITY\",\"feature_impact\":1389.6},{\"feature_name\":\"SUB_METERING_3\",\"feature_impact\":3.7846},{\"feature_name\":\"VOLTAGE\",\"feature_impact\":0.5429},{\"feature_name\":\"GLOBAL_REACTIVE_POWER\",\"feature_impact\":0.33221},{\"feature_name\":\"SUB_METERING_1\",\"feature_impact\":0.21555},{\"feature_name\":\"SUB_METERING_2\",\"feature_impact\":0.089874}]}\n0\t0bf13d1f-86a6-465d-93d1-8985afd1bbdb\t0.0015\t0\t0.0164\tREGRESSION\t0.15\t{\"R2\":0.9985,\"Mean squared error\":0.0015232,\"Mean absolute error\":0.025032,\"Median absolute error\":0.018151,\"prediction_statistics\":{\"population_stability_index\":0.017769,\"mean_value\":1.0709,\"min_value\":0.09097,\"max_value\":10.3,\"standard_deviation\":1.006,\"bin_distribution\":[{\"bin_upper_boundary\":2.0897,\"bin_percentage\":0.87348},{\"bin_upper_boundary\":4.0855,\"bin_percentage\":0.10839},{\"bin_upper_boundary\":6.0813,\"bin_percentage\":0.016178},{\"bin_upper_boundary\":8.0771,\"bin_percentage\":0.0018322},{\"bin_upper_boundary\":null,\"bin_percentage\":0.00012747}]},\"most_impactful_features\":[{\"feature_name\":\"GLOBAL_INTENSITY\",\"feature_impact\":1280.4},{\"feature_name\":\"SUB_METERING_3\",\"feature_impact\":4.4025},{\"feature_name\":\"VOLTAGE\",\"feature_impact\":0.47583},{\"feature_name\":\"GLOBAL_REACTIVE_POWER\",\"feature_impact\":0.35687},{\"feature_name\":\"SUB_METERING_1\",\"feature_impact\":0.20914},{\"feature_name\":\"SUB_METERING_2\",\"feature_impact\":0.082932}]}\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":null},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Step 6: Perform an action on a model monitoring job (optional)","message":["%md","","OML Services interacts with the DBMS_SCHEDULER to perform actions on jobs. There are four options for actions that can be sent to this endpoint, **DISABLE**, **RUN**, **ENABLE**, and **STOP**:","","* _DISABLE_ disables the job at submission. The *force* property can be used with this action to forcefully interrupt any running job. ","* _ENABLE_ enables a job. After a disabled job is enabled, the scheduler begins to automatically run the job according to its schedule. ","* _RUN_ will immediately run the job as a way to test a job or run it outside of its schedule.","* _STOP_ stops a currently running job.","","For example, when your job has been successfully submitted, its state is set to **ENABLED** by default. This means that it will run on the schedule you specified when submitting the job unless its updated to another state, such as **DISABLED**. You can do this by sending a request to the */omlmod/v1/jobs/{jobid}/action* endpoint. ","","Note that jobs can be set to **DISABLED** at submission by setting the *disableJob* flag to *true*.","","Below is an example request to update the job status to **DISABLED**. When you successfully submit your job you will receive a 204 response with no body. "],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":"Disable a job","message":["","$ curl -i -X POST \"<OML Service URL>/omlmod/v1/jobs/<jobid>/action\" \\","       --header \"Authorization: Bearer <token>\" \\","       --header 'Content-Type: application/json' \\","       --data '{","            \"action\": \"DISABLE\",","            \"force\": \"false\"","         }'"],"enabled":false,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":null},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Step 7: Delete a model monitoring job (optional)","message":["%md","","To delete a previously submitted job, send a DELETE request along with the Job ID to the */omlmod/v1/jobs* endpoint."],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":"cURL command to delete a job","message":["","$ curl -X DELETE \"<omlserver>/omlmod/v1/jobs/<jobid>\"  \\","       --header 'Accept: application/json' \\","       --header 'Content-Type: application/json' \\","       --header \"Authorization: Bearer <token>\" | jq"],"enabled":false,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":null},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Reproducing this example","message":["%md","","If you would like to reproduce the example in this notebook, the paragraph below creates the required database tables, *HOUSEHOLD_POWER_BASE* and *HOUSEHOLD_POWER_NEW*. These tables are created using the Individual Household Electric Power Consumption data from the [UCI Machine Learning Repository](https://archive.ics.uci.edu/ml/datasets/individual+household+electric+power+consumption).","","The code to read and transform the data and create database tables using R is provided below."],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Drop tables if they exist and suppress warnings","message":["%r","","options(warn=-1)","","try(ore.drop(table=\"HOUSEHOLD_POWER_BASE\"))","try(ore.drop(table=\"HOUSEHOLD_POWER_NEW\"))"],"enabled":true,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Read and transform data","message":["%r","","test <- read.csv(\"https://objectstorage.us-sanjose-1.oraclecloud.com/n/adwc4pm/b/OML_Data/o/household_power_consumption.txt\", sep=\";\")","","test <- transform(test, Date = as.Date(Date, format = \"%d/%m/%Y\"))","test <- transform(test, Global_active_power = as.numeric(Global_active_power))","test <- transform(test, Global_reactive_power = as.numeric(Global_reactive_power))","test <- transform(test, Voltage = as.numeric(Voltage))","test <- transform(test, Global_intensity = as.numeric(Global_intensity))","test <- transform(test, Sub_metering_1 = as.numeric(Sub_metering_1))","test <- transform(test, Sub_metering_2 = as.numeric(Sub_metering_2))","test <- transform(test, Sub_metering_3 = as.numeric(Sub_metering_3))","","colnames(test) <- c(\"DATES\", \"TIMES\", \"GLOBAL_ACTIVE_POWER\", \"GLOBAL_REACTIVE_POWER\", \"VOLTAGE\", \"GLOBAL_INTENSITY\", \"SUB_METERING_1\", \"SUB_METERING_2\", \"SUB_METERING_3\") "],"enabled":true,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Create baseline and new data","message":["%r","","test_base <- test[test$DATES < \"2008-01-01\",]","test_new <- test[test$DATES > \"2007-12-31\",]","","# Create OML proxy objects","","ore.create(test_base, table=\"HOUSEHOLD_POWER_BASE\")","ore.create(test_new, table=\"HOUSEHOLD_POWER_NEW\")"],"enabled":true,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"View the baseline data","message":["%sql","","SELECT * FROM HOUSEHOLD_POWER_BASE","FETCH FIRST 5 ROWS ONLY;"],"enabled":true,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"View the new data","message":["%sql","","SELECT * FROM HOUSEHOLD_POWER_NEW","FETCH FIRST 5 ROWS ONLY;"],"enabled":true,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","## End of Script"],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":null,"message":["%md"," "],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":0,"hideResult":true,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"}],"version":"6","snapshot":false,"tags":null}]