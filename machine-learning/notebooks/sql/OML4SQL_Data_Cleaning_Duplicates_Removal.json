{"paragraphs":[{"text":"%md\n\n## OML4SQL Data Cleaning: Duplicates Removal\nIn this notebook, we demonstrate how to remove duplicate records using Oracle SQL.\n\nWe use the customer insurance lifetime value data set which contains customer financial information, lifetime value, and whether or not the customer bought insurance.\n\nThe dataset `CUSTOMER_INSURANCE_LTV_SQL` is generated by the `\"OML Run-me-first\"` notebook, which `MUST` be run before this notebook.\n\n---\n\n##### `IMPORTANT`: The `\"OML Run-me-first\"` notebook is available under the menu Templates -> Examples and is a pre-requisite to the current notebook.\n\n---\nCopyright (c) 2021 Oracle Corporation \n###### <a href=\"https://oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0</a>\n---","user":"OMLUSER","dateUpdated":"2021-08-25T05:03:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>OML4SQL Data Cleaning: Duplicates Removal</h2>\n<p>In this notebook, we demonstrate how to remove duplicate records using Oracle SQL.</p>\n<p>We use the customer insurance lifetime value data set which contains customer financial information, lifetime value, and whether or not the customer bought insurance.</p>\n<p>The dataset <code>CUSTOMER_INSURANCE_LTV_SQL</code> is generated by the <code>\"OML Run-me-first\"</code> notebook, which <code>MUST</code> be run before this notebook.</p>\n<hr />\n<h5><code>IMPORTANT</code>: The <code>\"OML Run-me-first\"</code> notebook is available under the menu Templates -> Examples and is a pre-requisite to the current notebook.</h5>\n<hr />\n<p>Copyright (c) 2021 Oracle Corporation</p>\n<h6><a href=\"https: //oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0</a></h6>\n<hr />\n"}]},"interrupted":false,"jobName":"paragraph_1629867718066_-1918835956","id":"20210825-050158_1645245872","dateCreated":"2020-12-15T19:55:22+0000","dateStarted":"2021-08-25T05:03:06+0000","dateFinished":"2021-08-25T05:03:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"focus":true,"$$hashKey":"object:40"},{"title":"Check the number of distinct customer id","text":"%sql\n\nSELECT COUNT(DISTINCT CUSTOMER_ID)\nFROM CUSTOMER_INSURANCE_LTV_SQL","user":"OMLUSER","dateUpdated":"2021-08-25T05:09:19+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"COUNT(DISTINCTCUSTOMER_ID)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/text","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"COUNT(DISTINCTCUSTOMER_ID)\n13880\n"}]},"interrupted":false,"jobName":"paragraph_1629867718067_-170055397","id":"20210825-050158_1954884485","dateCreated":"2020-11-16T18:14:20+0000","dateStarted":"2021-01-06T19:09:18+0000","dateFinished":"2021-01-06T19:09:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:41"},{"title":"Check the number of total rows in the table. There are duplicated rows","text":"%sql\n\nSELECT COUNT(1) FROM CUSTOMER_INSURANCE_LTV_SQL","user":"OMLUSER","dateUpdated":"2021-08-25T05:09:21+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"COUNT(1)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/text","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"COUNT(1)\n14880\n"}]},"interrupted":false,"jobName":"paragraph_1629867718067_-1352482826","id":"20210825-050158_365368532","dateCreated":"2020-11-16T18:15:09+0000","dateStarted":"2021-01-06T19:09:19+0000","dateFinished":"2021-01-06T19:09:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:42"},{"title":"Create a view with all distinct rows","text":"%sql\n\nCREATE OR REPLACE VIEW CUSTOMER_INSURANCE_LTV_SQL_UNIQUE AS \nselect *\nfrom CUSTOMER_INSURANCE_LTV_SQL\nwhere rowid in (\n\n    select  max(rowid) row_id\n    from (\n        select customer_id, rowid\n        from CUSTOMER_INSURANCE_LTV_SQL\n        )\n    group by customer_id\n ) ","user":"OMLUSER","dateUpdated":"2021-08-25T05:09:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"COUNT(1)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/text","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"interrupted":false,"jobName":"paragraph_1629867718067_1732680769","id":"20210825-050158_341466696","dateCreated":"2020-11-16T22:15:15+0000","dateStarted":"2021-01-06T19:09:20+0000","dateFinished":"2021-01-06T19:09:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:43"},{"title":"Check the number of rows in the table. All rows are distinct","text":"%sql\n\nSELECT COUNT(1) FROM CUSTOMER_INSURANCE_LTV_SQL_UNIQUE","user":"OMLUSER","dateUpdated":"2021-08-25T05:09:13+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"COUNT(1)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/text","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"COUNT(1)\n13880\n"}]},"interrupted":false,"jobName":"paragraph_1629867718067_-1909271624","id":"20210825-050158_1963332742","dateCreated":"2020-11-16T18:18:28+0000","dateStarted":"2021-01-06T19:09:21+0000","dateFinished":"2021-01-06T19:09:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:44"},{"title":"Check the number of distinct CUSTOMER_ID in the table","text":"%sql\n\nSELECT COUNT(DISTINCT CUSTOMER_ID) FROM CUSTOMER_INSURANCE_LTV_SQL_UNIQUE","user":"OMLUSER","dateUpdated":"2021-08-25T05:09:15+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"COUNT(DISTINCTCUSTOMER_ID)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"text","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/text","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"COUNT(DISTINCTCUSTOMER_ID)\n13880\n"}]},"interrupted":false,"jobName":"paragraph_1629867718067_-1565656618","id":"20210825-050158_671273120","dateCreated":"2020-11-16T18:18:40+0000","dateStarted":"2021-01-06T19:09:21+0000","dateFinished":"2021-01-06T19:09:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:45"},{"text":"%md\n\n# End of Script\n","user":"OMLUSER","dateUpdated":"2021-08-25T05:03:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>End of Script</h1>\n"}]},"interrupted":false,"jobName":"paragraph_1629867718067_-744387780","id":"20210825-050158_97386688","dateCreated":"2020-11-17T00:34:19+0000","dateStarted":"2021-01-06T19:09:22+0000","dateFinished":"2021-01-06T19:09:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:46"},{"text":"%md\n","user":"OMLUSER","dateUpdated":"2021-08-25T05:03:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1629867718067_-80439083","id":"20210825-050158_1134601775","dateCreated":"2020-12-15T19:58:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:47"}],"name":"OML4SQL Data Cleaning Duplicates Removal","id":"74347","noteParams":{},"noteForms":{},"angularObjects":{"MDW381939C745:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}