[{"layout":null,"template":null,"templateConfig":null,"name":"OML4SQL Feature Selection Using Summary Statistics","description":null,"readOnly":false,"type":"low","paragraphs":[{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":null,"message":[],"enabled":true,"result":{"startTime":1715708966660,"interpreter":"md.low","endTime":1715708966723,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":0,"hideResult":true,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","# OML4SQL Feature Selection: Summary Information","In this notebook, we demonstrate how to do feature selection using summary statistics via Oracle SQL.","","We use the customer insurance lifetime value data set which contains customer financial information, lifetime value, and whether or not the customer bought insurance.","","We show how to use Oracle SQL to select features based on number of distinct values, null values, proportion of constant values. ","","The dataset `CUSTOMER_INSURANCE_LTV_SQL` is generated by the `\"OML Run-me-first\"` notebook, which `MUST` be run before this notebook.","","---","","##### `IMPORTANT`: The `\"OML Run-me-first\"` notebook is available under the menu Templates -> Examples and is a pre-requisite to the current notebook.","","---","","Copyright (c) 2024 Oracle Corporation ","###### <a href=\"https://oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0<\/a>","---"],"enabled":true,"result":{"startTime":1715708966802,"interpreter":"md.low","endTime":1715708966863,"results":[{"message":"<h1 id=\"oml4sql-feature-selection-summary-information\">OML4SQL Feature Selection: Summary Information<\/h1>\n<p>In this notebook, we demonstrate how to do feature selection using summary statistics via Oracle SQL.<\/p>\n<p>We use the customer insurance lifetime value data set which contains customer financial information, lifetime value, and whether or not the customer bought insurance.<\/p>\n<p>We show how to use Oracle SQL to select features based on number of distinct values, null values, proportion of constant values.<\/p>\n<p>The dataset <code>CUSTOMER_INSURANCE_LTV_SQL<\/code> is generated by the <code>&quot;OML Run-me-first&quot;<\/code> notebook, which <code>MUST<\/code> be run before this notebook.<\/p>\n<hr />\n<h5 id=\"important-the-oml-run-me-first-notebook-is-available-under-the-menu-templates---examples-and-is-a-pre-requisite-to-the-current-notebook\"><code>IMPORTANT<\/code>: The <code>&quot;OML Run-me-first&quot;<\/code> notebook is available under the menu Templates -&gt; Examples and is a pre-requisite to the current notebook.<\/h5>\n<hr />\n<p>Copyright (c) 2024 Oracle Corporation<\/p>\n<h6 id=\"the-universal-permissive-license-upl-version-10\"><a href=\"https://oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0<\/a><\/h6>\n<hr />\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"For more information...","message":["%md","","* <a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a>","* <a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a>","* <a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a>","* <a href=\"https://docs.oracle.com/en/database/oracle/oracle-database/21/arpls/DBMS_STATS.html#GUID-CA6A56B9-0540-45E9-B1D7-D78769B7714C\" target=\"_blank\">SQL DBMS_STATS.GATHER_TABLE_STATS Documentation<\/a>","* <a href=\"https://www.oracle.com/goto/ml-feature-selection\" target=\"_blank\">OML Attribute Importance<\/a>"],"enabled":true,"result":{"startTime":1715708966940,"interpreter":"md.low","endTime":1715708967002,"results":[{"message":"<ul>\n<li><a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a><\/li>\n<li><a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a><\/li>\n<li><a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a><\/li>\n<li><a href=\"https://docs.oracle.com/en/database/oracle/oracle-database/21/arpls/DBMS_STATS.html#GUID-CA6A56B9-0540-45E9-B1D7-D78769B7714C\" target=\"_blank\">SQL DBMS_STATS.GATHER_TABLE_STATS Documentation<\/a><\/li>\n<li><a href=\"https://www.oracle.com/goto/ml-feature-selection\" target=\"_blank\">OML Attribute Importance<\/a><\/li>\n<\/ul>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Data overview","message":["%sql\r","\r","SELECT *\r","FROM CUSTOMER_INSURANCE_LTV_SQL\r","FETCH FIRST 10 ROWS ONLY"],"enabled":true,"result":{"startTime":1715708967081,"interpreter":"sql.low","endTime":1715708967180,"results":[{"message":"MARITAL_STATUS\tSTATE\tCREDIT_BALANCE\tCUSTOMER_TENURE\tMORTGAGE_AMOUNT\tBANK_FUNDS\tNUM_DEPENDENTS\tHAS_CHILDREN\tINCOME\tCUSTOMER_ID\tGENDER\tPROFESSION\tCREDIT_CARD_LIMITS\tREGION\tHOME_OWNERSHIP\tNUM_ONLINE_TRANS\tBUY_INSURANCE\tMONTHLY_CHECKS\tNUM_TRANS_KIOSK\tAGE\tMONEY_MONTLY_OVERDRAWN\tLTV\tTOTAL_AUTOM_PAYMENTS\tNUM_TRANS_TELLER\tCHECKING_BALANCE\tNUM_TRANS_ATM\tLTV_BIN\tFIRST_NAME\tNUM_MORTGAGES\tCAR_OWNERSHIP\tLAST_NAME\nSINGLE\tCA                        \t0\t3\t400\t590\t3\t1\t61384\tCU8720                    \tM                         \tWaiter/Waitress\t1000\tWest\t1\t400\tYes\t2\t1\t23\t53.98\t18146\t208\t2\t25\t5\tMEDIUM\tKENNETH\t1\t1\tNADEAU\nDIVORCED\tWA                        \t0\t3\t2050\t650\t3\t1\t63525\tCU8721                    \tM                         \tSoftware Engineer\t1000\tWest\t1\t2050\tYes\t13\t3\t22\t54.35\t18581.25\t242\t2\t25\t5\tMEDIUM\tJARVIS\t1\t1\tCLARKE\nDIVORCED\tNY                        \t0\t4\t2500\t700\t1\t0\t71504\tCU8722                    \tF                         \tIT Staff\t1000\tNorthEast\t1\t2500\tNo\t1\t1\t42\t53.79\t32076\t393\t3\t118\t4\tVERY HIGH\tSTACEY\t1\t1\tHENSON\nMARRIED\tMI                        \t0\t1\t8320\t11050\t1\t1\t72308\tCU8665                    \tF                         \tDentist\t4000\tMidwest\t1\t1700\tYes\t14\t1\t33\t53.97\t24877\t650\t4\t25\t5\tHIGH\tMARGRET\t1\t1\tRYAN\nMARRIED\tMI                        \t0\t1\t1000\t0\t1\t1\t64710\tCU8666                    \tM                         \tIT Staff\t700\tMidwest\t1\t1000\tNo\t4\t1\t38\t53.17\t23477.5\t383\t0\t374\t2\tHIGH\tJOAN\t1\t1\tBAUER\nDIVORCED\tNC                        \t0\t4\t4000\t8800\t6\t1\t61332\tCU9108                    \tF                         \tPROF-15\t800\tSouth\t1\t1600\tYes\t1\t1\t66\t54.97\t16933\t1923\t4\t25\t5\tMEDIUM\tMARGART\t1\t1\tCALDWELL\nMARRIED\tTX                        \t0\t3\t845\t450\t3\t1\t62061\tCU9113                    \tM                         \tProgrammer/Developer\t1500\tSouthwest\t1\t845\tYes\t8\t6\t26\t53.01\t18615.25\t226\t2\t25\t2\tMEDIUM\tNICKY\t1\t1\tBARON\nSINGLE\tNV                        \t0\t2\t0\t0\t0\t0\t74394\tCU9114                    \tM                         \tSales Representative\t1500\tSouthwest\t0\t0\tNo\t0\t1\t0\t53.06\t0\t0\t0\t25\t0\tLOW\tHUNG\t0\t0\tFINNEY\nSINGLE\tMI                        \t0\t3\t0\t0\t3\t0\t64255\tCU8462                    \tM                         \tPROF-31\t1500\tMidwest\t0\t0\tNo\t1\t1\t28\t53.14\t14363.75\t0\t0\t25\t2\tMEDIUM\tFREDDIE\t0\t0\tMAYBERRY\nDIVORCED\tMI                        \t0\t1\t2513\t1150\t1\t0\t70749\tCU8506                    \tM                         \tPlumber\t1000\tMidwest\t1\t2513\tNo\t11\t1\t48\t54.13\t30987.25\t6248\t3\t466\t5\tVERY HIGH\tJON\t1\t1\tDUTTON\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Create a view pointing to the same table","message":["%sql","","CREATE OR REPLACE VIEW CUSTOMER_INSURANCE_LTV_SQL_V AS ","SELECT * ","FROM CUSTOMER_INSURANCE_LTV_SQL"],"enabled":true,"result":{"startTime":1715708967279,"interpreter":"sql.low","endTime":1715708967361,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Call gather_table_stats procedure to collect the table statistics","message":["%script","","BEGIN","  DBMS_STATS.GATHER_TABLE_STATS (USER, TABNAME => 'CUSTOMER_INSURANCE_LTV_SQL');","END;"],"enabled":true,"result":{"startTime":1715708967431,"interpreter":"script.low","endTime":1715708968927,"results":[{"message":"\nPL/SQL procedure successfully completed.\n\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Check some of the table's statistics generated","message":["%sql","","SELECT column_name, num_distinct, density, num_nulls","FROM USER_TAB_COL_STATISTICS","WHERE TABLE_NAME = 'CUSTOMER_INSURANCE_LTV_SQL'","FETCH FIRST 10 ROWS ONLY"],"enabled":true,"result":{"startTime":1715708969007,"interpreter":"sql.low","endTime":1715708969518,"results":[{"message":"COLUMN_NAME\tNUM_DISTINCT\tDENSITY\tNUM_NULLS\nMARITAL_STATUS\t7\t0.0000605840300496789\t6627\nSTATE\t24\t0.0000336021505376344\t0\nCREDIT_BALANCE\t952\t0.000228\t6627\nCUSTOMER_TENURE\t5\t0.0000336021505376344\t0\nMORTGAGE_AMOUNT\t1748\t0.000219\t0\nBANK_FUNDS\t1205\t0.00049\t6627\nNUM_DEPENDENTS\t7\t0.0000336021505376344\t0\nHAS_CHILDREN\t2\t0.0000336021505376344\t0\nINCOME\t6455\t0.000155\t6627\nCUSTOMER_ID\t14076\t0.000071\t0\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Filter categorical 'identifier' columns - filter out columns with > 95% unique values","message":["%script","","SET SERVEROUTPUT ON;","DECLARE","    CNT INT;","    TOTAL INT;","    RATIO NUMBER;","    SELECTED_COLS VARCHAR2(1000);","BEGIN","    ","    RATIO := 0.95;","    SELECT COUNT(1) ","    INTO TOTAL","    FROM CUSTOMER_INSURANCE_LTV_SQL;","    ","    FOR REC IN (SELECT COLUMN_NAME, DATA_TYPE FROM USER_TAB_COLS WHERE ","                TABLE_NAME = 'CUSTOMER_INSURANCE_LTV_SQL' ","                AND DATA_TYPE IN ('CHAR', 'VARCHAR2'))","    LOOP","        ","        SELECT NUM_DISTINCT","        INTO CNT","        FROM USER_TAB_COL_STATISTICS","        WHERE TABLE_NAME = 'CUSTOMER_INSURANCE_LTV_SQL'","        AND COLUMN_NAME = REC.COLUMN_NAME;","        IF CNT > 1 AND CNT < RATIO*TOTAL THEN","            DBMS_OUTPUT.PUT_LINE(REC.COLUMN_NAME);    ","            IF SELECTED_COLS IS NULL THEN ","                SELECTED_COLS := REC.COLUMN_NAME;","            ELSE","                SELECTED_COLS := SELECTED_COLS||','||REC.COLUMN_NAME;","            END IF;","            ","        END IF;","        ","    END LOOP;","    EXECUTE IMMEDIATE 'CREATE OR REPLACE VIEW SELECTED_NO_IDENTIFIED_V AS SELECT '||SELECTED_COLS||' FROM CUSTOMER_INSURANCE_LTV_SQL';","END;"],"enabled":true,"result":{"startTime":1715708969595,"interpreter":"script.low","endTime":1715708970323,"results":[{"message":"\n---------------------------\nMARITAL_STATUS\nSTATE\nCUSTOMER_ID\nGENDER\nPROFESSION\nREGION\nBUY_INSURANCE\nLTV_BIN\nFIRST_NAME\nLAST_NAME\n\n\nPL/SQL procedure successfully completed.\n\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Use a View - without table statistics - filter categorical 'identifier' columns - filter columns with > 95% unique values ","message":["%script","","SET SERVEROUTPUT ON;","DECLARE","    CNT INT;","    TOTAL INT;","    RATIO NUMBER;","    SELECTED_COLS VARCHAR2(1000);","BEGIN","    ","    RATIO := 0.95;","    SELECT COUNT(1) ","    INTO TOTAL","    FROM CUSTOMER_INSURANCE_LTV_SQL_V;","    ","    FOR REC IN (SELECT COLUMN_NAME, DATA_TYPE FROM USER_TAB_COLS ","                WHERE TABLE_NAME = 'CUSTOMER_INSURANCE_LTV_SQL_V' ","                AND DATA_TYPE IN ('CHAR', 'VARCHAR2'))","    LOOP","        EXECUTE IMMEDIATE 'SELECT COUNT(DISTINCT '||REC.COLUMN_NAME||') FROM CUSTOMER_INSURANCE_LTV_SQL_V' INTO CNT;","        IF CNT > 1 AND CNT < RATIO*TOTAL THEN","            DBMS_OUTPUT.PUT_LINE(REC.COLUMN_NAME);    ","            IF SELECTED_COLS IS NULL THEN ","                SELECTED_COLS := REC.COLUMN_NAME;","            ELSE","                SELECTED_COLS := SELECTED_COLS||','||REC.COLUMN_NAME;","            END IF;","            ","        END IF;","        ","    END LOOP;","    EXECUTE IMMEDIATE 'CREATE OR REPLACE VIEW SELECTED_NO_IDENTIFIED_V AS SELECT '||SELECTED_COLS||' FROM CUSTOMER_INSURANCE_LTV_SQL_V';","END;"],"enabled":true,"result":{"startTime":1715708970403,"interpreter":"script.low","endTime":1715708970780,"results":[{"message":"\n---------------------------\nMARITAL_STATUS\nSTATE\nCUSTOMER_ID\nGENDER\nPROFESSION\nREGION\nBUY_INSURANCE\nLTV_BIN\nFIRST_NAME\nLAST_NAME\n\n\nPL/SQL procedure successfully completed.\n\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Check the view with selected columns only","message":["%sql","","SELECT * FROM SELECTED_NO_IDENTIFIED_V","FETCH FIRST 10 ROWS ONLY"],"enabled":true,"result":{"startTime":1715708970857,"interpreter":"sql.low","endTime":1715708970940,"results":[{"message":"MARITAL_STATUS\tSTATE\tCUSTOMER_ID\tGENDER\tPROFESSION\tREGION\tBUY_INSURANCE\tLTV_BIN\tFIRST_NAME\tLAST_NAME\nSINGLE\tCA                        \tCU8720                    \tM                         \tWaiter/Waitress\tWest\tYes\tMEDIUM\tKENNETH\tNADEAU\nDIVORCED\tWA                        \tCU8721                    \tM                         \tSoftware Engineer\tWest\tYes\tMEDIUM\tJARVIS\tCLARKE\nDIVORCED\tNY                        \tCU8722                    \tF                         \tIT Staff\tNorthEast\tNo\tVERY HIGH\tSTACEY\tHENSON\nMARRIED\tMI                        \tCU8665                    \tF                         \tDentist\tMidwest\tYes\tHIGH\tMARGRET\tRYAN\nMARRIED\tMI                        \tCU8666                    \tM                         \tIT Staff\tMidwest\tNo\tHIGH\tJOAN\tBAUER\nDIVORCED\tNC                        \tCU9108                    \tF                         \tPROF-15\tSouth\tYes\tMEDIUM\tMARGART\tCALDWELL\nMARRIED\tTX                        \tCU9113                    \tM                         \tProgrammer/Developer\tSouthwest\tYes\tMEDIUM\tNICKY\tBARON\nSINGLE\tNV                        \tCU9114                    \tM                         \tSales Representative\tSouthwest\tNo\tLOW\tHUNG\tFINNEY\nSINGLE\tMI                        \tCU8462                    \tM                         \tPROF-31\tMidwest\tNo\tMEDIUM\tFREDDIE\tMAYBERRY\nDIVORCED\tMI                        \tCU8506                    \tM                         \tPlumber\tMidwest\tNo\tVERY HIGH\tJON\tDUTTON\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"For all columns, identify columns with > 40% missing values","message":["%script","","SET SERVEROUTPUT ON;","DECLARE","    CNT INT;","    TOTAL INT;","    RATIO NUMBER;","BEGIN ","    RATIO := 0.4;","    SELECT COUNT(1) ","    INTO TOTAL","    FROM CUSTOMER_INSURANCE_LTV_SQL;","","    FOR REC IN (SELECT COLUMN_NAME, DATA_TYPE ","                FROM USER_TAB_COLS ","                WHERE TABLE_NAME = 'CUSTOMER_INSURANCE_LTV_SQL' )","    LOOP","        ","        SELECT NUM_NULLS","        INTO CNT","        FROM USER_TAB_COL_STATISTICS","        WHERE TABLE_NAME = 'CUSTOMER_INSURANCE_LTV_SQL'","        AND COLUMN_NAME = REC.COLUMN_NAME;","        IF CNT > RATIO*TOTAL THEN","            DBMS_OUTPUT.PUT_LINE(REC.COLUMN_NAME);    ","        END IF;","        ","    END LOOP;","END;"],"enabled":true,"result":{"startTime":1715708971016,"interpreter":"script.low","endTime":1715708971664,"results":[{"message":"\n---------------------------\nMARITAL_STATUS\nCREDIT_BALANCE\nBANK_FUNDS\nINCOME\n\n\nPL/SQL procedure successfully completed.\n\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Use a view - without table statistics - for all columns, identify columns with > 40% missing values","message":["%script","","SET SERVEROUTPUT ON;","DECLARE","    CNT INT;","    TOTAL INT;","    RATIO NUMBER;","BEGIN ","    RATIO := 0.4;","    SELECT COUNT(1) ","    INTO TOTAL","    FROM CUSTOMER_INSURANCE_LTV_SQL_V;","","    FOR REC IN (SELECT COLUMN_NAME, DATA_TYPE ","                FROM USER_TAB_COLS ","                WHERE TABLE_NAME = 'CUSTOMER_INSURANCE_LTV_SQL_V' )","    LOOP","        ","        EXECUTE IMMEDIATE 'SELECT COUNT(1) FROM CUSTOMER_INSURANCE_LTV_SQL_V WHERE '|| REC.COLUMN_NAME||' IS NULL' INTO CNT;","","        IF CNT > RATIO*TOTAL THEN","            DBMS_OUTPUT.PUT_LINE(REC.COLUMN_NAME);    ","        END IF;","        ","    END LOOP;","END;"],"enabled":true,"result":{"startTime":1715708971752,"interpreter":"script.low","endTime":1715708972194,"results":[{"message":"\n---------------------------\nMARITAL_STATUS\nCREDIT_BALANCE\nBANK_FUNDS\nINCOME\n\n\nPL/SQL procedure successfully completed.\n\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Filter 'constant' columns - filter columns where > 90% of the values are same","message":["%script","","SET SERVEROUTPUT ON;","DECLARE","    CNT INT;","    TOTAL INT;","    RATIO NUMBER;","    TBL VARCHAR2(100);","    FMT VARCHAR2(2000);","    STMT VARCHAR2(2000);","    SELECTED_COLS VARCHAR2(1000);","BEGIN","    RATIO := 0.90;","    TBL := 'CUSTOMER_INSURANCE_LTV_SQL';","    SELECT COUNT(1) ","    INTO TOTAL","    FROM CUSTOMER_INSURANCE_LTV_SQL;","","    FMT := 'SELECT MAX(CNT) FROM ( SELECT <COL>, COUNT(1) CNT FROM <TBL> GROUP BY <COL> ) A';","","    FOR REC IN (SELECT COLUMN_NAME, DATA_TYPE ","                FROM USER_TAB_COLS ","                WHERE TABLE_NAME = TBL )","    LOOP","        STMT := REPLACE(FMT, '<COL>', REC.COLUMN_NAME);","        STMT := REPLACE(STMT, '<TBL>', TBL);","        EXECUTE IMMEDIATE STMT INTO CNT;","        IF CNT > TOTAL*RATIO THEN","            DBMS_OUTPUT.PUT_LINE(REC.COLUMN_NAME);    ","        ELSE","            IF SELECTED_COLS IS NULL THEN ","                SELECTED_COLS := REC.COLUMN_NAME;","            ELSE","                SELECTED_COLS := SELECTED_COLS||','||REC.COLUMN_NAME;","            END IF;","        END IF;","        ","    END LOOP;","    EXECUTE IMMEDIATE 'CREATE OR REPLACE VIEW SELECTED_NO_CONSTANT_V AS SELECT '||SELECTED_COLS||' FROM CUSTOMER_INSURANCE_LTV_SQL';","END;"],"enabled":true,"result":{"startTime":1715708972270,"interpreter":"script.low","endTime":1715708972772,"results":[{"message":"\n---------------------------\nCAR_OWNERSHIP\n\n\nPL/SQL procedure successfully completed.\n\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Check the view with 'constant' columns removed","message":["%sql","","SELECT * FROM SELECTED_NO_CONSTANT_V","FETCH FIRST 10 ROWS ONLY"],"enabled":true,"result":{"startTime":1715708972853,"interpreter":"sql.low","endTime":1715708972950,"results":[{"message":"MARITAL_STATUS\tSTATE\tCREDIT_BALANCE\tCUSTOMER_TENURE\tMORTGAGE_AMOUNT\tBANK_FUNDS\tNUM_DEPENDENTS\tHAS_CHILDREN\tINCOME\tCUSTOMER_ID\tGENDER\tPROFESSION\tCREDIT_CARD_LIMITS\tREGION\tHOME_OWNERSHIP\tNUM_ONLINE_TRANS\tBUY_INSURANCE\tMONTHLY_CHECKS\tNUM_TRANS_KIOSK\tAGE\tMONEY_MONTLY_OVERDRAWN\tLTV\tTOTAL_AUTOM_PAYMENTS\tNUM_TRANS_TELLER\tCHECKING_BALANCE\tNUM_TRANS_ATM\tLTV_BIN\tFIRST_NAME\tNUM_MORTGAGES\tLAST_NAME\nSINGLE\tCA                        \t0\t3\t400\t590\t3\t1\t61384\tCU8720                    \tM                         \tWaiter/Waitress\t1000\tWest\t1\t400\tYes\t2\t1\t23\t53.98\t18146\t208\t2\t25\t5\tMEDIUM\tKENNETH\t1\tNADEAU\nDIVORCED\tWA                        \t0\t3\t2050\t650\t3\t1\t63525\tCU8721                    \tM                         \tSoftware Engineer\t1000\tWest\t1\t2050\tYes\t13\t3\t22\t54.35\t18581.25\t242\t2\t25\t5\tMEDIUM\tJARVIS\t1\tCLARKE\nDIVORCED\tNY                        \t0\t4\t2500\t700\t1\t0\t71504\tCU8722                    \tF                         \tIT Staff\t1000\tNorthEast\t1\t2500\tNo\t1\t1\t42\t53.79\t32076\t393\t3\t118\t4\tVERY HIGH\tSTACEY\t1\tHENSON\nMARRIED\tMI                        \t0\t1\t8320\t11050\t1\t1\t72308\tCU8665                    \tF                         \tDentist\t4000\tMidwest\t1\t1700\tYes\t14\t1\t33\t53.97\t24877\t650\t4\t25\t5\tHIGH\tMARGRET\t1\tRYAN\nMARRIED\tMI                        \t0\t1\t1000\t0\t1\t1\t64710\tCU8666                    \tM                         \tIT Staff\t700\tMidwest\t1\t1000\tNo\t4\t1\t38\t53.17\t23477.5\t383\t0\t374\t2\tHIGH\tJOAN\t1\tBAUER\nDIVORCED\tNC                        \t0\t4\t4000\t8800\t6\t1\t61332\tCU9108                    \tF                         \tPROF-15\t800\tSouth\t1\t1600\tYes\t1\t1\t66\t54.97\t16933\t1923\t4\t25\t5\tMEDIUM\tMARGART\t1\tCALDWELL\nMARRIED\tTX                        \t0\t3\t845\t450\t3\t1\t62061\tCU9113                    \tM                         \tProgrammer/Developer\t1500\tSouthwest\t1\t845\tYes\t8\t6\t26\t53.01\t18615.25\t226\t2\t25\t2\tMEDIUM\tNICKY\t1\tBARON\nSINGLE\tNV                        \t0\t2\t0\t0\t0\t0\t74394\tCU9114                    \tM                         \tSales Representative\t1500\tSouthwest\t0\t0\tNo\t0\t1\t0\t53.06\t0\t0\t0\t25\t0\tLOW\tHUNG\t0\tFINNEY\nSINGLE\tMI                        \t0\t3\t0\t0\t3\t0\t64255\tCU8462                    \tM                         \tPROF-31\t1500\tMidwest\t0\t0\tNo\t1\t1\t28\t53.14\t14363.75\t0\t0\t25\t2\tMEDIUM\tFREDDIE\t0\tMAYBERRY\nDIVORCED\tMI                        \t0\t1\t2513\t1150\t1\t0\t70749\tCU8506                    \tM                         \tPlumber\t1000\tMidwest\t1\t2513\tNo\t11\t1\t48\t54.13\t30987.25\t6248\t3\t466\t5\tVERY HIGH\tJON\t1\tDUTTON\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Check column LAST_NAME which is suggested to be removed, most rows have the same last name 'THANOS'","message":["%sql","","SELECT LAST_NAME, COUNT(1)","FROM CUSTOMER_INSURANCE_LTV_SQL","GROUP BY LAST_NAME","ORDER BY COUNT(1) DESC","FETCH FIRST 10 ROWS ONLY"],"enabled":true,"result":{"startTime":1715708973035,"interpreter":"sql.low","endTime":1715708973111,"results":[{"message":"LAST_NAME\tCOUNT(1)\nTHANOS\t12829\nRUSSO\t6\nHARE\t6\nDENNIS\t5\nDELATORRE\t5\nECHOLS\t5\nBERNIER\t5\nCALDWELL\t5\nDILLON\t5\nBRADSHAW\t4\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Check column CAR_OWNERSHIP which is suggested to be removed, most rows have CAR_OWNERSHIP = 1","message":["%sql","","SELECT CAR_OWNERSHIP, COUNT(1)","FROM CUSTOMER_INSURANCE_LTV_SQL","GROUP BY CAR_OWNERSHIP","ORDER BY COUNT(1) DESC"],"enabled":true,"result":{"startTime":1715708973188,"interpreter":"sql.low","endTime":1715708973265,"results":[{"message":"CAR_OWNERSHIP\tCOUNT(1)\n1\t13859\n0\t1021\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","## End of Script"],"enabled":true,"result":{"startTime":1715708973340,"interpreter":"md.low","endTime":1715708973402,"results":[{"message":"<h2 id=\"end-of-script\">End of Script<\/h2>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md"],"enabled":true,"result":{"startTime":1715708973491,"interpreter":"md.low","endTime":1715708973553,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"}],"version":"6","snapshot":false,"tags":null}]