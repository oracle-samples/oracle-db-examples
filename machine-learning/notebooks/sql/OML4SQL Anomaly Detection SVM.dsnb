[{"layout":null,"template":null,"templateConfig":null,"name":"OML4SQL Anomaly Detection SVM","description":null,"readOnly":false,"type":"medium","paragraphs":[{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":null,"message":[],"enabled":true,"result":{"startTime":1715729079061,"interpreter":"md.medium","endTime":1715729079122,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":0,"hideResult":true,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","# Anomaly Detection to Detect Unusual or Rare Occurrences","","Oracle Machine Learning supports anomaly detection to identify rare or unusual records (customers, transactions, etc.) in the data using the semi-supervised learning algorithm One-Class Support Vector Machine. In this notebook, you will build a 1Class-SVM model and then use it to flag unusual or suspicious records. The data used in this example is from the SH schema. The entire machine learning methodology runs inside Oracle Autonomous Database (ADB).","","Copyright (c) 2024 Oracle Corporation ","###### <a href=\"https://oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0<\/a>","---"],"enabled":true,"result":{"startTime":1715729079194,"interpreter":"md.medium","endTime":1715729079258,"results":[{"message":"<h1 id=\"anomaly-detection-to-detect-unusual-or-rare-occurrences\">Anomaly Detection to Detect Unusual or Rare Occurrences<\/h1>\n<p>Oracle Machine Learning supports anomaly detection to identify rare or unusual records (customers, transactions, etc.) in the data using the semi-supervised learning algorithm One-Class Support Vector Machine. In this notebook, you will build a 1Class-SVM model and then use it to flag unusual or suspicious records. The data used in this example is from the SH schema. The entire machine learning methodology runs inside Oracle Autonomous Database (ADB).<\/p>\n<p>Copyright (c) 2024 Oracle Corporation<\/p>\n<h6 id=\"the-universal-permissive-license-upl-version-10\"><a href=\"https://oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0<\/a><\/h6>\n<hr />\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":9,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md ","<dl>","<img src=\"http://www.oracle.com/technetwork/database/options/advanced-analytics/anomalydetection-5663169.jpg\" alt=\"OML Notebooks\" width=\"250\"/>","<\/dl>"],"enabled":true,"result":{"startTime":1715729079360,"interpreter":"md.medium","endTime":1715729079429,"results":[{"message":"<dl>\n<img src=\"http://www.oracle.com/technetwork/database/options/advanced-analytics/anomalydetection-5663169.jpg\" alt=\"OML Notebooks\" width=\"250\"/>\n<\/dl>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":3,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"For more information...","message":["%md ","","* <a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a>","* <a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a>","* <a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a>","* <a href=\"https://www.oracle.com/goto/ml-anomaly-detection\" target=\"_blank\">OML Anomaly Detection<\/a>"],"enabled":true,"result":{"startTime":1715729079505,"interpreter":"md.medium","endTime":1715729079570,"results":[{"message":"<ul>\n<li><a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a><\/li>\n<li><a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a><\/li>\n<li><a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a><\/li>\n<li><a href=\"https://www.oracle.com/goto/ml-anomaly-detection\" target=\"_blank\">OML Anomaly Detection<\/a><\/li>\n<\/ul>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Create view DEMOGRAPHICS_V with columns of interest","message":["%sql","","CREATE OR REPLACE VIEW DEMOGRAPHICS_V AS","  SELECT CUST_ID, YRS_RESIDENCE, EDUCATION, AFFINITY_CARD, ","         HOUSEHOLD_SIZE, OCCUPATION, BOOKKEEPING_APPLICATION, ","         BULK_PACK_DISKETTES, FLAT_PANEL_MONITOR, HOME_THEATER_PACKAGE,","         OS_DOC_SET_KANJI, PRINTER_SUPPLIES, Y_BOX_GAMES","  FROM SH.SUPPLEMENTARY_DEMOGRAPHICS;"],"enabled":true,"result":{"startTime":1715729079645,"interpreter":"sql.medium","endTime":1715729079741,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":7,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Display DEMOGRAPHICS_V data","message":["%sql","","SELECT * ","FROM DEMOGRAPHICS_V","FETCH FIRST 10 ROWS ONLY;"],"enabled":true,"result":{"startTime":1715729079933,"interpreter":"sql.medium","endTime":1715729080057,"results":[{"message":"CUST_ID\tYRS_RESIDENCE\tEDUCATION\tAFFINITY_CARD\tHOUSEHOLD_SIZE\tOCCUPATION\tBOOKKEEPING_APPLICATION\tBULK_PACK_DISKETTES\tFLAT_PANEL_MONITOR\tHOME_THEATER_PACKAGE\tOS_DOC_SET_KANJI\tPRINTER_SUPPLIES\tY_BOX_GAMES\n102547\t0\t10th\t0\t1\tOther\t0\t1\t1\t0\t0\t1\t1\n101050\t0\t10th\t0\t1\tOther\t0\t1\t1\t0\t0\t1\t1\n100040\t0\t11th\t0\t1\tSales\t0\t1\t1\t0\t0\t1\t1\n102117\t0\tHS-grad\t0\t1\tFarming\t1\t0\t0\t0\t0\t1\t1\n101074\t1\t10th\t0\t1\tHandler\t0\t1\t1\t0\t0\t1\t1\n104179\t1\t10th\t0\t1\tHandler\t0\t1\t1\t0\t0\t1\t1\n100417\t1\t11th\t0\t1\tHandler\t0\t0\t0\t0\t0\t1\t1\n101146\t1\t< Bach.\t0\t1\t?\t1\t1\t1\t0\t0\t1\t1\n103420\t1\t< Bach.\t0\t1\t?\t1\t1\t1\t0\t0\t1\t1\n101987\t1\t< Bach.\t0\t1\tOther\t1\t1\t1\t0\t0\t1\t1\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Display CUSTOMERS table","message":["%sql","","SELECT * ","FROM SH.CUSTOMERS ","FETCH FIRST 10 ROWS ONLY;"],"enabled":true,"result":{"startTime":1715729080136,"interpreter":"sql.medium","endTime":1715729080234,"results":[{"message":"CUST_ID\tCUST_FIRST_NAME\tCUST_LAST_NAME\tCUST_GENDER\tCUST_YEAR_OF_BIRTH\tCUST_MARITAL_STATUS\tCUST_STREET_ADDRESS\tCUST_POSTAL_CODE\tCUST_CITY\tCUST_CITY_ID\tCUST_STATE_PROVINCE\tCUST_STATE_PROVINCE_ID\tCOUNTRY_ID\tCUST_MAIN_PHONE_NUMBER\tCUST_INCOME_LEVEL\tCUST_CREDIT_LIMIT\tCUST_EMAIL\tCUST_TOTAL\tCUST_TOTAL_ID\tCUST_SRC_ID\tCUST_EFF_FROM\tCUST_EFF_TO\tCUST_VALID\n48809\tAzalea\tJanney\tM\t1973\t\t27 West Vega Alta Boulevard\t69776\tHiseville\t51663\tKY\t52632\t52790\t504-306-7004\tE: 90,000 - 109,999\t9000\tJanney@company.example.com\tCustomer total\t52772\t\t1998-01-01 00:00:00\t\tI\n2365\tAzalea\tJanney\tM\t1971\tmarried\t37 East La Salle Street\t86990\tVictoria\t52440\tKS\t52630\t52790\t350-499-4703\tE: 90,000 - 109,999\t1500\tJanney@company.example.com\tCustomer total\t52772\t\t1998-01-01 00:00:00\t\tA\n5920\tAzalea\tJanney\tM\t1937\t\t47 Anderson Road\t73216\tFrederick\t51519\tCO\t52569\t52790\t324-239-9046\tE: 90,000 - 109,999\t7000\tJanney@company.example.com\tCustomer total\t52772\t\t1998-01-01 00:00:00\t\tA\n9475\tAzalea\tJanney\tM\t1945\t\t47 North Mingo Road\t55787\tMontara\t51919\tCA\t52567\t52790\t196-478-4515\tE: 90,000 - 109,999\t9000\tJanney@company.example.com\tCustomer total\t52772\t\t1998-01-01 00:00:00\t\tA\n13031\tAzalea\tJanney\tM\t1963\tmarried\t57 West Cabo Rojo Drive\t54845\tHaswell\t51651\tCO\t52569\t52790\t695-329-2727\tE: 90,000 - 109,999\t1500\tJanney@company.example.com\tCustomer total\t52772\t\t1998-01-01 00:00:00\t\tI\n16587\tAzalea\tJanney\tM\t1948\t\t67 Pike Avenue\t57128\tBarry\t51166\tWales - South Glamorgan\t52764\t52789\t645-103-8904\tE: 90,000 - 109,999\t7000\tJanney@company.example.com\tCustomer total\t52772\t\t1998-01-01 00:00:00\t\tI\n20142\tAzalea\tJanney\tM\t1969\t\t67 South De Soto Avenue\t64852\tHelmond\t51657\tNoord-Brabant\t52682\t52770\t609-353-7437\tE: 90,000 - 109,999\t9000\tJanney@company.example.com\tCustomer total\t52772\t\t1998-01-01 00:00:00\t\tI\n23698\tAzalea\tJanney\tM\t1951\tmarried\t77 West Sanilac Avenue\t82590\tWarstein\t52497\tNordrhein-Westfalen\t52684\t52776\t574-306-7921\tE: 90,000 - 109,999\t1500\tJanney@company.example.com\tCustomer total\t52772\t\t1998-01-01 00:00:00\t\tI\n27253\tAzalea\tJanney\tM\t1972\t\t87 East Guaynabo Avenue\t75917\tMolino\t51917\tFL\t52595\t52790\t338-499-9243\tE: 90,000 - 109,999\t7000\tJanney@company.example.com\tCustomer total\t52772\t\t1998-01-01 00:00:00\t\tI\n30808\tAzalea\tJanney\tM\t1965\t\t87 South Vega Alta Avenue\t61035\tFerrals-les-Montagnes\t51502\tLanguedoc-Roussillon\t52645\t52779\t687-239-2426\tE: 90,000 - 109,999\t9000\tJanney@company.example.com\tCustomer total\t52772\t\t1998-01-01 00:00:00\t\tI\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Create view joining CUSTOMERS and DEMOGRAPHICS_V ","message":["%script","","CREATE OR REPLACE VIEW CUSTOMERS360_V AS","   SELECT a.CUST_ID, a.CUST_GENDER, a.CUST_MARITAL_STATUS, ","          a.CUST_YEAR_OF_BIRTH, a.CUST_INCOME_LEVEL, ","          a.CUST_CREDIT_LIMIT, b.EDUCATION, b.AFFINITY_CARD, ","          b.HOUSEHOLD_SIZE, b.OCCUPATION, b.YRS_RESIDENCE, ","          b.Y_BOX_GAMES","   FROM SH.CUSTOMERS a, DEMOGRAPHICS_V b","   WHERE a.CUST_ID = b.CUST_ID;"],"enabled":true,"result":{"startTime":1715729080350,"interpreter":"script.medium","endTime":1715729080426,"results":[{"message":"\nView CUSTOMERS360_V created.\n\n\n---------------------------\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":5,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Display CUSTOMERS360_V","message":["%sql","","SELECT * ","FROM CUSTOMERS360_V","FETCH FIRST 10 ROWS ONLY;"],"enabled":true,"result":{"startTime":1715729080499,"interpreter":"sql.medium","endTime":1715729087201,"results":[{"message":"CUST_ID\tCUST_GENDER\tCUST_MARITAL_STATUS\tCUST_YEAR_OF_BIRTH\tCUST_INCOME_LEVEL\tCUST_CREDIT_LIMIT\tEDUCATION\tAFFINITY_CARD\tHOUSEHOLD_SIZE\tOCCUPATION\tYRS_RESIDENCE\tY_BOX_GAMES\n100134\tF\tDivorc.\t1965\tL: 300,000 and above\t9000\tAssoc-A\t0\t2\tCleric.\t2\t0\n102828\tF\tNeverM\t1967\tE: 90,000 - 109,999\t10000\tHS-grad\t0\t1\tMachine\t4\t0\n101232\tM\tNeverM\t1979\tJ: 190,000 - 249,999\t9000\t< Bach.\t0\t1\tOther\t2\t1\n100696\tM\tMarried\t1971\tF: 110,000 - 129,999\t7000\tProfsc\t1\t3\tProf.\t3\t0\n103948\tM\tNeverM\t1966\tJ: 190,000 - 249,999\t9000\t< Bach.\t0\t1\tCleric.\t4\t0\n103791\tM\tDivorc.\t1952\tB: 30,000 - 49,999\t3000\tHS-grad\t0\t2\tProf.\t5\t0\n100804\tF\tDivorc.\t1943\tA: Below 30,000\t1500\t< Bach.\t0\t2\tProf.\t6\t0\n101610\tM\tNeverM\t1985\tI: 170,000 - 189,999\t3000\t11th\t0\t1\tHandler\t0\t1\n102308\tM\tNeverM\t1980\tJ: 190,000 - 249,999\t11000\t< Bach.\t0\t2\tProf.\t2\t1\n100593\tM\tMarried\t1963\tG: 130,000 - 149,999\t1500\tHS-grad\t1\t3\tProf.\t4\t0\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":7,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":"[{\"table\":{\"version\":1},\"bar\":{\"showSeries\":[\"COUNT\"],\"aggregationOption\":\"Last\",\"series\":{\"selectedId\":\"CUST_YEAR_OF_BIRTH\",\"availableSeriesElements\":[{\"id\":\"COUNT\",\"lineType\":\"straight\",\"borderColor\":\"rgb(25, 95, 116)\",\"borderWidth\":0,\"color\":\"rgb(25, 95, 116)\",\"pattern\":\"auto\",\"markerColor\":\"rgb(25, 95, 116)\",\"markerDisplayed\":\"auto\",\"markerShape\":\"auto\",\"markerSize\":0}]},\"axis\":{\"x\":{\"title\":\"Marital Status\"}},\"lastColumns\":[\"CUST_YEAR_OF_BIRTH\",\"COUNT\"],\"version\":1},\"scatterplot\":{},\"boxplot\":{\"showSeries\":[\"COUNT\"],\"lastColumns\":[\"CUST_YEAR_OF_BIRTH\",\"CUST_MARITAL_STATUS\",\"COUNT\"],\"version\":1},\"tree\":{},\"sunburst\":{}}]","hideInIFrame":false,"selectedVisualization":"bar","title":"Evaluate distribution of CUST_YEAR_BIRTH vs. CUST_MARITAL_STATUS from CUSTOMERS360_V","message":["%sql","","SELECT CUST_YEAR_OF_BIRTH, COUNT(*) COUNT","FROM   CUSTOMERS360_V","GROUP BY CUST_YEAR_OF_BIRTH","ORDER BY CUST_YEAR_OF_BIRTH"],"enabled":true,"result":{"startTime":1715729087281,"interpreter":"sql.medium","endTime":1715729087412,"results":[{"message":"CUST_YEAR_OF_BIRTH\tCOUNT\n1913\t5\n1921\t1\n1922\t6\n1923\t4\n1924\t6\n1925\t8\n1926\t12\n1927\t3\n1928\t14\n1929\t7\n1930\t4\n1931\t7\n1932\t13\n1933\t10\n1934\t18\n1935\t18\n1936\t22\n1937\t12\n1938\t26\n1939\t25\n1940\t30\n1941\t31\n1942\t28\n1943\t43\n1944\t52\n1945\t49\n1946\t45\n1947\t45\n1948\t52\n1949\t51\n1950\t60\n1951\t51\n1952\t83\n1953\t56\n1954\t93\n1955\t94\n1956\t96\n1957\t119\n1958\t105\n1959\t119\n1960\t100\n1961\t115\n1962\t113\n1963\t102\n1964\t105\n1965\t103\n1966\t118\n1967\t123\n1968\t137\n1969\t135\n1970\t116\n1971\t121\n1972\t91\n1973\t92\n1974\t111\n1975\t137\n1976\t119\n1977\t110\n1978\t132\n1979\t123\n1980\t127\n1981\t120\n1982\t92\n1983\t122\n1984\t96\n1985\t65\n1986\t52\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Build an anomaly detection model using the 1-Class SVM algorithm","message":["%script","","BEGIN DBMS_DATA_MINING.DROP_MODEL('CUSTOMERS360MODEL');","EXCEPTION WHEN OTHERS THEN NULL; END;","/","DECLARE","    v_setlst DBMS_DATA_MINING.SETTING_LIST;","BEGIN","    v_setlst('ALGO_NAME')   := 'ALGO_SUPPORT_VECTOR_MACHINES';","    V_setlst('PREP_AUTO')   := 'ON';","","    DBMS_DATA_MINING.CREATE_MODEL2(","        MODEL_NAME          => 'CUSTOMERS360MODEL',","        MINING_FUNCTION     => 'CLASSIFICATION',","        DATA_QUERY          => 'select * from CUSTOMERS360_V',","        SET_LIST            => v_setlst,","        CASE_ID_COLUMN_NAME => 'CUST_ID',","        TARGET_COLUMN_NAME  => NULL);","END;"],"enabled":true,"result":{"startTime":1715729087493,"interpreter":"script.medium","endTime":1715729089493,"results":[{"message":"\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n\nPL/SQL procedure successfully completed.\n\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Display customers in descending order of anomaly probability","message":["%sql","","-- Hint: In anomaly detection, known amomalies should be removed from the training dataset","","SELECT * ","FROM (SELECT CUST_ID, anomalous, round(prob_anomalous,2) prob_anomalous, ","             YRS_RESIDENCE, HOUSEHOLD_SIZE, CUST_GENDER,","             CUST_MARITAL_STATUS, ","             rank() over (ORDER BY prob_anomalous DESC) rnk ","      FROM (SELECT CUST_ID, HOUSEHOLD_SIZE, YRS_RESIDENCE, ","                   CUST_GENDER, CUST_MARITAL_STATUS, ","                   prediction(CUSTOMERS360MODEL using *) anomalous,","                   prediction_probability(CUSTOMERS360MODEL, '0' using *) prob_anomalous","            FROM CUSTOMERS360_V))","ORDER BY prob_anomalous DESC","FETCH FIRST 10 ROWS ONLY;"],"enabled":true,"result":{"startTime":1715729089570,"interpreter":"sql.medium","endTime":1715729089722,"results":[{"message":"CUST_ID\tANOMALOUS\tPROB_ANOMALOUS\tYRS_RESIDENCE\tHOUSEHOLD_SIZE\tCUST_GENDER\tCUST_MARITAL_STATUS\tRNK\n103154\t0\t0.76\t2\t2\tF\tWidowed\t1\n100199\t0\t0.76\t2\t2\tF\tWidowed\t1\n102948\t0\t0.73\t2\t9+\tF\tWidowed\t3\n101137\t0\t0.67\t3\t9+\tF\tWidowed\t4\n104359\t0\t0.66\t6\t2\tF\tWidowed\t5\n100170\t0\t0.63\t3\t9+\tF\tWidowed\t6\n100646\t0\t0.63\t2\t9+\tF\tWidowed\t8\n101434\t0\t0.63\t6\t2\tF\tWidowed\t7\n104275\t0\t0.62\t0\t2\tF\tWidowed\t9\n103702\t0\t0.61\t6\t6-8\tM\tDivorc.\t10\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":"[{\"table\":{\"version\":1},\"bar\":{\"showSeries\":[\"COUNT(*)\"],\"aggregationOption\":\"Last\",\"series\":{\"availableSeriesElements\":[{\"id\":\"COUNT(*)\",\"lineType\":\"straight\",\"borderColor\":\"rgb(25, 95, 116)\",\"borderWidth\":0,\"color\":\"rgb(25, 95, 116)\",\"pattern\":\"auto\",\"markerColor\":\"rgb(25, 95, 116)\",\"markerDisplayed\":\"auto\",\"markerShape\":\"auto\",\"markerSize\":0}]},\"lastColumns\":[\"ANOMALOUS\",\"COUNT(*)\"],\"version\":1}}]","hideInIFrame":false,"selectedVisualization":"bar","title":null,"message":["%sql","","SELECT prediction(CUSTOMERS360MODEL using *) ANOMALOUS,","       count(*)       ","FROM CUSTOMERS360_V","GROUP BY prediction(CUSTOMERS360MODEL using *)"],"enabled":true,"result":{"startTime":1715729089797,"interpreter":"sql.medium","endTime":1715729089917,"results":[{"message":"ANOMALOUS\tCOUNT(*)\n0\t45\n1\t4455\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":[],"enabled":false,"result":{"startTime":1706742914261,"interpreter":"md.medium","endTime":1706742914345,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Display the top 5 most anomalous customers","message":["%sql","","SELECT * ","FROM (SELECT CUST_ID, round(prob_anomalous,2) prob_anomalous,  ","             YRS_RESIDENCE, CUST_MARITAL_STATUS, ","             rank() over (ORDER BY prob_anomalous DESC) rnk ","      FROM (SELECT CUST_ID, HOUSEHOLD_SIZE, YRS_RESIDENCE, CUST_GENDER, CUST_MARITAL_STATUS, ","                   prediction_probability(CUSTOMERS360MODEL, '0' using *) prob_anomalous","            FROM CUSTOMERS360_V))","WHERE rnk <= 5","ORDER BY prob_anomalous DESC;"],"enabled":true,"result":{"startTime":1715729089993,"interpreter":"sql.medium","endTime":1715729090140,"results":[{"message":"CUST_ID\tPROB_ANOMALOUS\tYRS_RESIDENCE\tCUST_MARITAL_STATUS\tRNK\n100199\t0.76\t2\tWidowed\t1\n103154\t0.76\t2\tWidowed\t1\n102948\t0.73\t2\tWidowed\t3\n101137\t0.67\t3\tWidowed\t4\n104359\t0.66\t6\tWidowed\t5\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"View Prediction Details of top 3 attributes to explain prediction","message":["%sql","-- Select customers with OCCUPATION 'TechSup' and more than 50% probability of being anomalous ","","SELECT CUST_ID, ","       RTRIM(TRIM(SUBSTR(OUTPRED.\"Attribute1\",17,100)),'rank=\"1\"/>') FIRST_ATTRIBUTE,","       RTRIM(TRIM(SUBSTR(OUTPRED.\"Attribute2\",17,100)),'rank=\"2\"/>') SECOND_ATTRIBUTE,","       RTRIM(TRIM(SUBSTR(OUTPRED.\"Attribute3\",17,100)),'rank=\"3\"/>') THIRD_ATTRIBUTE","       FROM (SELECT CUST_ID, PREDICTION_DETAILS(CUSTOMERS360MODEL, '0' USING *) PREDICTION_DETAILS FROM CUSTOMERS360_V","           WHERE PREDICTION_PROBABILITY(CUSTOMERS360MODEL, '0' USING *) > 0.50","           AND OCCUPATION = 'TechSup'","           ORDER BY CUST_ID) OUT,","           XMLTABLE('/Details'","                PASSING OUT.PREDICTION_DETAILS","                COLUMNS ","                   \"Attribute1\" XMLType PATH 'Attribute[1]',","                   \"Attribute2\" XMLType PATH 'Attribute[2]',","                   \"Attribute3\" XMLType PATH 'Attribute[3]') OUTPRED","FETCH FIRST 10 ROWS ONLY;","       "],"enabled":true,"result":{"startTime":1715729090223,"interpreter":"sql.medium","endTime":1715729090372,"results":[{"message":"CUST_ID\tFIRST_ATTRIBUTE\tSECOND_ATTRIBUTE\tTHIRD_ATTRIBUTE\n100646\t\"CUST_MARITAL_STATUS\" actualValue=\"Widowed\" weight=\".226\" \t\"CUST_YEAR_OF_BIRTH\" actualValue=\"1941\" weight=\".118\" \t\"CUST_CREDIT_LIMIT\" actualValue=\"1500\" weight=\".115\" \n102922\t\"CUST_MARITAL_STATUS\" actualValue=\"Widowed\" weight=\".222\" \t\"CUST_YEAR_OF_BIRTH\" actualValue=\"1931\" weight=\".169\" \t\"CUST_CREDIT_LIMIT\" actualValue=\"1500\" weight=\".115\" \n103441\t\"CUST_MARITAL_STATUS\" actualValue=\"Widowed\" weight=\".222\" \t\"CUST_YEAR_OF_BIRTH\" actualValue=\"1941\" weight=\".117\" \t\"EDUCATION\" actualValue=\"Bach.\" weight=\".076\" \n104286\t\"EDUCATION\" actualValue=\"9th\" weight=\".165\" \t\"HOUSEHOLD_SIZE\" actualValue=\"4-5\" weight=\".146\" \t\"CUST_CREDIT_LIMIT\" actualValue=\"1500\" weight=\".112\" \n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","## End of Script"],"enabled":true,"result":{"startTime":1715729090461,"interpreter":"md.medium","endTime":1715729090521,"results":[{"message":"<h2 id=\"end-of-script\">End of Script<\/h2>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":[],"enabled":true,"result":{"startTime":1715729090599,"interpreter":"md.medium","endTime":1715729090658,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"}],"version":"6","snapshot":false,"tags":null}]