[{"layout":null,"template":null,"templateConfig":null,"name":"OML4SQL Data Cleaning Outlier Removal","description":null,"readOnly":false,"type":"low","paragraphs":[{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":null,"message":["%md"," "],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","# OML4SQL Data Cleaning: Outlier Removal","","In this notebook, we demonstrate how to remove outliers using Oracle SQL and the DBMS_DATA_MINING_TRANSFORM package.","","We use the customer insurance lifetime value data set, which contains customer financial information, lifetime value, and whether or not the customer bought insurance.","","In the dataset CUSTOMER_INSURANCE_LTV_SQL, we focus on numeric values and remove records with values in the top and bottom 5%. ","","The dataset `CUSTOMER_INSURANCE_LTV_SQL` is generated by the `\"OML Run-me-first\"` notebook, which `MUST` be run before this notebook.","","###### IMPORTANT: The `\"OML Run-me-first\"` notebook is available under the menu `Templates -> Examples` and is a pre-requisite to the current notebook.","","Copyright (c) 2024 Oracle Corporation ","###### <a href=\"https://oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0<\/a>"],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"For more information ...","message":["%md","","* <a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a>","* <a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a>","* <a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a>","* <a href=\"https://docs.oracle.com/en/database/oracle/oracle-database/23/arpls/DBMS_DATA_MINING_TRANSFORM.html\" target=\"_blank\">OML4SQL DBMS_DATA_MINNG_TRANSFORM Documentation<\/a>"],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Display CUSTOMER_INSURANCE_LTV_SQL data","message":["%sql","","SELECT * ","FROM   CUSTOMER_INSURANCE_LTV_SQL ","FETCH FIRST 10 ROWS ONLY;"],"enabled":true,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Create a view that contains the columns with outliers","message":["%sql","","CREATE OR REPLACE VIEW CUSTOMER_CLIP_V AS","SELECT CUSTOMER_ID, INCOME","FROM   CUSTOMER_INSURANCE_LTV_SQL;"],"enabled":true,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Check the min and max values for column INCOME","message":["%sql","","SELECT MIN(INCOME), MAX(INCOME)","FROM   CUSTOMER_INSURANCE_LTV_SQL;"],"enabled":true,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Generate table with clip information with tail fraction of 0.05","message":["%script","","BEGIN","    EXECUTE IMMEDIATE 'DROP TABLE  clip_tbl';","    EXCEPTION WHEN OTHERS THEN NULL;","END;","/","","BEGIN","   dbms_data_mining_transform.CREATE_CLIP(","      clip_table_name    => 'clip_tbl');","   dbms_data_mining_transform.INSERT_CLIP_TRIM_TAIL(","      clip_table_name    => 'clip_tbl',","      data_table_name    => 'CUSTOMER_CLIP_V',","      tail_frac          => 0.05,","      exclude_list       => DBMS_DATA_MINING_TRANSFORM.COLUMN_LIST('CUSTOMER_ID'));","END;","/"," "],"enabled":true,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"View clip boundaries","message":["%sql","","SELECT col, lcut, rcut","FROM   clip_tbl","ORDER BY col ASC;"],"enabled":true,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Create view with column INCOME clipped","message":["%script","","BEGIN","    EXECUTE IMMEDIATE 'DROP VIEW  CUSTOMER_INSURANCE_LTV_SQL_STACK';","    EXCEPTION WHEN OTHERS THEN NULL;","END;","/","DECLARE","     xforms      dbms_data_mining_transform.TRANSFORM_LIST;","BEGIN","     dbms_data_mining_transform.STACK_CLIP (","          clip_table_name    => 'clip_tbl',","          xform_list         => xforms);","     dbms_data_mining_transform.XFORM_STACK (","          xform_list         => xforms,","          data_table_name    => 'CUSTOMER_INSURANCE_LTV_SQL',","          xform_view_name    => 'CUSTOMER_INSURANCE_LTV_SQL_STACK');"," END;"," /"," "],"enabled":true,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Check new min and max of INCOME","message":["%sql"," ","SELECT 'PREVIOUS' STATE, MIN(INCOME), MAX(INCOME)","FROM   CUSTOMER_INSURANCE_LTV_SQL_STACK","UNION","SELECT 'AFTER' STATE, MIN(INCOME), MAX(INCOME)","FROM   CUSTOMER_INSURANCE_LTV_SQL;"],"enabled":true,"result":null,"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","## End of Script"],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md"],"enabled":true,"result":null,"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"}],"version":"6","snapshot":false,"tags":null}]