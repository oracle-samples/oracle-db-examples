{
  "paragraphs": [
    {
      "text": "%md\n\n## OML4SQL Feature Selection: Unsupervised Attribute Importance\nIn this notebook, we demonstrate how to perform feature selection using the in-database unsupervised algorithm Expectation Maximization (EM).\n\nWe use the customer insurance lifetime value data set which contains customer financial information, lifetime value, and whether or not the customer bought insurance.\n\nThis example illustrates using the CREATE_MODEL function, which leverages the settings table (in contrast to the CREATE_MODEL2 function used in other notebooks).\n\nThe dataset `CUSTOMER_INSURANCE_LTV_SQL` is generated by the `\"OML Run-me-first\"` notebook, which `MUST` be run before this notebook.\n\n---\n\n##### `IMPORTANT`: The `\"OML Run-me-first\"` notebook is available under the menu Templates -\u003e Examples and is a pre-requisite to the current notebook.\n\n---\n\nCopyright (c) 2022 Oracle Corporation \n###### \u003ca href\u003d\"https://oss.oracle.com/licenses/upl/\" onclick\u003d\"return ! window.open(\u0027https://oss.oracle.com/licenses/upl/\u0027);\"\u003eThe Universal Permissive License (UPL), Version 1.0\u003c/a\u003e\n---",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T18:19:03+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "md",
          "editOnDblClick": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003ch2\u003eOML4SQL Feature Selection: Unsupervised Attribute Importance\u003c/h2\u003e\n\u003cp\u003eIn this notebook, we demonstrate how to perform feature selection using the in-database unsupervised algorithm Expectation Maximization (EM).\u003c/p\u003e\n\u003cp\u003eWe use the customer insurance lifetime value data set which contains customer financial information, lifetime value, and whether or not the customer bought insurance.\u003c/p\u003e\n\u003cp\u003eThis example illustrates using the CREATE_MODEL function, which leverages the settings table (in contrast to the CREATE_MODEL2 function used in other notebooks).\u003c/p\u003e\n\u003cp\u003eThe dataset \u003ccode\u003eCUSTOMER_INSURANCE_LTV_SQL\u003c/code\u003e is generated by the \u003ccode\u003e\"OML Run-me-first\"\u003c/code\u003e notebook, which \u003ccode\u003eMUST\u003c/code\u003e be run before this notebook.\u003c/p\u003e\n\u003chr /\u003e\n\u003ch5\u003e\u003ccode\u003eIMPORTANT\u003c/code\u003e: The \u003ccode\u003e\"OML Run-me-first\"\u003c/code\u003e notebook is available under the menu Templates -\u003e Examples and is a pre-requisite to the current notebook.\u003c/h5\u003e\n\u003chr /\u003e\n\u003cp\u003eCopyright (c) 2022 Oracle Corporation\u003c/p\u003e\n\u003ch6\u003e\u003ca href\u003d\"https: //oss.oracle.com/licenses/upl/\" onclick\u003d\"return ! window.open(\u0027https://oss.oracle.com/licenses/upl/\u0027);\"\u003eThe Universal Permissive License (UPL), Version 1.0\u003c/a\u003e\u003c/h6\u003e\n\u003chr /\u003e\n"
          }
        ]
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055264210_252906028",
      "id": "20220124-201424_848250170",
      "dateCreated": "2020-12-16T19:45:18+0000",
      "dateStarted": "2022-03-10T18:19:04+0000",
      "dateFinished": "2022-03-10T18:19:05+0000",
      "status": "FINISHED"
    },
    {
      "title": "For more information ...",
      "text": "%md\n\nOML4SQL Expectation Maximization documentation: \u003ca href\u003d\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmcon/expectation-maximization.html\" onclick\u003d\"return ! window.open(\u0027https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmcon/expectation-maximization.html\u0027);\"\u003e https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmcon/expectation-maximization.html \u003c/a\u003e",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T18:19:05+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "md",
          "editOnDblClick": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cp\u003eOML4SQL Expectation Maximization documentation: \u003ca href\u003d\"https: //docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmcon/expectation-maximization.html\" onclick\u003d\"return ! window.open(\u0027https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmcon/expectation-maximization.html\u0027);\"\u003e https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmcon/expectation-maximization.html \u003c/a\u003e\u003c/p\u003e\n"
          }
        ]
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055264210_-1974579461",
      "id": "20220124-201424_371382814",
      "dateCreated": "2020-12-17T03:57:02+0000",
      "dateStarted": "2022-03-10T18:19:06+0000",
      "dateFinished": "2022-03-10T18:19:06+0000",
      "status": "FINISHED"
    },
    {
      "title": "Create setting table",
      "text": "%script\n\nBEGIN EXECUTE IMMEDIATE \u0027DROP TABLE EM_LTV_SAMPLE_SETTINGS\u0027;\nEXCEPTION WHEN OTHERS THEN NULL; END;\n/\n\nCREATE TABLE EM_LTV_SAMPLE_SETTINGS (\n   SETTING_NAME  VARCHAR2(30),\n   SETTING_VALUE VARCHAR2(4000));",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T18:19:06+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "plsql",
          "editOnDblClick": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/plsql",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n\nTable EM_LTV_SAMPLE_SETTINGS created.\n\n\n---------------------------\n"
          }
        ]
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055264210_-208519026",
      "id": "20220124-201424_1785716583",
      "dateCreated": "2020-12-23T18:32:37+0000",
      "dateStarted": "2022-03-10T18:19:07+0000",
      "dateFinished": "2022-03-10T18:19:17+0000",
      "status": "FINISHED"
    },
    {
      "title": "Add settings, set the number of maximum clusters to be 1",
      "text": "%script\n\nBEGIN       \n   INSERT INTO EM_LTV_SAMPLE_SETTINGS (SETTING_NAME, SETTING_VALUE) VALUES (DBMS_DATA_MINING.ALGO_NAME, DBMS_DATA_MINING.ALGO_EXPECTATION_MAXIMIZATION);\n   INSERT INTO EM_LTV_SAMPLE_SETTINGS (SETTING_NAME, SETTING_VALUE) VALUES (DBMS_DATA_MINING.PREP_AUTO, DBMS_DATA_MINING.PREP_AUTO_ON);\n   INSERT INTO EM_LTV_SAMPLE_SETTINGS (SETTING_NAME, SETTING_VALUE) VALUES (DBMS_DATA_MINING.CLUS_NUM_CLUSTERS,1);\nEND;\n/",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T18:19:17+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "plsql",
          "editOnDblClick": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/plsql",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n"
          }
        ]
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055264210_1287030431",
      "id": "20220124-201424_578937221",
      "dateCreated": "2020-12-23T18:32:25+0000",
      "dateStarted": "2022-03-10T18:19:18+0000",
      "dateFinished": "2022-03-10T18:19:19+0000",
      "status": "FINISHED"
    },
    {
      "title": "Create EM model",
      "text": "%script\n\nBEGIN DBMS_DATA_MINING.DROP_MODEL(\u0027EM_LTV_CLUS_SAMPLE\u0027);\nEXCEPTION WHEN OTHERS THEN NULL; END;\n\nBEGIN\n  DBMS_DATA_MINING.CREATE_MODEL(\n    MODEL_NAME          \u003d\u003e \u0027EM_LTV_CLUS_SAMPLE\u0027,\n    MINING_FUNCTION     \u003d\u003e DBMS_DATA_MINING.CLUSTERING,\n    DATA_TABLE_NAME     \u003d\u003e \u0027CUSTOMER_INSURANCE_LTV_SQL\u0027,\n    CASE_ID_COLUMN_NAME \u003d\u003e \u0027CUSTOMER_ID\u0027,\n    SETTINGS_TABLE_NAME \u003d\u003e \u0027EM_LTV_SAMPLE_SETTINGS\u0027);\nEND;\n/",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T18:19:19+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "plsql",
          "editOnDblClick": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/plsql",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n"
          }
        ]
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055264210_452351850",
      "id": "20220124-201424_577977825",
      "dateCreated": "2020-11-22T00:53:04+0000",
      "dateStarted": "2022-03-10T18:19:19+0000",
      "dateFinished": "2022-03-10T18:19:28+0000",
      "status": "FINISHED"
    },
    {
      "title": " The attribute ranks can be found in the model view",
      "text": "%sql\n \nSELECT   ATTRIBUTE_NAME, ROUND(ATTRIBUTE_IMPORTANCE_VALUE, 4) IMPORTANCE_VALUE, ATTRIBUTE_RANK\nFROM     DM$VIEM_LTV_CLUS_SAMPLE \nORDER BY ATTRIBUTE_RANK;",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T18:19:28+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/osql",
        "fontSize": 9.0,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "ATTRIBUTE_NAME": "string",
                      "IMPORTANCE_VALUE": "number",
                      "ATTRIBUTE_RANK": "number"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "ATTRIBUTE_NAME\tIMPORTANCE_VALUE\tATTRIBUTE_RANK\nHOME_OWNERSHIP\t0.3372\t1\nNUM_MORTGAGES\t0.3369\t2\nMORTGAGE_AMOUNT\t0.3007\t3\nLTV\t0.2985\t4\nLTV_BIN\t0.2966\t5\nCUSTOMER_TENURE\t0.2919\t6\nNUM_DEPENDENTS\t0.2863\t7\nNUM_TRANS_ATM\t0.2372\t8\nNUM_ONLINE_TRANS\t0.2366\t9\nSTATE\t0.2365\t10\nREGION\t0.2314\t11\nMONEY_MONTLY_OVERDRAWN\t0.2277\t12\nMARITAL_STATUS\t0.2261\t13\nBANK_FUNDS\t0.2061\t14\nGENDER\t0.2004\t15\nCREDIT_BALANCE\t0.1633\t16\nINCOME\t0.1618\t17\nTOTAL_AUTOM_PAYMENTS\t0.1185\t18\nCAR_OWNERSHIP\t0.1126\t19\nNUM_TRANS_TELLER\t0.1092\t20\nHAS_CHILDREN\t0.1018\t21\nPROFESSION\t0.0945\t22\nBUY_INSURANCE\t0.087\t23\nAGE\t0.0782\t24\nMONTHLY_CHECKS\t0.0773\t25\nCREDIT_CARD_LIMITS\t0.0738\t26\nCHECKING_BALANCE\t0.0622\t27\nNUM_TRANS_KIOSK\t0.0468\t28\nLAST_NAME\t0.0279\t29\nFIRST_NAME\t0.0071\t30\n"
          }
        ]
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055264210_-181594878",
      "id": "20220124-201424_1638303602",
      "dateCreated": "2020-11-22T00:56:45+0000",
      "dateStarted": "2022-03-10T18:19:29+0000",
      "dateFinished": "2022-03-10T18:19:29+0000",
      "status": "FINISHED"
    },
    {
      "text": "%md\n\n# End of Script\n",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T18:19:29+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "md",
          "editOnDblClick": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003ch1\u003eEnd of Script\u003c/h1\u003e\n"
          }
        ]
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055264210_1974468169",
      "id": "20220124-201424_1965484230",
      "dateCreated": "2020-11-22T00:56:04+0000",
      "dateStarted": "2022-03-10T18:19:29+0000",
      "dateFinished": "2022-03-10T18:19:29+0000",
      "status": "FINISHED"
    },
    {
      "text": "%md\n",
      "user": "OMLUSER",
      "dateUpdated": "2022-03-10T18:19:29+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "md",
          "editOnDblClick": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "interrupted": false,
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1643055264210_-485696615",
      "id": "20220124-201424_1485222446",
      "dateCreated": "2020-12-23T18:34:47+0000",
      "dateStarted": "2022-03-10T18:19:30+0000",
      "dateFinished": "2022-03-10T18:19:30+0000",
      "status": "FINISHED"
    }
  ],
  "name": "OML4SQL Feature Selection Unsupervised Attribute Importance",
  "id": "101050",
  "defaultInterpreterGroup": "spark",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {
    "isRunning": false
  }
}