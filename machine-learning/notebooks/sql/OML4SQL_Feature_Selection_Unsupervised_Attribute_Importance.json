{"paragraphs":[{"text":"%md\n\n## OML4SQL Feature Selection: Unsupervised\nIn this notebook, we demonstrate how to perform feature selection using the in-database unsupervised algorithm Expectation Maximization (EM).\n\nWe use the customer insurance lifetime value data set which contains customer financial information, lifetime value, and whether or not the customer bought insurance.\n\nThis example illustrates using the CREATE_MODEL function, which leverages the settings table (in contrast to the CREATE_MODEL2 function used in other notebooks).\n\nThe dataset `CUSTOMER_INSURANCE_LTV_SQL` is generated by the `\"OML Run-me-first\"` notebook, which `MUST` be run before this notebook.\n\n---\n\n##### `IMPORTANT`: The `\"OML Run-me-first\"` notebook is available under the menu Templates -> Examples and is a pre-requisite to the current notebook.\n\n---\n\nCopyright (c) 2021 Oracle Corporation \n###### <a href=\"https://oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0</a>\n---","user":"OMLUSER","dateUpdated":"2021-08-25T02:57:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>OML4SQL Feature Selection: Unsupervised</h2>\n<p>In this notebook, we demonstrate how to perform feature selection using the in-database unsupervised algorithm Expectation Maximization (EM).</p>\n<p>We use the customer insurance lifetime value data set which contains customer financial information, lifetime value, and whether or not the customer bought insurance.</p>\n<p>This example illustrates using the CREATE_MODEL function, which leverages the settings table (in contrast to the CREATE_MODEL2 function used in other notebooks).</p>\n<p>The dataset <code>CUSTOMER_INSURANCE_LTV_SQL</code> is generated by the <code>\"OML Run-me-first\"</code> notebook, which <code>MUST</code> be run before this notebook.</p>\n<hr />\n<h5><code>IMPORTANT</code>: The <code>\"OML Run-me-first\"</code> notebook is available under the menu Templates -> Examples and is a pre-requisite to the current notebook.</h5>\n<hr />\n<p>Copyright (c) 2021 Oracle Corporation</p>\n<h6><a href=\"https: //oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0</a></h6>\n<hr />\n"}]},"interrupted":false,"jobName":"paragraph_1627066226586_1686274013","id":"20210723-185026_343058867","dateCreated":"2020-12-16T19:45:18+0000","dateStarted":"2021-08-25T02:57:11+0000","dateFinished":"2021-08-25T02:57:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"focus":true,"$$hashKey":"object:40"},{"title":"For more information ...","text":"%md\n\nOML4SQL Expectation Maximization documentation: <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmcon/expectation-maximization.html\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmcon/expectation-maximization.html');\"> https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmcon/expectation-maximization.html </a>","user":"OMLUSER","dateUpdated":"2021-08-25T02:57:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>OML4SQL Expectation Maximization documentation: <a href=\"https: //docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmcon/expectation-maximization.html\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmcon/expectation-maximization.html');\"> https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/21/dmcon/expectation-maximization.html </a></p>\n"}]},"interrupted":false,"jobName":"paragraph_1627066226586_-990673010","id":"20210723-185026_559900851","dateCreated":"2020-12-17T03:57:02+0000","dateStarted":"2021-08-25T02:57:12+0000","dateFinished":"2021-08-25T02:57:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:41"},{"title":"Drop the setting table if exists","text":"%script\n\nBEGIN EXECUTE IMMEDIATE 'DROP TABLE EM_LTV_SAMPLE_SETTINGS';\nEXCEPTION WHEN OTHERS THEN NULL; END;","user":"OMLUSER","dateUpdated":"2021-08-25T02:57:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"plsql","editOnDblClick":false},"editorMode":"ace/mode/plsql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nPL/SQL procedure successfully completed.\n\n"}]},"interrupted":false,"jobName":"paragraph_1627066226586_-407534476","id":"20210723-185026_155897872","dateCreated":"2020-11-22T00:53:45+0000","dateStarted":"2021-08-25T02:57:12+0000","dateFinished":"2021-08-25T02:57:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:42"},{"title":"Create setting table","text":"%sql\n\nCREATE TABLE EM_LTV_SAMPLE_SETTINGS (\n   SETTING_NAME  VARCHAR2(30),\n   SETTING_VALUE VARCHAR2(4000));","user":"OMLUSER","dateUpdated":"2021-08-25T02:57:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"interrupted":false,"jobName":"paragraph_1627066226586_-698803926","id":"20210723-185026_1167283512","dateCreated":"2020-12-23T18:32:37+0000","dateStarted":"2021-08-25T02:57:21+0000","dateFinished":"2021-08-25T02:57:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:43"},{"title":"Add settings, set the number of maximum clusters to be 1","text":"%script\n\nBEGIN       \n   INSERT INTO EM_LTV_SAMPLE_SETTINGS (SETTING_NAME, SETTING_VALUE) VALUES\n   (DBMS_DATA_MINING.ALGO_NAME, DBMS_DATA_MINING.ALGO_EXPECTATION_MAXIMIZATION);\n   INSERT INTO EM_LTV_SAMPLE_SETTINGS (SETTING_NAME, SETTING_VALUE) VALUES \n   (DBMS_DATA_MINING.PREP_AUTO,DBMS_DATA_MINING.PREP_AUTO_ON);\n   INSERT INTO EM_LTV_SAMPLE_SETTINGS (SETTING_NAME, SETTING_VALUE) VALUES \n   (DBMS_DATA_MINING.CLUS_NUM_CLUSTERS,1);\n   \nEND;\n/","user":"OMLUSER","dateUpdated":"2021-08-25T02:58:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"plsql","editOnDblClick":false},"editorMode":"ace/mode/plsql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n"}]},"interrupted":false,"jobName":"paragraph_1627066226586_-516350549","id":"20210723-185026_1143821064","dateCreated":"2020-12-23T18:32:25+0000","dateStarted":"2021-08-25T02:57:22+0000","dateFinished":"2021-08-25T02:57:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:44"},{"title":"Create EM model","text":"%script\n\nBEGIN DBMS_DATA_MINING.DROP_MODEL('EM_LTV_CLUS_SAMPLE');\nEXCEPTION WHEN OTHERS THEN NULL; END;\n\n---------------------\n-- CREATE A NEW MODEL\n--\nBEGIN\n  DBMS_DATA_MINING.CREATE_MODEL(\n    MODEL_NAME          => 'EM_LTV_CLUS_SAMPLE',\n    MINING_FUNCTION     => DBMS_DATA_MINING.CLUSTERING,\n    DATA_TABLE_NAME     => 'CUSTOMER_INSURANCE_LTV_SQL',\n    CASE_ID_COLUMN_NAME => 'CUSTOMER_ID',\n    SETTINGS_TABLE_NAME => 'EM_LTV_SAMPLE_SETTINGS');\nEND;\n/","user":"OMLUSER","dateUpdated":"2021-08-25T02:57:22+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"plsql","editOnDblClick":false},"editorMode":"ace/mode/plsql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n"}]},"interrupted":false,"jobName":"paragraph_1627066226586_359487397","id":"20210723-185026_518889934","dateCreated":"2020-11-22T00:53:04+0000","dateStarted":"2021-08-25T02:57:23+0000","dateFinished":"2021-08-25T02:57:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:45"},{"title":" The attribute ranks can be found in the model view","text":"%sql\n \nSELECT ATTRIBUTE_NAME, ROUND(ATTRIBUTE_IMPORTANCE_VALUE, 4), ATTRIBUTE_RANK\nFROM DM$VIEM_LTV_CLUS_SAMPLE ORDER BY ATTRIBUTE_RANK;","user":"OMLUSER","dateUpdated":"2021-08-25T02:57:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"ATTRIBUTE_NAME":"string","ROUND(ATTRIBUTE_IMPORTANCE_VALUE,4)":"string","ATTRIBUTE_RANK":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"ATTRIBUTE_NAME\tROUND(ATTRIBUTE_IMPORTANCE_VALUE,4)\tATTRIBUTE_RANK\nHOME_OWNERSHIP\t0.3372\t1\nNUM_MORTGAGES\t0.3369\t2\nMORTGAGE_AMOUNT\t0.3007\t3\nLTV\t0.2985\t4\nLTV_BIN\t0.2966\t5\nCUSTOMER_TENURE\t0.2919\t6\nNUM_DEPENDENTS\t0.2863\t7\nNUM_TRANS_ATM\t0.2372\t8\nNUM_ONLINE_TRANS\t0.2366\t9\nSTATE\t0.2365\t10\nREGION\t0.2314\t11\nMONEY_MONTLY_OVERDRAWN\t0.2277\t12\nMARITAL_STATUS\t0.2261\t13\nBANK_FUNDS\t0.2061\t14\nGENDER\t0.2004\t15\nCREDIT_BALANCE\t0.1633\t16\nINCOME\t0.1618\t17\nTOTAL_AUTOM_PAYMENTS\t0.1185\t18\nCAR_OWNERSHIP\t0.1126\t19\nNUM_TRANS_TELLER\t0.1092\t20\nHAS_CHILDREN\t0.1018\t21\nPROFESSION\t0.0945\t22\nBUY_INSURANCE\t0.087\t23\nAGE\t0.0782\t24\nMONTHLY_CHECKS\t0.0773\t25\nCREDIT_CARD_LIMITS\t0.0738\t26\nCHECKING_BALANCE\t0.0622\t27\nNUM_TRANS_KIOSK\t0.0468\t28\nLAST_NAME\t0.0279\t29\nFIRST_NAME\t0.0071\t30\n"}]},"interrupted":false,"jobName":"paragraph_1627066226586_1416812827","id":"20210723-185026_1098397779","dateCreated":"2020-11-22T00:56:45+0000","dateStarted":"2021-08-25T02:57:34+0000","dateFinished":"2021-08-25T02:57:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:46"},{"text":"%md\n\n# End of Script\n","user":"OMLUSER","dateUpdated":"2021-08-25T02:57:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>End of Script</h1>\n"}]},"interrupted":false,"jobName":"paragraph_1627066226586_1318093244","id":"20210723-185026_513646545","dateCreated":"2020-11-22T00:56:04+0000","dateStarted":"2021-08-25T02:57:35+0000","dateFinished":"2021-08-25T02:57:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:47"},{"text":"%md\n","user":"OMLUSER","dateUpdated":"2021-08-24T04:07:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1627066226586_-1607592461","id":"20210723-185026_814098969","dateCreated":"2020-12-23T18:34:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:48"}],"name":"OML4SQL Feature Selection Unsupervised Attribute Importance","id":"68840","noteParams":{},"noteForms":{},"angularObjects":{"MDW381939C745:shared_process":[],"ORA7A60DC9B32:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}