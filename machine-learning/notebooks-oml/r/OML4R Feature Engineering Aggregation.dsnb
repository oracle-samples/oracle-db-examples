[{"layout":null,"template":null,"templateConfig":null,"name":"OML4R Feature Engineering Aggregation","description":null,"readOnly":false,"type":"low","paragraphs":[{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":null,"message":["%md"," "],"enabled":true,"result":{"startTime":1736280010207,"interpreter":"md.low","endTime":1736280010648,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","# OML4R Feature Engineering: Aggregation","In this notebook, we demonstrate how to perform aggregation for min, max, mean, and count using OML4R.","","Using the SH schema SALES table, which contains transaction records for each customer and products purchased, we create features by aggregating the amount sold for each customer and product pair.","","Copyright (c) 2025 Oracle Corporation ","###### <a href=\"https://oss.oracle.com/licenses/upl/\" target=\"_blank\">The Universal Permissive License (UPL), Version 1.0<\/a>","---"],"enabled":true,"result":{"startTime":1736280011076,"interpreter":"md.low","endTime":1736280011496,"results":[{"message":"<h1 id=\"oml4r-feature-engineering-aggregation\">OML4R Feature Engineering: Aggregation<\/h1>\n<p>In this notebook, we demonstrate how to perform aggregation for min, max, mean, and count using OML4R.<\/p>\n<p>Using the SH schema SALES table, which contains transaction records for each customer and products purchased, we create features by aggregating the amount sold for each customer and product pair.<\/p>\n<p>Copyright (c) 2025 Oracle Corporation<\/p>\n<h6 id=\"the-universal-permissive-license-upl-version-10\"><a href=\"https://oss.oracle.com/licenses/upl/\" target=\"_blank\">The Universal Permissive License (UPL), Version 1.0<\/a><\/h6>\n<hr />\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"For more information","message":["%md","","* <a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a>","* <a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a>","* <a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a>","* <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4r/2.0.0/oreug/prepare-and-explore-data-database.html#GUID-9EA7BB02-A334-4ADF-A37A-7042370FB258\" target=\"_blank\">OML4R Data Preparation<\/a>"],"enabled":true,"result":{"startTime":1736280269328,"interpreter":"md.low","endTime":1736280269739,"results":[{"message":"<ul>\n<li><a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a><\/li>\n<li><a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a><\/li>\n<li><a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a><\/li>\n<li><a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4r/2.0.0/oreug/prepare-and-explore-data-database.html#GUID-9EA7BB02-A334-4ADF-A37A-7042370FB258\" target=\"_blank\">OML4R Data Preparation<\/a><\/li>\n<\/ul>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Import R libraries","message":["%r","","library(ORE)","library(OREdplyr)","options(ore.warn.order=FALSE)"],"enabled":true,"result":{"startTime":1736280273974,"interpreter":"r.low","endTime":1736280274438,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Get a proxy object to the SALES data and view a few records.","message":["%r","","ore.sync(query = c(\"SALES_DF\" = \"select cust_id, prod_id, amount_sold from sh.sales\"))","ore.attach()","","z.show(head(SALES_DF, 10))"],"enabled":true,"result":{"startTime":1736280018254,"interpreter":"r.low","endTime":1736280018832,"results":[{"message":"CUST_ID\tPROD_ID\tAMOUNT_SOLD\n524\t13\t1205.99\n2128\t13\t1250.25\n3212\t13\t1250.25\n3375\t13\t1250.25\n5204\t13\t1250.25\n7082\t13\t1250.25\n9316\t13\t1250.25\n12782\t13\t1250.25\n13869\t13\t1250.25\n1949\t13\t1210.21\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"View multiple records for each customer and product pair with count","message":["%r","","OUTPUT <- rename(count(SALES_DF, CUST_ID, PROD_ID), \"count\" = n)","","z.show(head(OUTPUT, 10))"],"enabled":true,"result":{"startTime":1736280019244,"interpreter":"r.low","endTime":1736280020162,"results":[{"message":"CUST_ID\tPROD_ID\tcount\n2\t13\t4\n2\t14\t12\n2\t15\t5\n2\t17\t9\n2\t18\t14\n2\t20\t1\n2\t23\t4\n2\t25\t3\n2\t26\t4\n2\t30\t9\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Compute cross tabulation using min, max, mean, and count for each customer and product ","message":["%r"," ","MAX_DF <- summarise(group_by(SALES_DF, CUST_ID, PROD_ID), \"max(AMOUNT_SOLD)\" = max(AMOUNT_SOLD))","MIN_DF <- summarise(group_by(SALES_DF, CUST_ID, PROD_ID), \"min(AMOUNT_SOLD)\" = min(AMOUNT_SOLD))","MEAN_DF <-summarise(group_by(SALES_DF, CUST_ID, PROD_ID), \"mean(AMOUNT_SOLD)\" = mean(AMOUNT_SOLD))","COUNT_DF <- summarise(group_by(SALES_DF, CUST_ID, PROD_ID), \"count(AMOUNT_SOLD)\" = n())"],"enabled":true,"result":{"startTime":1736280020575,"interpreter":"r.low","endTime":1736280022119,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":null,"message":["%r","","z.show(head(MAX_DF, 10))"],"enabled":true,"result":{"startTime":1736280022537,"interpreter":"r.low","endTime":1736280023071,"results":[{"message":"CUST_ID\tPROD_ID\tmax.AMOUNT_SOLD.\n2\t13\t1232.16\n2\t14\t1259.99\n2\t15\t999.99\n2\t17\t1550.99\n2\t18\t1702.99\n2\t20\t599.99\n2\t23\t23.75\n2\t25\t126.55\n2\t26\t167.99\n2\t30\t10.79\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":null,"message":["%r","","z.show(head(MIN_DF, 10))"],"enabled":true,"result":{"startTime":1736280023488,"interpreter":"r.low","endTime":1736280024023,"results":[{"message":"CUST_ID\tPROD_ID\tmin.AMOUNT_SOLD.\n2\t13\t1205.99\n2\t14\t1239.99\n2\t15\t999.99\n2\t17\t1495.99\n2\t18\t1204.26\n2\t20\t599.99\n2\t23\t23.75\n2\t25\t125.98\n2\t26\t167.24\n2\t30\t10.79\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":null,"message":["%r","","z.show(head(MEAN_DF, 10))"],"enabled":true,"result":{"startTime":1736280024437,"interpreter":"r.low","endTime":1736280024970,"results":[{"message":"CUST_ID\tPROD_ID\tmean.AMOUNT_SOLD.\n2\t13\t1212.5325\n2\t14\t1253.32333333333\n2\t15\t999.99\n2\t17\t1526.54555555556\n2\t18\t1498.16357142857\n2\t20\t599.99\n2\t23\t23.75\n2\t25\t126.17\n2\t26\t167.615\n2\t30\t10.79\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":null,"message":["%r","","z.show(head(COUNT_DF, 10))"],"enabled":true,"result":{"startTime":1736280025386,"interpreter":"r.low","endTime":1736280025922,"results":[{"message":"CUST_ID\tPROD_ID\tcount.AMOUNT_SOLD.\n2\t13\t4\n2\t14\t12\n2\t15\t5\n2\t17\t9\n2\t18\t14\n2\t20\t1\n2\t23\t4\n2\t25\t3\n2\t26\t4\n2\t30\t9\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Join all results","message":["%r","","AGG_DF <- merge(MAX_DF, MIN_DF)","AGG_DF <- merge(AGG_DF, MEAN_DF)","AGG_DF <- merge(AGG_DF, COUNT_DF)"],"enabled":true,"result":{"startTime":1736280026332,"interpreter":"r.low","endTime":1736280031579,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"View aggregated data","message":["%r","","z.show(head(round(AGG_DF, 2), 10))"],"enabled":true,"result":{"startTime":1736280031997,"interpreter":"r.low","endTime":1736280037325,"results":[{"message":"CUST_ID\tPROD_ID\tmax.AMOUNT_SOLD.\tmin.AMOUNT_SOLD.\tmean.AMOUNT_SOLD.\tcount.AMOUNT_SOLD.\n2957\t31\t9.04\t8.96\t9\t4\n2769\t48\t13\t13\t13\t2\n3704\t48\t13\t13\t13\t2\n11663\t48\t13\t13\t13\t2\n11\t48\t13\t13\t13\t4\n15124\t48\t13.66\t10.36\t13\t5\n1586\t23\t21.42\t20.58\t21\t2\n930\t23\t22\t22\t22\t1\n1126\t23\t23\t23\t23\t1\n1313\t23\t23\t23\t23\t1\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","## End of Script"],"enabled":true,"result":{"startTime":1736280037740,"interpreter":"md.low","endTime":1736280038142,"results":[{"message":"<h2 id=\"end-of-script\">End of Script<\/h2>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md"],"enabled":true,"result":{"startTime":1736280038578,"interpreter":"md.low","endTime":1736280038984,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"}],"version":"6","snapshot":false,"tags":null}]