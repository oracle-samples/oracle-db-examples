[{"layout":null,"template":null,"templateConfig":null,"name":"OML4SQL Data Transformation Binning","description":null,"readOnly":false,"type":"low","paragraphs":[{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":null,"message":[],"enabled":true,"result":{"startTime":1733781024761,"interpreter":"md.low","endTime":1733781025200,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":0,"hideResult":true,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","# OML4SQL Data Transformation: Binning","In this notebook, we demonstrate how to bin numeric columns using Oracle SQL and the DBMS_DATA_MINING_TRANSFORM package.","","We use the customer insurance lifetime value data set, which contains customer financial information, lifetime value, and whether or not the customer bought insurance.","","We show how to bin a numerical column and visualize the distribution.","","The dataset `CUSTOMER_INSURANCE_LTV_SQL` is generated by the `\"OML Run-me-first\"` notebook, which `MUST` be run before this notebook.","","---","","##### IMPORTANT: The `\"OML Run-me-first\"` notebook is available under the menu `Templates -> Examples` and is a pre-requisite to the current notebook.","","---","","**Note**: If the user plans to use the in-database Naive Bayes algorithm later, Automatic Data Preparation (ADP) performs supervised binning. ","Supervised binning uses decision trees to create the optimal bin boundaries. ","More details can be found in <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/23/dmcon/naive-bayes.html#GUID-FD929CF9-6513-42DE-B04D-FD57310C3A04\" target=\"_blank\">Naive Bayes<\/a>","","Copyright (c) 2025 Oracle Corporation ","###### <a href=\"https://oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0<\/a>","---"],"enabled":true,"result":{"startTime":1733781025664,"interpreter":"md.low","endTime":1733781026118,"results":[{"message":"<h1 id=\"oml4sql-data-transformation-binning\">OML4SQL Data Transformation: Binning<\/h1>\n<p>In this notebook, we demonstrate how to bin numeric columns using Oracle SQL and the DBMS_DATA_MINING_TRANSFORM package.<\/p>\n<p>We use the customer insurance lifetime value data set, which contains customer financial information, lifetime value, and whether or not the customer bought insurance.<\/p>\n<p>We show how to bin a numerical column and visualize the distribution.<\/p>\n<p>The dataset <code>CUSTOMER_INSURANCE_LTV_SQL<\/code> is generated by the <code>&quot;OML Run-me-first&quot;<\/code> notebook, which <code>MUST<\/code> be run before this notebook.<\/p>\n<hr />\n<h5 id=\"important-the-oml-run-me-first-notebook-is-available-under-the-menu-templates---examples-and-is-a-pre-requisite-to-the-current-notebook\">IMPORTANT: The <code>&quot;OML Run-me-first&quot;<\/code> notebook is available under the menu <code>Templates -&gt; Examples<\/code> and is a pre-requisite to the current notebook.<\/h5>\n<hr />\n<p><strong>Note<\/strong>: If the user plans to use the in-database Naive Bayes algorithm later, Automatic Data Preparation (ADP) performs supervised binning.\nSupervised binning uses decision trees to create the optimal bin boundaries.\nMore details can be found in <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4sql/23/dmcon/naive-bayes.html#GUID-FD929CF9-6513-42DE-B04D-FD57310C3A04\" target=\"_blank\">Naive Bayes<\/a><\/p>\n<p>Copyright (c) 2025 Oracle Corporation<\/p>\n<h6 id=\"the-universal-permissive-license-upl-version-10\"><a href=\"https://oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0<\/a><\/h6>\n<hr />\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"For more information ...","message":["%md","","* <a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a>","* <a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a>","* <a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a>","* <a href=\"https://docs.oracle.com/en/database/oracle/oracle-database/23/arpls/DBMS_DATA_MINING_TRANSFORM.html\" target=\"_blank\">OML4SQL DBMS_DATA_MINING_TRANSFORM Documentation<\/a>"],"enabled":true,"result":{"startTime":1733781026591,"interpreter":"md.low","endTime":1733781027032,"results":[{"message":"<ul>\n<li><a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a><\/li>\n<li><a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a><\/li>\n<li><a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a><\/li>\n<li><a href=\"https://docs.oracle.com/en/database/oracle/oracle-database/23/arpls/DBMS_DATA_MINING_TRANSFORM.html\" target=\"_blank\">OML4SQL DBMS_DATA_MINING_TRANSFORM Documentation<\/a><\/li>\n<\/ul>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Display CUSTOMER_INSURANCE_LTV_SQL data","message":["%sql\r","\r","SELECT * \r","FROM   CUSTOMER_INSURANCE_LTV_SQL\r","FETCH FIRST 10 ROWS ONLY;\r"],"enabled":true,"result":{"startTime":1733781027500,"interpreter":"sql.low","endTime":1733781027958,"results":[{"message":"MARITAL_STATUS\tSTATE\tCREDIT_BALANCE\tCUSTOMER_TENURE\tMORTGAGE_AMOUNT\tBANK_FUNDS\tNUM_DEPENDENTS\tHAS_CHILDREN\tINCOME\tCUSTOMER_ID\tGENDER\tPROFESSION\tCREDIT_CARD_LIMITS\tREGION\tHOME_OWNERSHIP\tNUM_ONLINE_TRANS\tBUY_INSURANCE\tMONTHLY_CHECKS\tNUM_TRANS_KIOSK\tAGE\tMONEY_MONTLY_OVERDRAWN\tLTV\tTOTAL_AUTOM_PAYMENTS\tNUM_TRANS_TELLER\tCHECKING_BALANCE\tNUM_TRANS_ATM\tLTV_BIN\tFIRST_NAME\tNUM_MORTGAGES\tCAR_OWNERSHIP\tLAST_NAME\nSINGLE\tCA                        \t0\t3\t400\t590\t3\t1\t61384\tCU8720                    \tM                         \tWaiter/Waitress\t1000\tWest\t1\t400\tYes\t2\t1\t23\t53.98\t18146\t208\t2\t25\t5\tMEDIUM\tKENNETH\t1\t1\tNADEAU\nDIVORCED\tWA                        \t0\t3\t2050\t650\t3\t1\t63525\tCU8721                    \tM                         \tSoftware Engineer\t1000\tWest\t1\t2050\tYes\t13\t3\t22\t54.35\t18581.25\t242\t2\t25\t5\tMEDIUM\tJARVIS\t1\t1\tCLARKE\nDIVORCED\tNY                        \t0\t4\t2500\t700\t1\t0\t71504\tCU8722                    \tF                         \tIT Staff\t1000\tNorthEast\t1\t2500\tNo\t1\t1\t42\t53.79\t32076\t393\t3\t118\t4\tVERY HIGH\tSTACEY\t1\t1\tHENSON\nMARRIED\tMI                        \t0\t1\t8320\t11050\t1\t1\t72308\tCU8665                    \tF                         \tDentist\t4000\tMidwest\t1\t1700\tYes\t14\t1\t33\t53.97\t24877\t650\t4\t25\t5\tHIGH\tMARGRET\t1\t1\tRYAN\nMARRIED\tMI                        \t0\t1\t1000\t0\t1\t1\t64710\tCU8666                    \tM                         \tIT Staff\t700\tMidwest\t1\t1000\tNo\t4\t1\t38\t53.17\t23477.5\t383\t0\t374\t2\tHIGH\tJOAN\t1\t1\tBAUER\nDIVORCED\tNC                        \t0\t4\t4000\t8800\t6\t1\t61332\tCU9108                    \tF                         \tPROF-15\t800\tSouth\t1\t1600\tYes\t1\t1\t66\t54.97\t16933\t1923\t4\t25\t5\tMEDIUM\tMARGART\t1\t1\tCALDWELL\nMARRIED\tTX                        \t0\t3\t845\t450\t3\t1\t62061\tCU9113                    \tM                         \tProgrammer/Developer\t1500\tSouthwest\t1\t845\tYes\t8\t6\t26\t53.01\t18615.25\t226\t2\t25\t2\tMEDIUM\tNICKY\t1\t1\tBARON\nSINGLE\tNV                        \t0\t2\t0\t0\t0\t0\t74394\tCU9114                    \tM                         \tSales Representative\t1500\tSouthwest\t0\t0\tNo\t0\t1\t0\t53.06\t0\t0\t0\t25\t0\tLOW\tHUNG\t0\t0\tFINNEY\nSINGLE\tMI                        \t0\t3\t0\t0\t3\t0\t64255\tCU8462                    \tM                         \tPROF-31\t1500\tMidwest\t0\t0\tNo\t1\t1\t28\t53.14\t14363.75\t0\t0\t25\t2\tMEDIUM\tFREDDIE\t0\t0\tMAYBERRY\nDIVORCED\tMI                        \t0\t1\t2513\t1150\t1\t0\t70749\tCU8506                    \tM                         \tPlumber\t1000\tMidwest\t1\t2513\tNo\t11\t1\t48\t54.13\t30987.25\t6248\t3\t466\t5\tVERY HIGH\tJON\t1\t1\tDUTTON\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Generate view that contains the columns for binning","message":["%sql","","CREATE OR REPLACE VIEW CUSTOMER_BIN_NUM_V AS","  SELECT CUSTOMER_ID, MORTGAGE_AMOUNT, BANK_FUNDS, AGE","  FROM   CUSTOMER_INSURANCE_LTV_SQL;"],"enabled":true,"result":{"startTime":1733781028436,"interpreter":"sql.low","endTime":1733781028893,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Generate the mapping from the values to bins","message":["%script","","BEGIN","    EXECUTE IMMEDIATE 'DROP TABLE bin_num_tbl';","    EXCEPTION WHEN OTHERS THEN NULL;","END;","BEGIN","    dbms_data_mining_transform.create_bin_num ('bin_num_tbl');","    dbms_data_mining_transform.insert_bin_num_qtile (","        bin_table_name    => 'bin_num_tbl',","        data_table_name   => 'CUSTOMER_BIN_NUM_V',","        bin_num\t           => 7,","        exclude_list      =>  dbms_data_mining_transform.COLUMN_LIST('customer_id'));","END;"],"enabled":true,"result":{"startTime":1733781029349,"interpreter":"script.low","endTime":1733781029880,"results":[{"message":"\nPL/SQL procedure successfully completed.\n\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Describe the table to see data types","message":["%script","","descr bin_num_tbl"],"enabled":true,"result":{"startTime":1733781287797,"interpreter":"script.low","endTime":1733781288466,"results":[{"message":"Name Null? Type           \n---- ----- -------------- \nCOL       VARCHAR2(128) \nATT       VARCHAR2(4000) \nVAL       NUMBER  \nBIN       VARCHAR2(4000) \n\n---------------------------\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Check mapping from value of the column to bin","message":["%sql","","SELECT COL, VAL, BIN","FROM   bin_num_tbl","WHERE COL = 'AGE'","FETCH FIRST 10 ROWS ONLY"],"enabled":true,"result":{"startTime":1733781031365,"interpreter":"sql.low","endTime":1733781031869,"results":[{"message":"COL\tVAL\tBIN\nAGE\t0\t\nAGE\t23\t1\nAGE\t28\t2\nAGE\t33\t3\nAGE\t39\t4\nAGE\t45\t5\nAGE\t53\t6\nAGE\t84\t7\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Generate the view that contains binned columns","message":["%script","","BEGIN","    EXECUTE IMMEDIATE 'DROP VIEW CUSTOMER_BIN_NUM_STACK';","    EXCEPTION WHEN OTHERS THEN NULL;","END;","","DECLARE","   MINING_DATA_STACK   dbms_data_mining_transform.TRANSFORM_LIST;","BEGIN","   dbms_data_mining_transform.STACK_BIN_NUM (","      bin_table_name\t    => 'bin_num_tbl',","      xform_list\t        =>  mining_data_stack);","   dbms_data_mining_transform.XFORM_STACK (","      xform_list\t        =>  mining_data_stack,","      data_table_name   => 'CUSTOMER_BIN_NUM_V',","      xform_view_name   => 'CUSTOMER_BIN_NUM_STACK');","END;","/"],"enabled":true,"result":{"startTime":1733781032327,"interpreter":"script.low","endTime":1733781032860,"results":[{"message":"\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":"[{\"bar\":{\"showSeries\":[\"COUNT\"],\"aggregationOption\":\"Last\",\"series\":{\"availableSeriesElements\":[{\"id\":\"COUNT\",\"lineType\":\"straight\",\"borderColor\":\"rgb(25, 95, 116)\",\"borderWidth\":0,\"color\":\"rgb(25, 95, 116)\",\"pattern\":\"auto\",\"markerColor\":\"rgb(25, 95, 116)\",\"markerDisplayed\":\"auto\",\"markerShape\":\"auto\",\"markerSize\":0}]},\"axis\":{\"x\":{\"title\":\"Age\"},\"y\":{\"title\":\"Count\"}},\"lastColumns\":[\"AGE\",\"COUNT\"],\"version\":1}}]","hideInIFrame":false,"selectedVisualization":"bar","title":"Check original AGE","message":["%sql","","SELECT AGE, COUNT(*) COUNT","FROM   CUSTOMER_INSURANCE_LTV_SQL","GROUP BY AGE"],"enabled":true,"result":{"startTime":1733781033318,"interpreter":"sql.low","endTime":1733781033773,"results":[{"message":"AGE\tCOUNT\n23\t490\n27\t441\n58\t149\n52\t187\n50\t236\n51\t236\n64\t79\n72\t46\n57\t139\n42\t344\n43\t371\n31\t436\n40\t372\n36\t381\n59\t103\n79\t19\n71\t49\n68\t60\n78\t16\n45\t321\n62\t83\n44\t316\n34\t396\n41\t360\n63\t91\n82\t15\n21\t420\n30\t356\n54\t161\n37\t381\n56\t138\n73\t37\n17\t14\n77\t36\n75\t28\n70\t54\n76\t21\n84\t15\n66\t59\n48\t239\n35\t402\n49\t282\n65\t76\n18\t37\n81\t13\n22\t527\n33\t411\n26\t470\n28\t403\n46\t296\n20\t278\n53\t178\n74\t39\n38\t360\n29\t408\n55\t115\n60\t103\n69\t67\n19\t146\n67\t67\n83\t16\n0\t354\n61\t100\n24\t484\n39\t367\n32\t396\n25\t489\n47\t292\n80\t9\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":"[{\"bar\":{\"showSeries\":[\"COUNT\"],\"aggregationOption\":\"Last\",\"series\":{\"availableSeriesElements\":[{\"id\":\"COUNT\",\"lineType\":\"straight\",\"borderColor\":\"rgb(25, 95, 116)\",\"borderWidth\":0,\"color\":\"rgb(25, 95, 116)\",\"pattern\":\"auto\",\"markerColor\":\"rgb(25, 95, 116)\",\"markerDisplayed\":\"auto\",\"markerShape\":\"auto\",\"markerSize\":0}]},\"axis\":{\"x\":{\"title\":\"Age bin\"},\"y\":{\"title\":\"Count\"}},\"lastColumns\":[\"AGE\",\"COUNT\"],\"version\":1}}]","hideInIFrame":false,"selectedVisualization":"bar","title":"Check AGE binned","message":["%sql","","SELECT AGE, COUNT(*) COUNT ","FROM CUSTOMER_BIN_NUM_STACK","GROUP BY AGE"],"enabled":true,"result":{"startTime":1733781034233,"interpreter":"sql.low","endTime":1733781034699,"results":[{"message":"AGE\tCOUNT\n5\t2084\n2\t2287\n6\t1946\n7\t2003\n1\t2266\n3\t2007\n4\t2287\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","## End of Script"],"enabled":true,"result":{"startTime":1733781035166,"interpreter":"md.low","endTime":1733781035618,"results":[{"message":"<h2 id=\"end-of-script\">End of Script<\/h2>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":[],"enabled":true,"result":{"startTime":1733781036096,"interpreter":"md.low","endTime":1733781036567,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"}],"version":"6","snapshot":false,"tags":null}]