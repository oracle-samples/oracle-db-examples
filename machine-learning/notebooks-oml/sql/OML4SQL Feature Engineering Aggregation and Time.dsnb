[{"layout":null,"template":null,"templateConfig":null,"name":"OML4SQL Feature Engineering Aggregation and Time","description":null,"readOnly":false,"type":"low","paragraphs":[{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md"," "],"enabled":true,"result":{"startTime":1736378326057,"interpreter":"md.low","endTime":1736378326488,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","# OML4SQL Feature Engineering: Aggregation and Time","In this notebook, we demonstrate how to generate aggregated features and also extract date and time features using Oracle SQL.","","We are using the SALES table from the SH schema. This dataset contains transaction records for each cusotmer and products sold to each customer and product pair. To create features for each customer and product, we create features by aggregating the amount sold.","","We also show how to extract date and time features from the field TIME_ID.","","Copyright (c) 2025 Oracle Corporation ","###### <a href=\"https://oss.oracle.com/licenses/upl/\" target=\"_blank\">The Universal Permissive License (UPL)"],"enabled":true,"result":{"startTime":1736378386643,"interpreter":"md.low","endTime":1736378387108,"results":[{"message":"<h1 id=\"oml4sql-feature-engineering-aggregation-and-time\">OML4SQL Feature Engineering: Aggregation and Time<\/h1>\n<p>In this notebook, we demonstrate how to generate aggregated features and also extract date and time features using Oracle SQL.<\/p>\n<p>We are using the SALES table from the SH schema. This dataset contains transaction records for each cusotmer and products sold to each customer and product pair. To create features for each customer and product, we create features by aggregating the amount sold.<\/p>\n<p>We also show how to extract date and time features from the field TIME_ID.<\/p>\n<p>Copyright (c) 2025 Oracle Corporation<\/p>\n<h6 id=\"the-universal-permissive-license-upl\"><a href=\"https://oss.oracle.com/licenses/upl/\" target=\"_blank\">The Universal Permissive License (UPL)<\/h6>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md"," ","* <a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a>","* <a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a>","* <a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a>"],"enabled":true,"result":{"startTime":1736378327744,"interpreter":"md.low","endTime":1736378328160,"results":[{"message":"<ul>\n<li><a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a><\/li>\n<li><a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a><\/li>\n<li><a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a><\/li>\n<\/ul>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Display data from the SH.SALES table","message":["%sql","","SELECT * FROM SH.SALES FETCH FIRST 10 ROWS ONLY"],"enabled":true,"result":{"startTime":1736378328596,"interpreter":"sql.low","endTime":1736378330635,"results":[{"message":"PROD_ID\tCUST_ID\tTIME_ID\tCHANNEL_ID\tPROMO_ID\tQUANTITY_SOLD\tAMOUNT_SOLD\n13\t524\t1998-01-20 00:00:00\t2\t999\t1\t1205.99\n13\t2128\t1998-04-05 00:00:00\t2\t999\t1\t1250.25\n13\t3212\t1998-04-05 00:00:00\t2\t999\t1\t1250.25\n13\t3375\t1998-04-05 00:00:00\t2\t999\t1\t1250.25\n13\t5204\t1998-04-05 00:00:00\t2\t999\t1\t1250.25\n13\t7082\t1998-04-05 00:00:00\t2\t999\t1\t1250.25\n13\t9316\t1998-04-05 00:00:00\t2\t999\t1\t1250.25\n13\t12782\t1998-04-05 00:00:00\t2\t999\t1\t1250.25\n13\t13869\t1998-04-05 00:00:00\t2\t999\t1\t1250.25\n13\t1949\t1998-07-05 00:00:00\t2\t999\t1\t1210.21\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Multiple items purchased by each customer and product pair","message":["%sql","","SELECT CUST_ID, PROD_ID, COUNT(1)","FROM SH.SALES","GROUP BY CUST_ID, PROD_ID","FETCH FIRST 10 ROWS ONLY"],"enabled":true,"result":{"startTime":1736378331054,"interpreter":"sql.low","endTime":1736378331625,"results":[{"message":"CUST_ID\tPROD_ID\tCOUNT(1)\n3212\t13\t4\n3375\t13\t3\n13869\t13\t5\n2079\t13\t5\n9038\t13\t7\n25244\t13\t3\n42167\t13\t4\n7902\t13\t6\n12099\t13\t6\n25251\t13\t6\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Create features that summarize the amount sold ","message":["%sql","","SELECT CUST_ID, PROD_ID, MIN(AMOUNT_SOLD) MIN_AMOUNT, MAX(AMOUNT_SOLD) MAX_AMOUNT, ROUND(AVG(AMOUNT_SOLD), 2) AVG_AMOUNT, MEDIAN(AMOUNT_SOLD) MEDIAN_AMOUNT","FROM SH.SALES","GROUP BY CUST_ID, PROD_ID","FETCH FIRST 10 ROWS ONLY"],"enabled":true,"result":{"startTime":1736378332040,"interpreter":"sql.low","endTime":1736378334285,"results":[{"message":"CUST_ID\tPROD_ID\tMIN_AMOUNT\tMAX_AMOUNT\tAVG_AMOUNT\tMEDIAN_AMOUNT\n2\t13\t1205.99\t1232.16\t1212.53\t1205.99\n2\t14\t1239.99\t1259.99\t1253.32\t1259.99\n2\t15\t999.99\t999.99\t999.99\t999.99\n2\t17\t1495.99\t1550.99\t1526.55\t1550.99\n2\t18\t1204.26\t1702.99\t1498.16\t1499.345\n2\t20\t599.99\t599.99\t599.99\t599.99\n2\t23\t23.75\t23.75\t23.75\t23.75\n2\t25\t125.98\t126.55\t126.17\t125.98\n2\t26\t167.24\t167.99\t167.62\t167.615\n2\t30\t10.79\t10.79\t10.79\t10.79\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Augment original TIME_ID with random values to artificially create demo timestamp column","message":["%sql","","CREATE OR REPLACE VIEW SALES_TS AS ","SELECT CUST_ID, CAST(TIME_ID + DBMS_RANDOM.VALUE(0, 10) AS TIMESTAMP) AS  TIME_STAMP","FROM SH.SALES"],"enabled":true,"result":{"startTime":1736378334701,"interpreter":"sql.low","endTime":1736378335162,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Check the view","message":["%sql","","SELECT * ","FROM SALES_TS","FETCH FIRST 10 ROWS ONLY"],"enabled":true,"result":{"startTime":1736378335580,"interpreter":"sql.low","endTime":1736378336074,"results":[{"message":"CUST_ID\tTIME_STAMP\n524\t1998-01-24 19:54:49\n2128\t1998-04-08 19:43:39\n3212\t1998-04-12 14:59:08\n3375\t1998-04-08 06:27:47\n5204\t1998-04-14 17:38:49\n7082\t1998-04-08 22:21:31\n9316\t1998-04-14 07:19:26\n12782\t1998-04-14 10:50:12\n13869\t1998-04-10 00:23:11\n1949\t1998-07-09 23:28:09\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Generate time related features: year, month, day of month, week of year, day of week, hour, minute, second","message":["%sql","","SELECT CUST_ID, TIME_STAMP, ","    EXTRACT(YEAR FROM TIME_STAMP) YEAR, ","    EXTRACT(MONTH FROM TIME_STAMP) MONTH, ","    EXTRACT(DAY FROM TIME_STAMP) DAY_OF_MONTH, ","    TO_CHAR(TIME_STAMP,'WW') WEEK_OF_YEAR, ","    TO_CHAR(TIME_STAMP,'D') DAY_OF_WEEK, ","    EXTRACT(HOUR FROM TIME_STAMP) HOUR, ","    EXTRACT(MINUTE FROM TIME_STAMP) MINUTE, ","    EXTRACT(SECOND FROM TIME_STAMP) SECOND","FROM SALES_TS","FETCH FIRST 10 ROWS ONLY"],"enabled":true,"result":{"startTime":1736378336494,"interpreter":"sql.low","endTime":1736378336933,"results":[{"message":"CUST_ID\tTIME_STAMP\tYEAR\tMONTH\tDAY_OF_MONTH\tWEEK_OF_YEAR\tDAY_OF_WEEK\tHOUR\tMINUTE\tSECOND\n524\t1998-01-28 04:03:40\t1998\t1\t28\t04\t4\t4\t3\t40\n2128\t1998-04-11 16:24:10\t1998\t4\t11\t15\t7\t16\t24\t10\n3212\t1998-04-12 19:36:41\t1998\t4\t12\t15\t1\t19\t36\t41\n3375\t1998-04-10 03:50:20\t1998\t4\t10\t15\t6\t3\t50\t20\n5204\t1998-04-14 07:35:31\t1998\t4\t14\t15\t3\t7\t35\t31\n7082\t1998-04-12 00:41:49\t1998\t4\t12\t15\t1\t0\t41\t49\n9316\t1998-04-06 20:01:50\t1998\t4\t6\t14\t2\t20\t1\t50\n12782\t1998-04-10 06:32:52\t1998\t4\t10\t15\t6\t6\t32\t52\n13869\t1998-04-14 21:38:23\t1998\t4\t14\t15\t3\t21\t38\t23\n1949\t1998-07-08 06:40:58\t1998\t7\t8\t27\t4\t6\t40\t58\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","## End of Script"],"enabled":true,"result":{"startTime":1736378337349,"interpreter":"md.low","endTime":1736378337765,"results":[{"message":"<h2 id=\"end-of-script\">End of Script<\/h2>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md"],"enabled":true,"result":{"startTime":1736378338182,"interpreter":"md.low","endTime":1736378338584,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"}],"version":"6","snapshot":false,"tags":null}]