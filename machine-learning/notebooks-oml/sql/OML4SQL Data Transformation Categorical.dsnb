[{"layout":null,"template":null,"templateConfig":null,"name":"OML4SQL Data Transformation Categorical","description":null,"readOnly":false,"type":"low","paragraphs":[{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":null,"message":["%md"," "],"enabled":true,"result":{"startTime":1736374957478,"interpreter":"md.low","endTime":1736374957920,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","# OML4SQL Data Transformation: convert variables between categorical and numerical","","In this notebook, we demonstrate how to convert a categorical variable to a numeric variable and vice versa using Oracle SQL.","","We use the customer insurance lifetime value data set, which contains customer financial information, ","lifetime value, and whether or not the customer bought insurance.","","We show how to convert a categorical variable with each distinct level/value coded to an integer. ","Also, we show how to create an indicator variable based on a simple predicate. ","","The dataset `CUSTOMER_INSURANCE_LTV_SQL` is generated by the `\"OML Run-me-first\"` notebook, which `MUST` be run before this notebook.","","---","","###### IMPORTANT: The `\"OML Run-me-first\"` notebook is available under the menu `Templates -> Examples` and is a pre-requisite to the current notebook.","","---","","Copyright (c) 2025 Oracle Corporation ","###### <a href=\"https://oss.oracle.com/licenses/upl/\" target=\"_blank\">The Universal Permissive License (UPL), Version 1.0<\/a>"],"enabled":true,"result":{"startTime":1736374958336,"interpreter":"md.low","endTime":1736374958742,"results":[{"message":"<h1 id=\"oml4sql-data-transformation-convert-variables-between-categorical-and-numerical\">OML4SQL Data Transformation: convert variables between categorical and numerical<\/h1>\n<p>In this notebook, we demonstrate how to convert a categorical variable to a numeric variable and vice versa using Oracle SQL.<\/p>\n<p>We use the customer insurance lifetime value data set, which contains customer financial information,\nlifetime value, and whether or not the customer bought insurance.<\/p>\n<p>We show how to convert a categorical variable with each distinct level/value coded to an integer.\nAlso, we show how to create an indicator variable based on a simple predicate.<\/p>\n<p>The dataset <code>CUSTOMER_INSURANCE_LTV_SQL<\/code> is generated by the <code>&quot;OML Run-me-first&quot;<\/code> notebook, which <code>MUST<\/code> be run before this notebook.<\/p>\n<hr />\n<h6 id=\"important-the-oml-run-me-first-notebook-is-available-under-the-menu-templates---examples-and-is-a-pre-requisite-to-the-current-notebook\">IMPORTANT: The <code>&quot;OML Run-me-first&quot;<\/code> notebook is available under the menu <code>Templates -&gt; Examples<\/code> and is a pre-requisite to the current notebook.<\/h6>\n<hr />\n<p>Copyright (c) 2025 Oracle Corporation<\/p>\n<h6 id=\"the-universal-permissive-license-upl-version-10\"><a href=\"https://oss.oracle.com/licenses/upl/\" target=\"_blank\">The Universal Permissive License (UPL), Version 1.0<\/a><\/h6>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"For more information...","message":["%md"," "," * <a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a>","* <a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a>","* <a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a>"],"enabled":true,"result":{"startTime":1736374959169,"interpreter":"md.low","endTime":1736374959575,"results":[{"message":"<ul>\n<li><a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a><\/li>\n<li><a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a><\/li>\n<li><a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a><\/li>\n<\/ul>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Display CUSTOMER_INSURANCE_LTV_SQL data","message":["%sql","","SELECT *","FROM CUSTOMER_INSURANCE_LTV_SQL","FETCH FIRST 10 ROWS ONLY;"],"enabled":true,"result":{"startTime":1736374959990,"interpreter":"sql.low","endTime":1736374960403,"results":[{"message":"MARITAL_STATUS\tSTATE\tCREDIT_BALANCE\tCUSTOMER_TENURE\tMORTGAGE_AMOUNT\tBANK_FUNDS\tNUM_DEPENDENTS\tHAS_CHILDREN\tINCOME\tCUSTOMER_ID\tGENDER\tPROFESSION\tCREDIT_CARD_LIMITS\tREGION\tHOME_OWNERSHIP\tNUM_ONLINE_TRANS\tBUY_INSURANCE\tMONTHLY_CHECKS\tNUM_TRANS_KIOSK\tAGE\tMONEY_MONTLY_OVERDRAWN\tLTV\tTOTAL_AUTOM_PAYMENTS\tNUM_TRANS_TELLER\tCHECKING_BALANCE\tNUM_TRANS_ATM\tLTV_BIN\tFIRST_NAME\tNUM_MORTGAGES\tCAR_OWNERSHIP\tLAST_NAME\nSINGLE\tCA                        \t0\t3\t400\t590\t3\t1\t61384\tCU8720                    \tM                         \tWaiter/Waitress\t1000\tWest\t1\t400\tYes\t2\t1\t23\t53.98\t18146\t208\t2\t25\t5\tMEDIUM\tKENNETH\t1\t1\tNADEAU\nDIVORCED\tWA                        \t0\t3\t2050\t650\t3\t1\t63525\tCU8721                    \tM                         \tSoftware Engineer\t1000\tWest\t1\t2050\tYes\t13\t3\t22\t54.35\t18581.25\t242\t2\t25\t5\tMEDIUM\tJARVIS\t1\t1\tCLARKE\nDIVORCED\tNY                        \t0\t4\t2500\t700\t1\t0\t71504\tCU8722                    \tF                         \tIT Staff\t1000\tNorthEast\t1\t2500\tNo\t1\t1\t42\t53.79\t32076\t393\t3\t118\t4\tVERY HIGH\tSTACEY\t1\t1\tHENSON\nMARRIED\tMI                        \t0\t1\t8320\t11050\t1\t1\t72308\tCU8665                    \tF                         \tDentist\t4000\tMidwest\t1\t1700\tYes\t14\t1\t33\t53.97\t24877\t650\t4\t25\t5\tHIGH\tMARGRET\t1\t1\tRYAN\nMARRIED\tMI                        \t0\t1\t1000\t0\t1\t1\t64710\tCU8666                    \tM                         \tIT Staff\t700\tMidwest\t1\t1000\tNo\t4\t1\t38\t53.17\t23477.5\t383\t0\t374\t2\tHIGH\tJOAN\t1\t1\tBAUER\nDIVORCED\tNC                        \t0\t4\t4000\t8800\t6\t1\t61332\tCU9108                    \tF                         \tPROF-15\t800\tSouth\t1\t1600\tYes\t1\t1\t66\t54.97\t16933\t1923\t4\t25\t5\tMEDIUM\tMARGART\t1\t1\tCALDWELL\nMARRIED\tTX                        \t0\t3\t845\t450\t3\t1\t62061\tCU9113                    \tM                         \tProgrammer/Developer\t1500\tSouthwest\t1\t845\tYes\t8\t6\t26\t53.01\t18615.25\t226\t2\t25\t2\tMEDIUM\tNICKY\t1\t1\tBARON\nSINGLE\tNV                        \t0\t2\t0\t0\t0\t0\t74394\tCU9114                    \tM                         \tSales Representative\t1500\tSouthwest\t0\t0\tNo\t0\t1\t0\t53.06\t0\t0\t0\t25\t0\tLOW\tHUNG\t0\t0\tFINNEY\nSINGLE\tMI                        \t0\t3\t0\t0\t3\t0\t64255\tCU8462                    \tM                         \tPROF-31\t1500\tMidwest\t0\t0\tNo\t1\t1\t28\t53.14\t14363.75\t0\t0\t25\t2\tMEDIUM\tFREDDIE\t0\t0\tMAYBERRY\nDIVORCED\tMI                        \t0\t1\t2513\t1150\t1\t0\t70749\tCU8506                    \tM                         \tPlumber\t1000\tMidwest\t1\t2513\tNo\t11\t1\t48\t54.13\t30987.25\t6248\t3\t466\t5\tVERY HIGH\tJON\t1\t1\tDUTTON\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Encode categorical column STATE using rownum","message":["%sql","","SELECT b.customer_id, a.state_code, a.state","FROM (SELECT rownum state_code,  state","      FROM (SELECT distinct state","            FROM CUSTOMER_INSURANCE_LTV_SQL ) d ) a","JOIN CUSTOMER_INSURANCE_LTV_SQL b ON a.state = b.state","FETCH FIRST 10 ROWS ONLY;"],"enabled":true,"result":{"startTime":1736374960840,"interpreter":"sql.low","endTime":1736374961270,"results":[{"message":"CUSTOMER_ID\tSTATE_CODE\tSTATE\nCU8720                    \t1\tCA                        \nCU8601                    \t1\tCA                        \nCU9120                    \t1\tCA                        \nCU8507                    \t1\tCA                        \nCU8508                    \t1\tCA                        \nCU8838                    \t1\tCA                        \nCU8839                    \t1\tCA                        \nCU8924                    \t1\tCA                        \nCU8925                    \t1\tCA                        \nCU8929                    \t1\tCA                        \n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Create zero credit balance flag when the credit balance is zero","message":["%sql","","SELECT customer_id, ","       case when credit_balance = 0 then 1 else 0 end as zero_credit_balance, ","       credit_balance","FROM   CUSTOMER_INSURANCE_LTV_SQL","FETCH FIRST 10 ROWS ONLY"],"enabled":true,"result":{"startTime":1736374961711,"interpreter":"sql.low","endTime":1736374962131,"results":[{"message":"CUSTOMER_ID\tZERO_CREDIT_BALANCE\tCREDIT_BALANCE\nCU8720                    \t1\t0\nCU8721                    \t1\t0\nCU8722                    \t1\t0\nCU8665                    \t1\t0\nCU8666                    \t1\t0\nCU9108                    \t1\t0\nCU9113                    \t1\t0\nCU9114                    \t1\t0\nCU8462                    \t1\t0\nCU8506                    \t1\t0\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","## End of Script"],"enabled":true,"result":{"startTime":1736374962540,"interpreter":"md.low","endTime":1736374962946,"results":[{"message":"<h2 id=\"end-of-script\">End of Script<\/h2>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md"],"enabled":true,"result":{"startTime":1736374963377,"interpreter":"md.low","endTime":1736374963786,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"}],"version":"6","snapshot":false,"tags":null}]