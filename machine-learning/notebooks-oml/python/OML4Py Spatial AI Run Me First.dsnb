[{"layout":null,"template":null,"templateConfig":null,"name":"OML4Py Spatial AI Run Me First","description":null,"readOnly":false,"type":"low","paragraphs":[{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","# Run-me-first: Spatial AI in Oracle Machine Learning for Python (OML4Py)","","Oracle Machine Learning for Python (OML4Py) makes the Python environment ready for the enterprise. OML4Py integrates Python with Oracle Autonomous Database, enabling the use of Python for machine learning and visualization from database tables and views. Spatial AI is a feature of OML4Py providing algorithms and APIs to analyze, make predictions, and detect patterns from geospatial data. ","","In this notebook, you load data for use in other sample notebooks. Data are loaded and prepared from files stored in OCI Object Storage. ","","**Copyright (c) 2025 Oracle Corporation**","[The Universal Permissive License (UPL), Version 1.0](https://oss.oracle.com/licenses/upl/)"],"enabled":true,"result":{"startTime":1737662327170,"interpreter":"md.low","endTime":1737662327750,"results":[{"message":"<h1 id=\"run-me-first-spatial-ai-in-oracle-machine-learning-for-python-oml4py\">Run-me-first: Spatial AI in Oracle Machine Learning for Python (OML4Py)<\/h1>\n<p>Oracle Machine Learning for Python (OML4Py) makes the Python environment ready for the enterprise. OML4Py integrates Python with Oracle Autonomous Database, enabling the use of Python for machine learning and visualization from database tables and views. Spatial AI is a feature of OML4Py providing algorithms and APIs to analyze, make predictions, and detect patterns from geospatial data.<\/p>\n<p>In this notebook, you load data for use in other sample notebooks. Data are loaded and prepared from files stored in OCI Object Storage.<\/p>\n<p><strong>Copyright (c) 2025 Oracle Corporation<\/strong>\n<a href=\"https://oss.oracle.com/licenses/upl/\">The Universal Permissive License (UPL), Version 1.0<\/a><\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Import required libraries","message":["%python","","import pandas as pd","from oraclesai import PARObjStoreSpatialDataset, DBSpatialDataset, read, write","from oraclesai import enable_geodataframes","enable_geodataframes(z)"],"enabled":true,"result":{"startTime":1737662328307,"interpreter":"python.low","endTime":1737662331828,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Assign object storage PAR to a variable","message":["%python","","par_url = 'https://objectstorage.us-ashburn-1.oraclecloud.com/p/ko8wrcjVJJ78L9WbTKqYR67GoGfeUGVKPpg_lN1vXL5uBAZZaQBBilWuEMRqnQJh/n/ogcs/b/spatial_ai/o/'"," "],"enabled":true,"result":{"startTime":1737662332314,"interpreter":"python.low","endTime":1737662332814,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","##### Load traffic accident data","","The table will contain data about traffic crashes on city streets within the City of Chicago. The file is loaded from OCI Object Storage and was originally sourced from the [Chicago Data Portal](https://data.cityofchicago.org)."],"enabled":true,"result":{"startTime":1737662333314,"interpreter":"md.low","endTime":1737662333868,"results":[{"message":"<h5 id=\"load-traffic-accident-data\">Load traffic accident data<\/h5>\n<p>The table will contain data about traffic crashes on city streets within the City of Chicago. The file is loaded from OCI Object Storage and was originally sourced from the <a href=\"https://data.cityofchicago.org\">Chicago Data Portal<\/a>.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Create GeoDataFrame for traffic accident data","message":["%python","","gdf = read(PARObjStoreSpatialDataset(par_url, object_name='example_notebooks/chicago_accidents.zip')).to_crs('epsg:4326')","z.show(gdf.head())"],"enabled":true,"result":{"startTime":1737662334361,"interpreter":"python.low","endTime":1737662340389,"results":[{"message":"OGR_FID\tX\tY\tREPORT_TYP\tCRASH_TYPE\tPRIM_CONTR\tDAMAGE\tNUM_UNITS\tDAMAGE_RATING\tINJURY_RATING\tYYYY\tMM\tDD\tgeometry\n205\t-9764007.805\t5159947.68\tNOT ON SCENE (DESK REPORT)\tNO INJURY / DRIVE AWAY\tFAILING TO YIELD RIGHT-OF-WAY\tOVER $1,500\t2\t3\t0\t2022\t11\t19\tPOINT (-87.712 41.993)\n207\t-9762842.411\t5143294.991\tON SCENE\tNO INJURY / DRIVE AWAY\tDRIVING ON WRONG SIDE/WRONG WAY\tOVER $1,500\t2\t3\t0\t2022\t11\t19\tPOINT (-87.701 41.882)\n235\t-9768549.625\t5153978.595\tON SCENE\tINJURY AND / OR TOW DUE TO CRASH\tFAILING TO REDUCE SPEED TO AVOID CRASH\tOVER $1,500\t3\t3\t2\t2022\t11\t19\tPOINT (-87.752 41.953)\n237\t-9767337.518\t5128923.74\tON SCENE\tINJURY AND / OR TOW DUE TO CRASH\tFAILING TO YIELD RIGHT-OF-WAY\tOVER $1,500\t2\t3\t0\t2022\t11\t19\tPOINT (-87.741 41.786)\n239\t-9767253.997\t5147445.025\tNOT ON SCENE (DESK REPORT)\tNO INJURY / DRIVE AWAY\tFOLLOWING TOO CLOSELY\t$500 OR LESS\t2\t1\t0\t2022\t11\t19\tPOINT (-87.741 41.91)\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Write GeoDataFrame to table","message":["%python"," ","write(gdf, DBSpatialDataset(table='chicago_accidents'), if_exists='replace', create_spatial_index=True) ","del gdf "],"enabled":true,"result":{"startTime":1737662340921,"interpreter":"python.low","endTime":1737662356548,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Count table rows","message":["%sql","","select count(*) from chicago_accidents;"," "],"enabled":true,"result":{"startTime":1737662357072,"interpreter":"sql.low","endTime":1737662359088,"results":[{"message":"COUNT(*)\n47798\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","##### Load demographics data","","Create a GeoDataFrame from a zipped GeoJSON file containing data about demographics within the City of Los Angeles. The file is loaded from OCI Object Storage and was originally sourced from the [US Census Bureau](https://www.census.gov/data.html)."],"enabled":true,"result":{"startTime":1737662359641,"interpreter":"md.low","endTime":1737662360132,"results":[{"message":"<h5 id=\"load-demographics-data\">Load demographics data<\/h5>\n<p>Create a GeoDataFrame from a zipped GeoJSON file containing data about demographics within the City of Los Angeles. The file is loaded from OCI Object Storage and was originally sourced from the <a href=\"https://www.census.gov/data.html\">US Census Bureau<\/a>.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Create GeoDataFrame for demographics data","message":["%python","","gdf = read(PARObjStoreSpatialDataset(par_url, object_name='example_notebooks/income_census_la.zip')).to_crs('epsg:4326')","z.show(gdf.head())"],"enabled":true,"result":{"startTime":1737662360742,"interpreter":"python.low","endTime":1737662363731,"results":[{"message":"GEOID\tc_lon\tc_lat\tmean_income\tmedian_income\tmean_education_level\tmean_age\tper_male\tper_female\tlan_en\tlan_es\tlan_ie\tlan_ap\tlan_ol\tcomputer\tinternet\thouse_value\tind_aggr\tind_constr\tind_manu\tind_retail\tind_transp\tind_info\tind_finan\tind_edu\tind_health\tind_enter\tind_padmin\tgeometry\n060373104003\t-118.34\t34.204\t66311.004\t45434.0\t10.977\t42.421\t0.466\t0.534\t0.848\t0.116\t0.184\t0.05\t0.085\t0.901\t0.874\t597800.0\t0.0\t0.047\t0.103\t0.102\t0.035\t0.128\t0.083\t0.058\t0.039\t0.076\t0.034\tPOLYGON ((-118.35 34.207, -118.343 34.207, -118.341 34.207, -118.34 34.206, -118.339 34.206, -118.334 34.206, -118.334 34.203, -118.335 34.203, -118.335 34.199, -118.338 34.2, -118.339 34.199, -118.349 34.206, -118.35 34.207, -118.35 34.207))\n060376510024\t-118.324\t33.808\t121099.764\t133672.0\t10.813\t38.939\t0.561\t0.439\t0.81\t0.211\t0.007\t0.273\t0.0\t0.976\t0.949\t756100.0\t0.008\t0.055\t0.212\t0.075\t0.037\t0.02\t0.033\t0.06\t0.125\t0.092\t0.028\tPOLYGON ((-118.328 33.81, -118.32 33.81, -118.32 33.808, -118.32 33.808, -118.32 33.807, -118.328 33.807, -118.328 33.81))\n060376511011\t-118.333\t33.818\t118194.268\t103688.0\t11.557\t43.086\t0.482\t0.518\t0.887\t0.042\t0.056\t0.189\t0.022\t0.958\t0.941\t845400.0\t0.006\t0.023\t0.168\t0.144\t0.05\t0.059\t0.086\t0.124\t0.097\t0.025\t0.026\tPOLYGON ((-118.34 33.824, -118.328 33.822, -118.328 33.82, -118.328 33.817, -118.328 33.813, -118.331 33.813, -118.337 33.815, -118.337 33.822, -118.34 33.822, -118.34 33.824))\n060376511012\t-118.338\t33.808\t94055.787\t81891.0\t11.729\t39.578\t0.467\t0.533\t0.805\t0.093\t0.043\t0.322\t0.012\t0.835\t0.828\t799900.0\t0.0\t0.025\t0.15\t0.122\t0.071\t0.038\t0.088\t0.113\t0.061\t0.054\t0.029\tPOLYGON ((-118.351 33.816, -118.348 33.815, -118.348 33.818, -118.343 33.819, -118.341 33.818, -118.341 33.819, -118.34 33.822, -118.337 33.822, -118.337 33.815, -118.331 33.813, -118.328 33.813, -118.328 33.81, -118.328 33.807, -118.328 33.806, -118.328 33.803, -118.326 33.803, -118.326 33.801, -118.328 33.801, -118.328 33.798, -118.328 33.79, -118.326 33.79, -118.328 33.79, -118.329 33.79, -118.329 33.79, -118.33 33.79, -118.333 33.792, -118.337 33.795, -118.344 33.801, -118.348 33.804, -118.351 33.805, -118.351 33.816))\n060376512011\t-118.361\t33.822\t144310.509\t130221.0\t11.893\t46.619\t0.499\t0.501\t0.992\t0.013\t0.053\t0.061\t0.043\t0.965\t0.965\t837900.0\t0.0\t0.114\t0.149\t0.109\t0.057\t0.059\t0.062\t0.069\t0.161\t0.052\t0.028\tPOLYGON ((-118.372 33.816, -118.369 33.814, -118.362 33.817, -118.362 33.819, -118.363 33.82, -118.362 33.822, -118.362 33.826, -118.36 33.826, -118.36 33.826, -118.36 33.82, -118.36 33.817, -118.361 33.817, -118.37 33.813, -118.371 33.814, -118.373 33.815, -118.372 33.816))\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Write GeoDataFrame to table","message":["%python","","write(gdf, DBSpatialDataset(table='la_block_groups'), if_exists='replace', create_spatial_index=True) ","del gdf"],"enabled":true,"result":{"startTime":1737662364264,"interpreter":"python.low","endTime":1737662367506,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Count table rows","message":["%sql","","select count(*) from la_block_groups;"],"enabled":true,"result":{"startTime":1737662368116,"interpreter":"sql.low","endTime":1737662368675,"results":[{"message":"COUNT(*)\n3437\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","##### Load house value data","","Create a GeoDataFrame from a zipped GeoJSON file containing data about home values within the City of Los Angeles. The file is loaded from OCI Object Storage and was originally sourced from the [US Census Bureau](https://www.census.gov/data.html)"," "],"enabled":true,"result":{"startTime":1737662369204,"interpreter":"md.low","endTime":1737662369748,"results":[{"message":"<h5 id=\"load-house-value-data\">Load house value data<\/h5>\n<p>Create a GeoDataFrame from a zipped GeoJSON file containing data about home values within the City of Los Angeles. The file is loaded from OCI Object Storage and was originally sourced from the <a href=\"https://www.census.gov/data.html\">US Census Bureau<\/a><\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Create GeoDataFrame for house value data","message":["%python","","gdf = read(PARObjStoreSpatialDataset(par_url, object_name='example_notebooks/median_house_values_la.zip')).to_crs('epsg:4326')","z.show(gdf.head())"],"enabled":true,"result":{"startTime":1737662370270,"interpreter":"python.low","endTime":1737662374636,"results":[{"message":"geoid\thouse_value_median\tbedrooms_median\tbedrooms_total\tcomplete_kitchen_perc\tcomplete_plumbing_perc\tedu_level_score_median\thouse_age_median\tpopulation_density\tpopulation_total\trented_perc\trooms_median\trooms_total\tunits_mean\tunits_median\tunits_total\tyears_built_median\tgeometry\n060371044041\t453400.0\t2.0\t918\t1.0\t1.0\t15.0\t60.0\t0.883\t1781.0\t0.499\t4.8\t1891\t1.906\t1.0\t756.5\t1954.0\tPOLYGON ((-118.43 34.265, -118.425 34.269, -118.422 34.266, -118.426 34.264, -118.427 34.262, -118.43 34.265))\n060371249032\t590300.0\t2.0\t1041\t0.986\t1.0\t18.0\t46.0\t0.337\t1166.0\t0.731\t4.0\t2457\t13.645\t14.5\t7955.0\t1968.0\tPOLYGON ((-118.4 34.168, -118.397 34.168, -118.396 34.165, -118.4 34.165, -118.4 34.168))\n060371047032\t447700.0\t2.0\t582\t0.881\t0.895\t15.0\t58.0\t0.961\t1226.0\t0.39\t4.5\t1150\t2.546\t1.0\t748.5\t1956.0\tPOLYGON ((-118.405 34.257, -118.404 34.258, -118.401 34.255, -118.406 34.251, -118.403 34.249, -118.403 34.248, -118.409 34.254, -118.405 34.257))\n060371047041\t423100.0\t3.0\t1497\t0.953\t1.0\t17.0\t37.0\t2.354\t1640.0\t0.234\t5.9\t2928\t6.749\t1.0\t3455.5\t1977.0\tPOLYGON ((-118.413 34.262, -118.411 34.267, -118.409 34.267, -118.407 34.266, -118.405 34.268, -118.402 34.265, -118.403 34.259, -118.404 34.259, -118.404 34.258, -118.405 34.257, -118.409 34.261, -118.412 34.261, -118.413 34.262))\n060371048212\t440500.0\t3.0\t531\t0.94\t0.94\t15.0\t57.0\t0.588\t871.0\t0.527\t4.8\t948\t7.658\t1.0\t1531.5\t1957.0\tPOLYGON ((-118.423 34.25, -118.419 34.252, -118.416 34.249, -118.42 34.247, -118.423 34.25))\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Write GeoDataFrame to table","message":["%python","","write(gdf, DBSpatialDataset(table='la_median_house_values'), if_exists='replace', create_spatial_index=True) ","del gdf"],"enabled":true,"result":{"startTime":1737662375126,"interpreter":"python.low","endTime":1737662379449,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Count table rows","message":["%sql","","select count(*) from la_median_house_values;"," "],"enabled":true,"result":{"startTime":1737662379946,"interpreter":"sql.low","endTime":1737662380498,"results":[{"message":"COUNT(*)\n5702\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","##### Load schools data","","Create a GeoDataFrame from a zipped GeoJSON file containing data about schools within the City of Los Angeles. The file is loaded from OCI Object Storage and was originally sourced from [OpenStreetMap](https://www.openstreetmap.org)."],"enabled":true,"result":{"startTime":1737662381017,"interpreter":"md.low","endTime":1737662381503,"results":[{"message":"<h5 id=\"load-schools-data\">Load schools data<\/h5>\n<p>Create a GeoDataFrame from a zipped GeoJSON file containing data about schools within the City of Los Angeles. The file is loaded from OCI Object Storage and was originally sourced from <a href=\"https://www.openstreetmap.org\">OpenStreetMap<\/a>.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Create GeoDataFrame for schools data","message":["%python","","gdf = read(PARObjStoreSpatialDataset(par_url, object_name='example_notebooks/osm_edu_nodes_la.json')).to_crs('epsg:4326')","z.show(gdf.head())"],"enabled":true,"result":{"startTime":1737662586720,"interpreter":"python.low","endTime":1737662587598,"results":[{"message":"id\ttags\tgeometry\n358779437\t{'amenity': 'school', 'ele': '30', 'gnis:county_id': '037', 'gnis:created': '06/14/2000', 'gnis:feature_id': '238414', 'gnis:state_id': '06', 'name': 'John Adams Elementary School'}\tPOINT (-118.318 33.809)\n358779446\t{'amenity': 'school', 'ele': '19', 'gnis:county_id': '037', 'gnis:created': '06/14/2000', 'gnis:feature_id': '238417', 'gnis:state_id': '06', 'name': 'Jane Addams Elementary School'}\tPOINT (-118.356 33.893)\n358779518\t{'amenity': 'school', 'ele': '167', 'gnis:county_id': '037', 'gnis:created': '06/14/2000', 'gnis:feature_id': '238488', 'gnis:state_id': '06', 'name': 'Aldama Elementary School', 'operator': 'Los Angeles Unified School District'}\tPOINT (-118.206 34.11)\n358779550\t{'amenity': 'school', 'ele': '158', 'gnis:county_id': '037', 'gnis:created': '01/19/1981', 'gnis:feature_id': '238526', 'gnis:state_id': '06', 'name': 'All Saints School'}\tPOINT (-118.172 34.086)\n358779618\t{'amenity': 'school', 'ele': '52', 'gnis:county_id': '037', 'gnis:created': '06/14/2000', 'gnis:feature_id': '238557', 'gnis:state_id': '06', 'name': 'Alta Loma Elementary School'}\tPOINT (-118.338 34.043)\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Convert selected JSON tags to columns","message":["%python","","gdf[['amenity', 'name']] = gdf.tags.apply(lambda tags: pd.Series([tags.get('amenity', None), tags.get('name', None)]))","gdf = gdf.dropna()","gdf = gdf[gdf['amenity']=='school'][['id', 'geometry', 'name']]","z.show(gdf.head())",""," "],"enabled":true,"result":{"startTime":1737662631225,"interpreter":"python.low","endTime":1737662631886,"results":[{"message":"id\tname\tgeometry\n358779437\tJohn Adams Elementary School\tPOINT (-118.318 33.809)\n358779446\tJane Addams Elementary School\tPOINT (-118.356 33.893)\n358779518\tAldama Elementary School\tPOINT (-118.206 34.11)\n358779550\tAll Saints School\tPOINT (-118.172 34.086)\n358779618\tAlta Loma Elementary School\tPOINT (-118.338 34.043)\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Write GeoDataFrame to table","message":["%python","","write(gdf, DBSpatialDataset(table='schools'), if_exists='replace', create_spatial_index=True) ","del gdf"," "],"enabled":true,"result":{"startTime":1737662644896,"interpreter":"python.low","endTime":1737662646603,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Count table rows","message":["%sql"," ","select count(*) from schools;"],"enabled":true,"result":{"startTime":1737662713842,"interpreter":"sql.low","endTime":1737662714320,"results":[{"message":"COUNT(*)\n702\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","## End of Script"],"enabled":true,"result":{"startTime":1737662388900,"interpreter":"md.low","endTime":1737662389366,"results":[{"message":"<h2 id=\"end-of-script\">End of Script<\/h2>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"}],"version":"6","snapshot":false,"tags":null}]