[{"layout":"zeppelin","template":null,"templateConfig":null,"name":"OML4Py Anomaly Detection SVM","description":null,"readOnly":false,"type":"medium","paragraphs":[{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":null,"message":[],"enabled":true,"result":{"startTime":1718666566541,"interpreter":"md.medium","endTime":1718666566598,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":0,"hideResult":true,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","# Detect Unusual or Rare Occurrences using SVM Anomaly Detection","Oracle Machine Learning supports anomaly detection to identify rare or unusual records (customers, transactions, etc.) in your data using the semi-supervised learning algorithm One-Class Support Vector Machine. In this notebook, you will build a One-Class SVM model and then use it to flag unusual or suspicious records. The data used in this example is from the SH schema. The entire machine learning methodology runs inside Oracle Autonomous Database (ADB).","","","Copyright (c) 2025 Oracle Corporation ","###### <a href=\"https://oss.oracle.com/licenses/upl/\" target=\"_blank\">The Universal Permissive License (UPL), Version 1.0<\/a>","---"],"enabled":true,"result":{"startTime":1737148324149,"interpreter":"md.medium","endTime":1737148324600,"results":[{"message":"<h1 id=\"detect-unusual-or-rare-occurrences-using-svm-anomaly-detection\">Detect Unusual or Rare Occurrences using SVM Anomaly Detection<\/h1>\n<p>Oracle Machine Learning supports anomaly detection to identify rare or unusual records (customers, transactions, etc.) in your data using the semi-supervised learning algorithm One-Class Support Vector Machine. In this notebook, you will build a One-Class SVM model and then use it to flag unusual or suspicious records. The data used in this example is from the SH schema. The entire machine learning methodology runs inside Oracle Autonomous Database (ADB).<\/p>\n<p>Copyright (c) 2025 Oracle Corporation<\/p>\n<h6 id=\"the-universal-permissive-license-upl-version-10\"><a href=\"https://oss.oracle.com/licenses/upl/\" target=\"_blank\">The Universal Permissive License (UPL), Version 1.0<\/a><\/h6>\n<hr />\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":9,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md \r","<dl>\r","<img src=\"https://www.oracle.com/technetwork/database/options/advanced-analytics/anomalydetection-5663169.jpg\" alt=\"OML Notebooks\" width=\"250\"/>\r","<\/dl>"],"enabled":true,"result":{"startTime":1737148302201,"interpreter":"md.medium","endTime":1737148302762,"results":[{"message":"<dl>\n<img src=\"https://www.oracle.com/technetwork/database/options/advanced-analytics/anomalydetection-5663169.jpg\" alt=\"OML Notebooks\" width=\"250\"/>\n<\/dl>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":3,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"For more information...","message":["%md","","* <a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a>","* <a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a>","* <a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a>","* <a href=\"https://www.oracle.com/goto/ml-classification\" target=\"_blank\">OML Classification<\/a>","* <a href=\"https://oracle.com/goto/ml-support-vector-machine\" target=\"_blank\">OML Support Vector Machine<\/a>"],"enabled":true,"result":{"startTime":1737148386586,"interpreter":"md.medium","endTime":1737148387062,"results":[{"message":"<ul>\n<li><a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a><\/li>\n<li><a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a><\/li>\n<li><a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a><\/li>\n<li><a href=\"https://www.oracle.com/goto/ml-classification\" target=\"_blank\">OML Classification<\/a><\/li>\n<li><a href=\"https://oracle.com/goto/ml-support-vector-machine\" target=\"_blank\">OML Support Vector Machine<\/a><\/li>\n<\/ul>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Import libraries and set display options","message":["%python","","import pandas as pd","import oml","import warnings","","pd.set_option('display.max_rows', 500)","pd.set_option('display.max_columns', 500)","pd.set_option('display.width', 1000)","","warnings.simplefilter(action='ignore', category=FutureWarning)"],"enabled":true,"result":{"startTime":1737148387540,"interpreter":"python.medium","endTime":1737148390052,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":4,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Create OML Data Frames for tables CUSTOMERS and SUPPLEMENTARY_DEMOGRAPHICS","message":["%python","","","CUSTOMERS = oml.sync(query = 'SELECT CUST_ID, CUST_GENDER, CUST_MARITAL_STATUS, CUST_YEAR_OF_BIRTH, CUST_INCOME_LEVEL, CUST_CREDIT_LIMIT FROM SH.CUSTOMERS')","SUPP_DEM  = oml.sync(query = 'SELECT CUST_ID, EDUCATION, AFFINITY_CARD, HOUSEHOLD_SIZE, OCCUPATION, YRS_RESIDENCE, Y_BOX_GAMES FROM SH.SUPPLEMENTARY_DEMOGRAPHICS')","","type(CUSTOMERS)"],"enabled":true,"result":{"startTime":1737148390533,"interpreter":"python.medium","endTime":1737148391426,"results":[{"message":"<class 'oml.core.frame.DataFrame'>\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":8,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Display a few rows from CUSTOMERS","message":["%python","","z.show(CUSTOMERS.head(10))"],"enabled":true,"result":{"startTime":1737148391902,"interpreter":"python.medium","endTime":1737148392635,"results":[{"message":"CUST_ID\tCUST_GENDER\tCUST_MARITAL_STATUS\tCUST_YEAR_OF_BIRTH\tCUST_INCOME_LEVEL\tCUST_CREDIT_LIMIT\n13350\tF\tNone\t1929\tC: 50,000 - 69,999\t11000\n16905\tF\tmarried\t1975\tC: 50,000 - 69,999\t1500\n20460\tF\tNone\t1976\tC: 50,000 - 69,999\t7000\n24016\tF\tNone\t1933\tC: 50,000 - 69,999\t9000\n27571\tF\tmarried\t1952\tC: 50,000 - 69,999\t1500\n31127\tF\tNone\t1925\tC: 50,000 - 69,999\t9000\n34683\tF\tNone\t1942\tC: 50,000 - 69,999\t9000\n39127\tF\tNone\t1946\tC: 50,000 - 69,999\t7000\n42682\tF\tNone\t1967\tC: 50,000 - 69,999\t9000\n20014\tF\tmarried\t1931\tC: 50,000 - 69,999\t1500\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Display a few rows from SUPP_DEM","message":["%python","","z.show(SUPP_DEM.head(10))"],"enabled":true,"result":{"startTime":1737148393104,"interpreter":"python.medium","endTime":1737148393763,"results":[{"message":"CUST_ID\tEDUCATION\tAFFINITY_CARD\tHOUSEHOLD_SIZE\tOCCUPATION\tYRS_RESIDENCE\tY_BOX_GAMES\n102547\t10th\t0\t1\tOther\t0\t1\n101050\t10th\t0\t1\tOther\t0\t1\n100040\t11th\t0\t1\tSales\t0\t1\n102117\tHS-grad\t0\t1\tFarming\t0\t1\n101074\t10th\t0\t1\tHandler\t1\t1\n104179\t10th\t0\t1\tHandler\t1\t1\n100417\t11th\t0\t1\tHandler\t1\t1\n101146\t< Bach.\t0\t1\t?\t1\t1\n103420\t< Bach.\t0\t1\t?\t1\t1\n101987\t< Bach.\t0\t1\tOther\t1\t1\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Merge (join) CUSTOMERS and SUPP_DEM OML proxy objects on CUST_ID column ","message":["%python","","CUST_DF = CUSTOMERS.merge(SUPP_DEM, how = \"inner\", on = 'CUST_ID',suffixes = [\"\",\"\"])"],"enabled":true,"result":{"startTime":1737148394246,"interpreter":"python.medium","endTime":1737148394719,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Display a few rows of CUST_DF","message":["%python","","z.show(CUST_DF.head(10))"],"enabled":true,"result":{"startTime":1737148395185,"interpreter":"python.medium","endTime":1737148395799,"results":[{"message":"CUST_ID\tCUST_GENDER\tCUST_MARITAL_STATUS\tCUST_YEAR_OF_BIRTH\tCUST_INCOME_LEVEL\tCUST_CREDIT_LIMIT\tEDUCATION\tAFFINITY_CARD\tHOUSEHOLD_SIZE\tOCCUPATION\tYRS_RESIDENCE\tY_BOX_GAMES\n103383\tM\tNeverM\t1976\tJ: 190,000 - 249,999\t11000\tHS-grad\t0\t1\tProtec.\t3\t1\n100924\tM\tNeverM\t1963\tJ: 190,000 - 249,999\t11000\tHS-grad\t0\t2\tCrafts\t4\t0\n102237\tM\tNeverM\t1975\tJ: 190,000 - 249,999\t11000\tProfsc\t0\t2\tProf.\t4\t1\n102078\tF\tNeverM\t1975\tJ: 190,000 - 249,999\t9000\tProfsc\t0\t2\tProf.\t6\t1\n104047\tM\tNeverM\t1983\tL: 300,000 and above\t7000\tHS-grad\t0\t1\tOther\t2\t1\n102510\tM\tMarried\t1956\tL: 300,000 and above\t15000\tAssoc-A\t1\t3\tProtec.\t5\t0\n100863\tM\tMarried\t1971\tL: 300,000 and above\t15000\tHS-grad\t0\t3\tCleric.\t3\t0\n103472\tM\tMarried\t1965\tE: 90,000 - 109,999\t3000\tBach.\t1\t3\tSales\t4\t0\n100799\tM\tNeverM\t1977\tG: 130,000 - 149,999\t7000\tHS-grad\t0\t1\tCrafts\t3\t1\n102248\tM\tMarried\t1962\tI: 170,000 - 189,999\t10000\t< Bach.\t1\t3\tCrafts\t4\t0\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":"[{\"table\":{\"version\":1},\"scatterplot\":{\"showSeriesX\":[\"mean(YRS_RESIDENCE)\"],\"lastColumns\":[\"CUST_YEAR_OF_BIRTH\",\"CUST_MARITAL_STATUS\",\"mean(YRS_RESIDENCE)\"],\"version\":1},\"pie\":{\"version\":1},\"line\":{\"version\":1},\"funnel\":{\"version\":1},\"bar\":{\"groupByColumns\":[\"CUST_MARITAL_STATUS\",\"CUST_YEAR_OF_BIRTH\"],\"showSeries\":[\"mean(YRS_RESIDENCE)\"],\"series\":{\"availableSeriesElements\":[{\"id\":\"mean(YRS_RESIDENCE)\",\"lineType\":\"straight\",\"borderColor\":\"rgb(25, 95, 116)\",\"borderWidth\":0,\"color\":\"rgb(25, 95, 116)\",\"pattern\":\"auto\",\"markerColor\":\"rgb(25, 95, 116)\",\"markerDisplayed\":\"auto\",\"markerShape\":\"auto\",\"markerSize\":0}]},\"lastColumns\":[\"CUST_YEAR_OF_BIRTH\",\"CUST_MARITAL_STATUS\",\"mean(YRS_RESIDENCE)\"],\"version\":1}}]","hideInIFrame":false,"selectedVisualization":"bar","title":"Visualize the distribution of birth date, marital status and years of residence ","message":["%python","","DF = CUST_DF","DF = DF.crosstab(['CUST_YEAR_OF_BIRTH', 'CUST_MARITAL_STATUS'], values = 'YRS_RESIDENCE', aggfunc= oml.DataFrame.mean)","z.show(DF.head(10))"],"enabled":true,"result":{"startTime":1737148396278,"interpreter":"python.medium","endTime":1737148397064,"results":[{"message":"CUST_YEAR_OF_BIRTH\tCUST_MARITAL_STATUS\tmean(YRS_RESIDENCE)\n1922\tDivorc.\t4.0\n1922\tWidowed\t1.0\n1923\tNeverM\t4.0\n1924\tMarried\t5.0\n1925\tWidowed\t10.0\n1926\tMabsent\t4.0\n1928\tMarried\t4.0\n1928\tWidowed\t4.8\n1929\tMarried\t6.333333333333333\n1929\tWidowed\t2.6666666666666665\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Build the Anomaly Detection Model","message":["%md","After dropping any previous model, specify settings: the outlier rate is the proportion of rows that should be flagged as outliers. Then, create the oml.svm python object indicating this is to be an anomaly detection model with the specified settings. Finally, invoke ***fit*** on the data with 'None' specified for the target. We explicitly provide a model name for future reference and the case id to uniquely identify rows. "],"enabled":true,"result":{"startTime":1737148397527,"interpreter":"md.medium","endTime":1737148397997,"results":[{"message":"<p>After dropping any previous model, specify settings: the outlier rate is the proportion of rows that should be flagged as outliers. Then, create the oml.svm python object indicating this is to be an anomaly detection model with the specified settings. Finally, invoke <em><strong>fit<\/strong><\/em> on the data with 'None' specified for the target. We explicitly provide a model name for future reference and the case id to uniquely identify rows.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":"[{\"raw\":{\"height\":300,\"lastColumns\":[],\"version\":1}}]","hideInIFrame":false,"selectedVisualization":"raw","title":"Build the SVM model using the defaults","message":["%python","","try:","    oml.drop(model=\"ANOMALY_DETECTION_MODEL1\")","except:","    pass","","odm_settings = {'svms_outlier_rate' : 0.01}","","svm_mod = oml.svm(\"anomaly_detection\", **odm_settings)","svm_mod.fit(CUST_DF, None, model_name = 'ANOMALY_DETECTION_MODEL1', case_id = 'CUST_ID')"],"enabled":true,"result":{"startTime":1737148398475,"interpreter":"python.medium","endTime":1737148402162,"results":[{"message":"\nModel Name: ANOMALY_DETECTION_MODEL1\n\nModel Owner: OMLUSER\n\nAlgorithm Name: Support Vector Machine\n\nMining Function: ANOMALY_DETECTION\n\nSettings: \n                   setting name                 setting value\n0                     ALGO_NAME  ALGO_SUPPORT_VECTOR_MACHINES\n1                  ODMS_DETAILS                   ODMS_ENABLE\n2  ODMS_MISSING_VALUE_TREATMENT       ODMS_MISSING_VALUE_AUTO\n3                 ODMS_SAMPLING         ODMS_SAMPLING_DISABLE\n4                     PREP_AUTO                            ON\n5           SVMS_CONV_TOLERANCE                         .0001\n6          SVMS_KERNEL_FUNCTION                   SVMS_LINEAR\n7             SVMS_OUTLIER_RATE                          0.01\n\nComputed Settings: \n             setting name    setting value\n0  SVMS_COMPLEXITY_FACTOR               10\n1     SVMS_NUM_ITERATIONS               30\n2             SVMS_SOLVER  SVMS_SOLVER_IPM\n\nGlobal Statistics: \n  attribute name attribute value\n0      CONVERGED             YES\n1     ITERATIONS              16\n2       NUM_ROWS            4500\n\nAttributes: \nAFFINITY_CARD\nCUST_CREDIT_LIMIT\nCUST_GENDER\nCUST_INCOME_LEVEL\nCUST_MARITAL_STATUS\nCUST_YEAR_OF_BIRTH\nEDUCATION\nHOUSEHOLD_SIZE\nOCCUPATION\nYRS_RESIDENCE\nY_BOX_GAMES\n\nPartition: NO\n\nCOEFFICIENTS: \n\n    TARGET_VALUE       ATTRIBUTE_NAME ATTRIBUTE_SUBNAME       ATTRIBUTE_VALUE    COEF\n0              1        AFFINITY_CARD              None                  None  0.5645\n1              1    CUST_CREDIT_LIMIT              None                  None  0.9606\n2              1          CUST_GENDER              None                     F  1.0127\n3              1          CUST_GENDER              None                     M  1.1695\n4              1    CUST_INCOME_LEVEL              None       A: Below 30,000  0.0732\n5              1    CUST_INCOME_LEVEL              None    B: 30,000 - 49,999  0.1590\n6              1    CUST_INCOME_LEVEL              None    C: 50,000 - 69,999  0.1067\n7              1    CUST_INCOME_LEVEL              None    D: 70,000 - 89,999  0.0902\n8              1    CUST_INCOME_LEVEL              None   E: 90,000 - 109,999  0.1872\n9              1    CUST_INCOME_LEVEL              None  F: 110,000 - 129,999  0.2213\n10             1    CUST_INCOME_LEVEL              None  G: 130,000 - 149,999  0.1805\n11             1    CUST_INCOME_LEVEL              None  H: 150,000 - 169,999  0.2187\n12             1    CUST_INCOME_LEVEL              None  I: 170,000 - 189,999  0.2434\n13             1    CUST_INCOME_LEVEL              None  J: 190,000 - 249,999  0.3005\n14             1    CUST_INCOME_LEVEL              None  K: 250,000 - 299,999  0.1674\n15             1    CUST_INCOME_LEVEL              None  L: 300,000 and above  0.2339\n16             1  CUST_MARITAL_STATUS              None               Divorc.  0.4683\n17             1  CUST_MARITAL_STATUS              None               Mabsent  0.0607\n18             1  CUST_MARITAL_STATUS              None                Mar-AF  0.0025\n19             1  CUST_MARITAL_STATUS              None               Married  0.7758\n20             1  CUST_MARITAL_STATUS              None                NeverM  0.6492\n21             1  CUST_MARITAL_STATUS              None                Separ.  0.1099\n22             1  CUST_MARITAL_STATUS              None               Widowed  0.1158\n23             1   CUST_YEAR_OF_BIRTH              None                  None  1.5147\n24             1            EDUCATION              None                  10th  0.0861\n25             1            EDUCATION              None                  11th  0.0894\n26             1            EDUCATION              None                  12th  0.0394\n27             1            EDUCATION              None               1st-4th  0.0125\n28             1            EDUCATION              None               5th-6th  0.0293\n29             1            EDUCATION              None               7th-8th  0.0679\n30             1            EDUCATION              None                   9th  0.0598\n31             1            EDUCATION              None               < Bach.  0.4503\n32             1            EDUCATION              None               Assoc-A  0.1148\n33             1            EDUCATION              None               Assoc-V  0.1374\n34             1            EDUCATION              None                 Bach.  0.3364\n35             1            EDUCATION              None               HS-grad  0.5553\n36             1            EDUCATION              None               Masters  0.1206\n37             1            EDUCATION              None                   PhD  0.0291\n38             1            EDUCATION              None               Presch.  0.0025\n39             1            EDUCATION              None                Profsc  0.0515\n40             1       HOUSEHOLD_SIZE              None                     1  0.3351\n41             1       HOUSEHOLD_SIZE              None                     2  0.5915\n42             1       HOUSEHOLD_SIZE              None                     3  0.6005\n43             1       HOUSEHOLD_SIZE              None                   4-5  0.1649\n44             1       HOUSEHOLD_SIZE              None                   6-8  0.0999\n45             1       HOUSEHOLD_SIZE              None                    9+  0.3904\n46             1           OCCUPATION              None                     ?  0.1502\n47             1           OCCUPATION              None               Armed-F  0.0016\n48             1           OCCUPATION              None               Cleric.  0.2684\n49             1           OCCUPATION              None                Crafts  0.2226\n50             1           OCCUPATION              None                 Exec.  0.2402\n51             1           OCCUPATION              None               Farming  0.0761\n52             1           OCCUPATION              None               Handler  0.0896\n53             1           OCCUPATION              None               House-s  0.0152\n54             1           OCCUPATION              None               Machine  0.1431\n55             1           OCCUPATION              None                 Other  0.2398\n56             1           OCCUPATION              None                 Prof.  0.2754\n57             1           OCCUPATION              None               Protec.  0.0420\n58             1           OCCUPATION              None                 Sales  0.2278\n59             1           OCCUPATION              None               TechSup  0.1035\n60             1           OCCUPATION              None               Transp.  0.0866\n61             1        YRS_RESIDENCE              None                  None  0.8047\n62             1          Y_BOX_GAMES              None                  None  0.6311\n63             1                 None              None                  None -1.0000\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":"[{\"html\":{\"height\":400,\"lastColumns\":[]}}]","hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","### Examples of possible setting overrides for SVM ","","If the user does not override the default settings, then relevant settings are determined by the algorithm","","A complete list of settings can be found in the Documentation link:","","- Algorithm Settings: <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/2/mlugp/support-vector-machine.html\" target=\"_blank\">Support Vector Machine<\/a>","","- Shared Settings: <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/2/mlpug/shared-settings.html#GUID-2EFF3880-F2E2-4449-A8CC-2CF516DD096B\" target=\"_blank\">All algorithms<\/a>","","- Specify a row weight column ","> 'ODMS_ROW_WEIGHT_COLUMN_NAME' : '<row_weight_column_name>'; ","- Specify a missing value treatment method for the training data. This setting does not affect the scoring data. The default value is `ODMS_MISSING_VALUE_AUTO`.  The option `ODMS_MISSING_VALUE_MEAN_MODE` replaces missing values with the mean (numeric attributes) or the mode (categorical attributes) both at build time and apply time where appropriate. The option `ODMS_MISSING_VALUE_AUTO` performs different strategies for different algorithms.  When `ODMS_MISSING_VALUE_TREATMENT` is set to `ODMS_MISSING_VALUE_DELETE_ROW`, the rows in the training data that contain missing values are deleted. However, if you want to replicate this missing value treatment in the scoring data, then you must perform the transformation explicitly.","> 'ODMS_MISSING_VALUE_TREATMENT' : 'ODMS_MISSING_VALUE_AUTO';","- Switch between Kernel Types - Linear or Gaussian. By default the system uses the Linear Kernel. Options are: `SVMS_LINEAR` and `SVMS_GAUSSIAN`.  The linear kernel also is able to return the coefficients, while this is not available on the Gaussian","> 'SVMS_KERNEL_FUNCTION' : 'SVMS_LINEAR';","- Value of complexity factor for SVM algorithm (both classification and regression). Default value estimated from the data by the algorithm.","> 'SVMS_COMPLEXITY_FACTOR' : '0.1';","- Type of regularization that the SGD SVM solver uses (only available for linear SVM models). The default is system determined because it depends on the potential model size.  Options are: `SVMS_REGULARIZER_L1` and `SVMS_REGULARIZER_L2`. ","> 'SVMS_REGULARIZER' : 'SVMS_REGULARIZER_L1';","- Regularization setting for regression (Epsilon specifies the allowable residuals, or noise, in the data).     ","> 'SVMS_EPSILON' : '0.1';","- Batch rows sets the size of the batch for the SGD solver (linear kernel only). An input of 0 triggers a data driven batch size estimate. The default is 20,000. ","> 'SVMS_BATCH_ROWS' : '20000';","- Solver type, which cannot be selected if the kernel is non-linear. The default value is system determined. Options are:  `SVMS_SOLVER_SGD` and `SVMS_SOLVER_IPM`.  ","> 'SVMS_SOLVER' : 'SVMS_SOLVER_SGD';","- Specify the convergence tolerance for SVM algorithm. It requires a number larger than 0. Default is 0.0001. ","> 'SVMS_CONV_TOLERANCE': '0.001'","- Specify an upper limit on the number of pivots used in the Incomplete Cholesky decomposition. It can be set only for non-linear kernels. It requires a value from a range of 1 to 10,000 (inclusive of the edges). The default value is 200.     ","> 'SVMS_NUM_PIVOTS': '200' "],"enabled":true,"result":{"startTime":1737148544569,"interpreter":"md.medium","endTime":1737148545011,"results":[{"message":"<h3 id=\"examples-of-possible-setting-overrides-for-svm\">Examples of possible setting overrides for SVM<\/h3>\n<p>If the user does not override the default settings, then relevant settings are determined by the algorithm<\/p>\n<p>A complete list of settings can be found in the Documentation link:<\/p>\n<ul>\n<li>\n<p>Algorithm Settings: <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/2/mlugp/support-vector-machine.html\" target=\"_blank\">Support Vector Machine<\/a><\/p>\n<\/li>\n<li>\n<p>Shared Settings: <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/2/mlpug/shared-settings.html#GUID-2EFF3880-F2E2-4449-A8CC-2CF516DD096B\" target=\"_blank\">All algorithms<\/a><\/p>\n<\/li>\n<li>\n<p>Specify a row weight column<\/p>\n<\/li>\n<\/ul>\n<blockquote>\n<p>'ODMS_ROW_WEIGHT_COLUMN_NAME' : '&lt;row_weight_column_name&gt;';<\/p>\n<\/blockquote>\n<ul>\n<li>Specify a missing value treatment method for the training data. This setting does not affect the scoring data. The default value is <code>ODMS_MISSING_VALUE_AUTO<\/code>.  The option <code>ODMS_MISSING_VALUE_MEAN_MODE<\/code> replaces missing values with the mean (numeric attributes) or the mode (categorical attributes) both at build time and apply time where appropriate. The option <code>ODMS_MISSING_VALUE_AUTO<\/code> performs different strategies for different algorithms.  When <code>ODMS_MISSING_VALUE_TREATMENT<\/code> is set to <code>ODMS_MISSING_VALUE_DELETE_ROW<\/code>, the rows in the training data that contain missing values are deleted. However, if you want to replicate this missing value treatment in the scoring data, then you must perform the transformation explicitly.<\/li>\n<\/ul>\n<blockquote>\n<p>'ODMS_MISSING_VALUE_TREATMENT' : 'ODMS_MISSING_VALUE_AUTO';<\/p>\n<\/blockquote>\n<ul>\n<li>Switch between Kernel Types - Linear or Gaussian. By default the system uses the Linear Kernel. Options are: <code>SVMS_LINEAR<\/code> and <code>SVMS_GAUSSIAN<\/code>.  The linear kernel also is able to return the coefficients, while this is not available on the Gaussian<\/li>\n<\/ul>\n<blockquote>\n<p>'SVMS_KERNEL_FUNCTION' : 'SVMS_LINEAR';<\/p>\n<\/blockquote>\n<ul>\n<li>Value of complexity factor for SVM algorithm (both classification and regression). Default value estimated from the data by the algorithm.<\/li>\n<\/ul>\n<blockquote>\n<p>'SVMS_COMPLEXITY_FACTOR' : '0.1';<\/p>\n<\/blockquote>\n<ul>\n<li>Type of regularization that the SGD SVM solver uses (only available for linear SVM models). The default is system determined because it depends on the potential model size.  Options are: <code>SVMS_REGULARIZER_L1<\/code> and <code>SVMS_REGULARIZER_L2<\/code>.<\/li>\n<\/ul>\n<blockquote>\n<p>'SVMS_REGULARIZER' : 'SVMS_REGULARIZER_L1';<\/p>\n<\/blockquote>\n<ul>\n<li>Regularization setting for regression (Epsilon specifies the allowable residuals, or noise, in the data).<\/li>\n<\/ul>\n<blockquote>\n<p>'SVMS_EPSILON' : '0.1';<\/p>\n<\/blockquote>\n<ul>\n<li>Batch rows sets the size of the batch for the SGD solver (linear kernel only). An input of 0 triggers a data driven batch size estimate. The default is 20,000.<\/li>\n<\/ul>\n<blockquote>\n<p>'SVMS_BATCH_ROWS' : '20000';<\/p>\n<\/blockquote>\n<ul>\n<li>Solver type, which cannot be selected if the kernel is non-linear. The default value is system determined. Options are:  <code>SVMS_SOLVER_SGD<\/code> and <code>SVMS_SOLVER_IPM<\/code>.<\/li>\n<\/ul>\n<blockquote>\n<p>'SVMS_SOLVER' : 'SVMS_SOLVER_SGD';<\/p>\n<\/blockquote>\n<ul>\n<li>Specify the convergence tolerance for SVM algorithm. It requires a number larger than 0. Default is 0.0001.<\/li>\n<\/ul>\n<blockquote>\n<p>'SVMS_CONV_TOLERANCE': '0.001'<\/p>\n<\/blockquote>\n<ul>\n<li>Specify an upper limit on the number of pivots used in the Incomplete Cholesky decomposition. It can be set only for non-linear kernels. It requires a value from a range of 1 to 10,000 (inclusive of the edges). The default value is 200.<\/li>\n<\/ul>\n<blockquote>\n<p>'SVMS_NUM_PIVOTS': '200'<\/p>\n<\/blockquote>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":"[{\"raw\":{\"height\":300,\"lastColumns\":[],\"version\":1}}]","hideInIFrame":false,"selectedVisualization":"raw","title":"Build the SVM model using the specific settings","message":["%python","","try:","    oml.drop(model=\"ANOMALY_DETECTION_MODEL1\")","except:","    pass","","odm_settings = {'SVMS_OUTLIER_RATE'  : '0.01',","                'SVMS_REGULARIZER'   : 'SVMS_REGULARIZER_L1',","                'SVMS_CONV_TOLERANCE': '0.001'","                }","","svm_mod = oml.svm(\"anomaly_detection\", **odm_settings)","svm_mod.fit(CUST_DF, None, model_name = 'ANOMALY_DETECTION_MODEL1', case_id = 'CUST_ID')"],"enabled":true,"result":{"startTime":1737148403553,"interpreter":"python.medium","endTime":1737148406331,"results":[{"message":"\nModel Name: ANOMALY_DETECTION_MODEL1\n\nModel Owner: OMLUSER\n\nAlgorithm Name: Support Vector Machine\n\nMining Function: ANOMALY_DETECTION\n\nSettings: \n                   setting name                 setting value\n0                     ALGO_NAME  ALGO_SUPPORT_VECTOR_MACHINES\n1                  ODMS_DETAILS                   ODMS_ENABLE\n2  ODMS_MISSING_VALUE_TREATMENT       ODMS_MISSING_VALUE_AUTO\n3                 ODMS_SAMPLING         ODMS_SAMPLING_DISABLE\n4                     PREP_AUTO                            ON\n5           SVMS_CONV_TOLERANCE                         0.001\n6          SVMS_KERNEL_FUNCTION                   SVMS_LINEAR\n7             SVMS_OUTLIER_RATE                          0.01\n8              SVMS_REGULARIZER           SVMS_REGULARIZER_L1\n\nComputed Settings: \n             setting name    setting value\n0  SVMS_COMPLEXITY_FACTOR               10\n1     SVMS_NUM_ITERATIONS               30\n2             SVMS_SOLVER  SVMS_SOLVER_IPM\n\nGlobal Statistics: \n  attribute name attribute value\n0      CONVERGED             YES\n1     ITERATIONS              14\n2       NUM_ROWS            4500\n\nAttributes: \nAFFINITY_CARD\nCUST_CREDIT_LIMIT\nCUST_GENDER\nCUST_INCOME_LEVEL\nCUST_MARITAL_STATUS\nCUST_YEAR_OF_BIRTH\nEDUCATION\nHOUSEHOLD_SIZE\nOCCUPATION\nYRS_RESIDENCE\nY_BOX_GAMES\n\nPartition: NO\n\nCOEFFICIENTS: \n\n    TARGET_VALUE       ATTRIBUTE_NAME ATTRIBUTE_SUBNAME       ATTRIBUTE_VALUE    COEF\n0              1        AFFINITY_CARD              None                  None  0.5644\n1              1    CUST_CREDIT_LIMIT              None                  None  0.9607\n2              1          CUST_GENDER              None                     F  1.0127\n3              1          CUST_GENDER              None                     M  1.1695\n4              1    CUST_INCOME_LEVEL              None       A: Below 30,000  0.0732\n5              1    CUST_INCOME_LEVEL              None    B: 30,000 - 49,999  0.1590\n6              1    CUST_INCOME_LEVEL              None    C: 50,000 - 69,999  0.1067\n7              1    CUST_INCOME_LEVEL              None    D: 70,000 - 89,999  0.0903\n8              1    CUST_INCOME_LEVEL              None   E: 90,000 - 109,999  0.1872\n9              1    CUST_INCOME_LEVEL              None  F: 110,000 - 129,999  0.2211\n10             1    CUST_INCOME_LEVEL              None  G: 130,000 - 149,999  0.1805\n11             1    CUST_INCOME_LEVEL              None  H: 150,000 - 169,999  0.2187\n12             1    CUST_INCOME_LEVEL              None  I: 170,000 - 189,999  0.2435\n13             1    CUST_INCOME_LEVEL              None  J: 190,000 - 249,999  0.3007\n14             1    CUST_INCOME_LEVEL              None  K: 250,000 - 299,999  0.1674\n15             1    CUST_INCOME_LEVEL              None  L: 300,000 and above  0.2339\n16             1  CUST_MARITAL_STATUS              None               Divorc.  0.4682\n17             1  CUST_MARITAL_STATUS              None               Mabsent  0.0607\n18             1  CUST_MARITAL_STATUS              None                Mar-AF  0.0025\n19             1  CUST_MARITAL_STATUS              None               Married  0.7758\n20             1  CUST_MARITAL_STATUS              None                NeverM  0.6491\n21             1  CUST_MARITAL_STATUS              None                Separ.  0.1099\n22             1  CUST_MARITAL_STATUS              None               Widowed  0.1158\n23             1   CUST_YEAR_OF_BIRTH              None                  None  1.5147\n24             1            EDUCATION              None                  10th  0.0860\n25             1            EDUCATION              None                  11th  0.0894\n26             1            EDUCATION              None                  12th  0.0394\n27             1            EDUCATION              None               1st-4th  0.0125\n28             1            EDUCATION              None               5th-6th  0.0293\n29             1            EDUCATION              None               7th-8th  0.0679\n30             1            EDUCATION              None                   9th  0.0598\n31             1            EDUCATION              None               < Bach.  0.4502\n32             1            EDUCATION              None               Assoc-A  0.1148\n33             1            EDUCATION              None               Assoc-V  0.1374\n34             1            EDUCATION              None                 Bach.  0.3364\n35             1            EDUCATION              None               HS-grad  0.5554\n36             1            EDUCATION              None               Masters  0.1205\n37             1            EDUCATION              None                   PhD  0.0291\n38             1            EDUCATION              None               Presch.  0.0025\n39             1            EDUCATION              None                Profsc  0.0515\n40             1       HOUSEHOLD_SIZE              None                     1  0.3351\n41             1       HOUSEHOLD_SIZE              None                     2  0.5914\n42             1       HOUSEHOLD_SIZE              None                     3  0.6005\n43             1       HOUSEHOLD_SIZE              None                   4-5  0.1648\n44             1       HOUSEHOLD_SIZE              None                   6-8  0.1000\n45             1       HOUSEHOLD_SIZE              None                    9+  0.3904\n46             1           OCCUPATION              None                     ?  0.1501\n47             1           OCCUPATION              None               Armed-F  0.0016\n48             1           OCCUPATION              None               Cleric.  0.2684\n49             1           OCCUPATION              None                Crafts  0.2226\n50             1           OCCUPATION              None                 Exec.  0.2402\n51             1           OCCUPATION              None               Farming  0.0761\n52             1           OCCUPATION              None               Handler  0.0897\n53             1           OCCUPATION              None               House-s  0.0152\n54             1           OCCUPATION              None               Machine  0.1431\n55             1           OCCUPATION              None                 Other  0.2398\n56             1           OCCUPATION              None                 Prof.  0.2754\n57             1           OCCUPATION              None               Protec.  0.0420\n58             1           OCCUPATION              None                 Sales  0.2278\n59             1           OCCUPATION              None               TechSup  0.1035\n60             1           OCCUPATION              None               Transp.  0.0866\n61             1        YRS_RESIDENCE              None                  None  0.8046\n62             1          Y_BOX_GAMES              None                  None  0.6312\n63             1                 None              None                  None -1.0000\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Invoke predict() to score data for anomalies","message":["%python","","RES_DF = svm_mod.predict(CUST_DF, supplemental_cols = CUST_DF, proba = True)"],"enabled":true,"result":{"startTime":1737148406842,"interpreter":"python.medium","endTime":1737148407371,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Anomalies are indicated by PREDICTION = 0, display a few rows flagged as anomalies","message":["%python","","z.show(RES_DF[RES_DF['PREDICTION']==0][[\"PREDICTION\",\"PROBABILITY\"] + CUST_DF.columns].head())"],"enabled":true,"result":{"startTime":1737148407847,"interpreter":"python.medium","endTime":1737148408499,"results":[{"message":"PREDICTION\tPROBABILITY\tCUST_ID\tCUST_GENDER\tCUST_MARITAL_STATUS\tCUST_YEAR_OF_BIRTH\tCUST_INCOME_LEVEL\tCUST_CREDIT_LIMIT\tEDUCATION\tAFFINITY_CARD\tHOUSEHOLD_SIZE\tOCCUPATION\tYRS_RESIDENCE\tY_BOX_GAMES\n0\t0.5736932463708171\t102419\tF\tWidowed\t1940\tF: 110,000 - 129,999\t10000\t7th-8th\t0\t9+\tFarming\t2\t0\n0\t0.5576556568546509\t100930\tF\tWidowed\t1922\tF: 110,000 - 129,999\t5000\tBach.\t0\t2\tProf.\t0\t0\n0\t0.5444671787206659\t102922\tF\tWidowed\t1931\tE: 90,000 - 109,999\t1500\t< Bach.\t0\t2\tTechSup\t4\t0\n0\t0.5092856272191477\t102802\tF\tNeverM\t1939\tI: 170,000 - 189,999\t1500\tAssoc-A\t0\t6-8\tProf.\t5\t0\n0\t0.6276574931464398\t101434\tF\tWidowed\t1927\tD: 70,000 - 89,999\t3000\t7th-8th\t0\t2\tOther\t6\t0\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":"[{\"table\":{\"version\":1},\"bar\":{\"groupByColumns\":[\"CUST_MARITAL_STATUS\",\"Bin(PROBABILITY)\"],\"series\":{\"availableSeriesElements\":[{\"id\":\"count\",\"lineType\":\"straight\",\"borderColor\":\"rgb(25, 95, 116)\",\"borderWidth\":0,\"color\":\"rgb(25, 95, 116)\",\"pattern\":\"auto\",\"markerColor\":\"rgb(25, 95, 116)\",\"markerDisplayed\":\"auto\",\"markerShape\":\"auto\",\"markerSize\":0}]},\"lastColumns\":[\"Bin(PROBABILITY)\",\"CUST_MARITAL_STATUS\",\"count\"],\"version\":1}}]","hideInIFrame":false,"selectedVisualization":"bar","title":"Plot the frequency distribution of the anomaly probability brackets against marital status","message":["%python","","RES_DF = RES_DF.concat(RES_DF['PROBABILITY'].cut(10))","DF = RES_DF.crosstab(['Bin(PROBABILITY)', \"CUST_MARITAL_STATUS\"])","z.show(DF.sort_values('Bin(PROBABILITY)'))"],"enabled":true,"result":{"startTime":1737148408962,"interpreter":"python.medium","endTime":1737148409792,"results":[{"message":"Bin(PROBABILITY)\tCUST_MARITAL_STATUS\tcount\n(0.5, 0.546]\tDivorc.\t7\n(0.5, 0.546]\tMabsent\t4\n(0.5, 0.546]\tMar-AF\t1\n(0.5, 0.546]\tMarried\t3\n(0.5, 0.546]\tNeverM\t2\n(0.5, 0.546]\tSepar.\t6\n(0.5, 0.546]\tWidowed\t20\n(0.546, 0.592]\tDivorc.\t7\n(0.546, 0.592]\tMabsent\t11\n(0.546, 0.592]\tMar-AF\t2\n(0.546, 0.592]\tMarried\t3\n(0.546, 0.592]\tNeverM\t1\n(0.546, 0.592]\tSepar.\t18\n(0.546, 0.592]\tWidowed\t23\n(0.592, 0.637]\tDivorc.\t21\n(0.592, 0.637]\tMabsent\t8\n(0.592, 0.637]\tMarried\t3\n(0.592, 0.637]\tNeverM\t3\n(0.592, 0.637]\tSepar.\t13\n(0.592, 0.637]\tWidowed\t24\n(0.637, 0.683]\tDivorc.\t27\n(0.637, 0.683]\tMabsent\t11\n(0.637, 0.683]\tMarried\t13\n(0.637, 0.683]\tNeverM\t10\n(0.637, 0.683]\tSepar.\t11\n(0.637, 0.683]\tWidowed\t21\n(0.683, 0.728]\tDivorc.\t48\n(0.683, 0.728]\tMabsent\t12\n(0.683, 0.728]\tMarried\t30\n(0.683, 0.728]\tNeverM\t23\n(0.683, 0.728]\tSepar.\t13\n(0.683, 0.728]\tWidowed\t17\n(0.728, 0.774]\tDivorc.\t81\n(0.728, 0.774]\tMabsent\t10\n(0.728, 0.774]\tMarried\t66\n(0.728, 0.774]\tNeverM\t65\n(0.728, 0.774]\tSepar.\t34\n(0.728, 0.774]\tWidowed\t24\n(0.774, 0.819]\tDivorc.\t148\n(0.774, 0.819]\tMabsent\t13\n(0.774, 0.819]\tMarried\t168\n(0.774, 0.819]\tNeverM\t151\n(0.774, 0.819]\tSepar.\t21\n(0.774, 0.819]\tWidowed\t6\n(0.819, 0.865]\tDivorc.\t185\n(0.819, 0.865]\tMabsent\t3\n(0.819, 0.865]\tMarried\t413\n(0.819, 0.865]\tNeverM\t390\n(0.819, 0.865]\tSepar.\t18\n(0.819, 0.865]\tWidowed\t1\n(0.865, 0.911]\tDivorc.\t83\n(0.865, 0.911]\tMabsent\t3\n(0.865, 0.911]\tMarried\t770\n(0.865, 0.911]\tNeverM\t590\n(0.911, 0.956]\tDivorc.\t8\n(0.911, 0.956]\tMarried\t565\n(0.911, 0.956]\tNeverM\t268\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Display the top 5 most anomalous cases","message":["%python","","z.show(RES_DF[RES_DF['PREDICTION']==0][[\"PREDICTION\",\"PROBABILITY\", \"Bin(PROBABILITY)\"] + RES_DF.columns].sort_values('PROBABILITY', ascending = False).head(5))"],"enabled":true,"result":{"startTime":1737148410252,"interpreter":"python.medium","endTime":1737148411138,"results":[{"message":"PREDICTION\tPROBABILITY\tBin(PROBABILITY)\tCUST_ID\tCUST_GENDER\tCUST_MARITAL_STATUS\tCUST_YEAR_OF_BIRTH\tCUST_INCOME_LEVEL\tCUST_CREDIT_LIMIT\tEDUCATION\tAFFINITY_CARD\tHOUSEHOLD_SIZE\tOCCUPATION\tYRS_RESIDENCE\tY_BOX_GAMES\tPREDICTION\tPROBABILITY\tBin(PROBABILITY)\n0\t0.7574043635917386\t(0.728, 0.774]\t103154\tF\tWidowed\t1922\tF: 110,000 - 129,999\t1500\t9th\t0\t2\tHouse-s\t2\t0\t0\t0.7574043635917386\t(0.728, 0.774]\n0\t0.7574043635917386\t(0.728, 0.774]\t100199\tF\tWidowed\t1922\tF: 110,000 - 129,999\t1500\t9th\t0\t2\tHouse-s\t2\t0\t0\t0.7574043635917386\t(0.728, 0.774]\n0\t0.7331582224784821\t(0.728, 0.774]\t102948\tF\tWidowed\t1927\tE: 90,000 - 109,999\t1500\t10th\t0\t9+\tSales\t2\t0\t0\t0.7331582224784821\t(0.728, 0.774]\n0\t0.6680564238136353\t(0.637, 0.683]\t101137\tF\tWidowed\t1935\tH: 150,000 - 169,999\t1500\t10th\t0\t9+\tOther\t3\t0\t0\t0.6680564238136353\t(0.637, 0.683]\n0\t0.6559101468486637\t(0.637, 0.683]\t104359\tF\tWidowed\t1927\tD: 70,000 - 89,999\t1500\t7th-8th\t0\t2\tOther\t6\t0\t0\t0.6559101468486637\t(0.637, 0.683]\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"View Prediction Details using topN_attrs option in python","message":["%python","","RES_DF = svm_mod.predict(CUST_DF, supplemental_cols = CUST_DF[['CUST_ID']], proba = True, topN_attrs = True)","z.show(RES_DF.head())"],"enabled":true,"result":{"startTime":1737148411612,"interpreter":"python.medium","endTime":1737148450341,"results":[{"message":"CUST_ID\tPREDICTION\tPROBABILITY\tNAME_1\tVALUE_1\tWEIGHT_1\tNAME_2\tVALUE_2\tWEIGHT_2\tNAME_3\tVALUE_3\tWEIGHT_3\tNAME_4\tVALUE_4\tWEIGHT_4\tNAME_5\tVALUE_5\tWEIGHT_5\n100100\t1\t0.8080396719171986\tAFFINITY_CARD\t1\t.018\tCUST_CREDIT_LIMIT\t10000\t.016\tOCCUPATION\tProf.\t.01\tCUST_YEAR_OF_BIRTH\t1959\t-.014\tY_BOX_GAMES\t0\t-.024\n100200\t1\t0.9040083901000975\tCUST_YEAR_OF_BIRTH\t1983\t.024\tY_BOX_GAMES\t1\t.009\tCUST_CREDIT_LIMIT\t9000\t.004\tOCCUPATION\tOther\t.002\tCUST_INCOME_LEVEL\tL: 300,000 and above\t-.007\n100300\t1\t0.9103858239407895\tCUST_CREDIT_LIMIT\t10000\t.008\tOCCUPATION\tProf.\t.005\tAFFINITY_CARD\t1\t.005\tCUST_YEAR_OF_BIRTH\t1961\t-.004\tCUST_INCOME_LEVEL\tG: 130,000 - 149,999\t-.011\n100400\t1\t0.514862137600718\tYRS_RESIDENCE\t6\t.024\tCUST_CREDIT_LIMIT\t9000\t.016\tAFFINITY_CARD\t0\t-.032\tOCCUPATION\tTransp.\t-.045\tY_BOX_GAMES\t0\t-.046\n100500\t1\t0.9250604575932593\tCUST_YEAR_OF_BIRTH\t1983\t.019\tCUST_CREDIT_LIMIT\t15000\t.018\tY_BOX_GAMES\t1\t.007\tYRS_RESIDENCE\t2\t-.006\tCUST_INCOME_LEVEL\tH: 150,000 - 169,999\t-.006\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Materialize CUST_DF data frame into table CUSTOMER360_TAB","message":["%python","","try:","    oml.drop(table = 'CUSTOMERS360_TAB')","except:","    pass","_ = CUST_DF.materialize(table = 'CUSTOMERS360_TAB')"],"enabled":true,"result":{"startTime":1737148450804,"interpreter":"python.medium","endTime":1737148451832,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"View PREDICTION_DETAILS in SQL of top 3 attributes that explain factors leading to prediction","message":["%sql","","SELECT CUST_ID, "," RTRIM(TRIM(SUBSTR(OUTPRED.\"Attribute1\",17,100)),'rank=\"1\"/>') FIRST_ATTRIBUTE,"," RTRIM(TRIM(SUBSTR(OUTPRED.\"Attribute2\",17,100)),'rank=\"2\"/>') SECOND_ATTRIBUTE,"," RTRIM(TRIM(SUBSTR(OUTPRED.\"Attribute3\",17,100)),'rank=\"3\"/>') THIRD_ATTRIBUTE"," FROM (SELECT CUST_ID, PREDICTION_DETAILS(ANOMALY_DETECTION_MODEL1, '0' USING *) PREDICTION_DETAILS FROM CUSTOMERS360_TAB","       WHERE PREDICTION_PROBABILITY(ANOMALY_DETECTION_MODEL1, '0' USING *) > 0.50","       AND OCCUPATION = 'TechSup'","       ORDER BY CUST_ID) OUT,","       XMLTABLE('/Details'","                PASSING OUT.PREDICTION_DETAILS","                COLUMNS ","                \"Attribute1\" XMLType PATH 'Attribute[1]',","                \"Attribute2\" XMLType PATH 'Attribute[2]',","                \"Attribute3\" XMLType PATH 'Attribute[3]') ","       OUTPRED"],"enabled":true,"result":{"startTime":1737148452298,"interpreter":"sql.medium","endTime":1737148454285,"results":[{"message":"CUST_ID\tFIRST_ATTRIBUTE\tSECOND_ATTRIBUTE\tTHIRD_ATTRIBUTE\n100646\t\"CUST_MARITAL_STATUS\" actualValue=\"Widowed\" weight=\".226\" \t\"CUST_YEAR_OF_BIRTH\" actualValue=\"1941\" weight=\".118\" \t\"CUST_CREDIT_LIMIT\" actualValue=\"1500\" weight=\".115\" \n102922\t\"CUST_MARITAL_STATUS\" actualValue=\"Widowed\" weight=\".223\" \t\"CUST_YEAR_OF_BIRTH\" actualValue=\"1931\" weight=\".169\" \t\"CUST_CREDIT_LIMIT\" actualValue=\"1500\" weight=\".115\" \n103441\t\"CUST_MARITAL_STATUS\" actualValue=\"Widowed\" weight=\".222\" \t\"CUST_YEAR_OF_BIRTH\" actualValue=\"1941\" weight=\".117\" \t\"EDUCATION\" actualValue=\"Bach.\" weight=\".076\" \n104286\t\"EDUCATION\" actualValue=\"9th\" weight=\".165\" \t\"HOUSEHOLD_SIZE\" actualValue=\"4-5\" weight=\".146\" \t\"CUST_CREDIT_LIMIT\" actualValue=\"1500\" weight=\".112\" \n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"View prediction details in transactional format","message":["%sql","","WITH d AS"," (SELECT CUST_ID, PREDICTION_DETAILS(ANOMALY_DETECTION_MODEL1, '0' using *) anomalyDetails FROM CUSTOMERS360_TAB)","  SELECT d.CUST_ID, x.name, x.weight","         from d,","         XMLTable('/Details'","                  PASSING d.anomalyDetails","                  COLUMNS","                  class varchar2(16) PATH '@class') c,","         XMLTable('/Details/Attribute'","                  PASSING d.anomalyDetails","                  COLUMNS","                  name varchar2(16) PATH '@name',","                  weight varchar2(30) PATH '@weight') x","    WHERE c.class='0'","ORDER BY CUST_ID, name FETCH FIRST 10 ROWS ONLY;"],"enabled":true,"result":{"startTime":1737148454746,"interpreter":"sql.medium","endTime":1737148455942,"results":[{"message":"CUST_ID\tNAME\tWEIGHT\n100001\tCUST_CREDIT_LIMI\t.109\n100001\tCUST_GENDER\t.053\n100001\tCUST_MARITAL_STA\t.206\n100001\tCUST_YEAR_OF_BIR\t.111\n100001\tY_BOX_GAMES\t.047\n100002\tAFFINITY_CARD\t.015\n100002\tCUST_GENDER\t.025\n100002\tCUST_MARITAL_STA\t.021\n100002\tEDUCATION\t.034\n100002\tY_BOX_GAMES\t.021\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","## End of script"],"enabled":true,"result":{"startTime":1737148456397,"interpreter":"md.medium","endTime":1737148456843,"results":[{"message":"<h2 id=\"end-of-script\">End of script<\/h2>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md"],"enabled":true,"result":{"startTime":1737148457300,"interpreter":"md.medium","endTime":1737148457755,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"}],"version":"6","snapshot":false,"tags":null}]