[{"layout":null,"template":null,"templateConfig":null,"name":"OML4Py Spatial AI Geographical Classifier","description":null,"readOnly":false,"type":"low","paragraphs":[{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","# Geographical Classifier - Spatial AI in Oracle Machine Learning for Python (OML4Py)","","Oracle Machine Learning for Python (OML4Py) makes the Python environment ready for the enterprise. OML4Py integrates Python with Oracle Autonomous Database, enabling the use of Python for machine learning and visualization from database tables and views. Spatial AI is a feature of OML4Py providing algorithms and APIs to analyze, make predictions, and detect patterns from geospatial data. ","","In this notebook, you create models using geographical classification algorithms to predict a categorical target variable incorporating spatial effects.  You will use will use the Los Angeles Housing dataset which contains housing information from the US Census for regions called block groups. ","","","**Copyright (c) 2025 Oracle Corporation**","[The Universal Permissive License (UPL), Version 1.0](https://oss.oracle.com/licenses/upl/)"," "],"enabled":true,"result":{"startTime":1737652334482,"interpreter":"md.low","endTime":1737652334990,"results":[{"message":"<h1 id=\"geographical-classifier---spatial-ai-in-oracle-machine-learning-for-python-oml4py\">Geographical Classifier - Spatial AI in Oracle Machine Learning for Python (OML4Py)<\/h1>\n<p>Oracle Machine Learning for Python (OML4Py) makes the Python environment ready for the enterprise. OML4Py integrates Python with Oracle Autonomous Database, enabling the use of Python for machine learning and visualization from database tables and views. Spatial AI is a feature of OML4Py providing algorithms and APIs to analyze, make predictions, and detect patterns from geospatial data.<\/p>\n<p>In this notebook, you create models using geographical classification algorithms to predict a categorical target variable incorporating spatial effects.  You will use will use the Los Angeles Housing dataset which contains housing information from the US Census for regions called block groups.<\/p>\n<p><strong>Copyright (c) 2025 Oracle Corporation<\/strong>\n<a href=\"https://oss.oracle.com/licenses/upl/\">The Universal Permissive License (UPL), Version 1.0<\/a><\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Before you begin","message":["%md","","Run the notebook **OML4Py Spatial AI Run-me-first** which loads data used in all sample notebooks."],"enabled":true,"result":{"startTime":1737652335539,"interpreter":"md.low","endTime":1737652336010,"results":[{"message":"<p>Run the notebook <strong>OML4Py Spatial AI Run-me-first<\/strong> which loads data used in all sample notebooks.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Import required libraries","message":["%python","","import os","import sys","import shutil","import math","import random","import matplotlib.pyplot as plt","import matplotlib.image as mpimg","from matplotlib import cm","import numpy as np","import pandas as pd","import warnings","import geopandas as gpd","","from shapely.geometry import Point, Polygon, LineString, box","from sklearn.preprocessing import RobustScaler","from sklearn.metrics import f1_score, accuracy_score","from sklearn.ensemble import RandomForestClassifier","from sklearn.svm import SVC","","import oml","","# Oracle Spatial AI API","from oraclesai import SpatialDataFrame, DBSpatialDataset","from oraclesai.weights import SpatialWeights, KNNWeightsDefinition, DistanceBandWeightsDefinition","from oraclesai.analysis import MoranITest","from oraclesai.pipeline import SpatialPipeline","from oraclesai.classification import GeographicalClassifier","from oraclesai import enable_geodataframes","from oraclesai.preprocessing import spatial_train_test_split","enable_geodataframes(z)","","pd.options.mode.chained_assignment = None","pd.options.display.max_columns = None","random_state = 456","random.seed(random_state)"],"enabled":true,"result":{"startTime":1737652336539,"interpreter":"python.low","endTime":1737652337086,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Create a SpatialDataFrame for LA_MEDIAN_HOUSE_VALUES table","message":["%python","","house_values_sdf = SpatialDataFrame.create(DBSpatialDataset(table='la_median_house_values'))","","# Convert to projected coordinate system as required for spatial weights","house_values_sdf = house_values_sdf.to_crs('epsg:3857')","","z.show(house_values_sdf.head())"],"enabled":true,"result":{"startTime":1737652337657,"interpreter":"python.low","endTime":1737652338747,"results":[{"message":"GEOID\tHOUSE_VALUE_MEDIAN\tBEDROOMS_MEDIAN\tBEDROOMS_TOTAL\tCOMPLETE_KITCHEN_PERC\tCOMPLETE_PLUMBING_PERC\tEDU_LEVEL_SCORE_MEDIAN\tHOUSE_AGE_MEDIAN\tPOPULATION_DENSITY\tPOPULATION_TOTAL\tRENTED_PERC\tROOMS_MEDIAN\tROOMS_TOTAL\tUNITS_MEAN\tUNITS_MEDIAN\tUNITS_TOTAL\tYEARS_BUILT_MEDIAN\tgeometry\n060372149021\t771700\t1\t1158\t0.967\t1.0\t20\t39\t0.607\t1010\t0.863\t3.2\t2675\t29.654\t34.5\t24850.0\t1975.0\tPOLYGON ((-13178420.883 4038686.844, -13178415.429 4039069.331, -13178055.087 4039104.005, -13177934.64 4039064.089, -13177867.959 4039063.955, -13177757.308 4039017.454, -13177621.609 4039016.513, -13177610.589 4038659.697, -13177602.685 4038402.205, -13177599.345 4038344.822, -13177730.925 4038465.368, -13178420.327 4038490.365, -13178420.883 4038686.844))\n060372149022\t888800\t2\t1880\t1.0\t1.0\t20\t35\t0.303\t1568\t0.676\t3.4\t4098\t18.473\t14.5\t20745.0\t1979.0\tPOLYGON ((-13178420.327 4038490.365, -13177730.925 4038465.368, -13177599.345 4038344.822, -13177528.769 4038218.229, -13177576.302 4038115.961, -13178298.432 4038163.265, -13178419.325 4038173.747, -13178420.327 4038490.365))\n060372170011\t1554100\t3\t1149\t0.966\t0.939\t20\t75\t0.251\t1371\t0.327\t6.1\t2470\t2.666\t1.0\t1090.5\tnan\tPOLYGON ((-13179224.61 4035337.076, -13179065.98 4035459.741, -13179056.629 4035846.15, -13178831.541 4035846.956, -13178717.216 4035847.225, -13178455.615 4035815.113, -13178482.109 4035598.798, -13178613.8 4035364.619, -13178677.029 4035085.168, -13179116.407 4035185.393, -13179183.088 4035245.045, -13179224.61 4035337.076))\n060372187012\t860300\t2\t1208\t1.0\t1.0\t17\t75\t0.543\t1200\t0.562\t5.2\t2728\t6.915\t1.0\t3333.0\tnan\tPOLYGON ((-13173305.975 4034080.68, -13173256.215 4034153.626, -13173139.107 4034154.029, -13172552.565 4034156.447, -13172843.777 4033523.73, -13172856.022 4033497.132, -13173558.448 4033457.102, -13173305.975 4034080.68))\n060372197002\t654500\t2\t665\t0.947\t1.0\t15\t75\t0.4\t1055\t0.757\t3.3\t1514\t7.782\t2.0\t3369.5\tnan\tPOLYGON ((-13174667.079 4033393.429, -13174153.117 4033422.982, -13173992.037 4033432.251, -13173558.448 4033457.102, -13173737.004 4033174.071, -13173926.693 4033173.265, -13174762.368 4033169.37, -13174667.079 4033393.429))\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","The GeographicalClassifier needs a categorical target variable. Your dataset does not incude a categorical target variable, so next you generate one for HOUSE_VALUE_MEDIAN as follows:","","* House prices below the mean minus 0.5 standard deviation are classified as Low","* House prices above the mean plus 0.5 standard deviation are classified as High","* House prices between low and high are classified as Medium","","The first step is to create an array of categorical target values."," "],"enabled":true,"result":{"startTime":1737652339340,"interpreter":"md.low","endTime":1737652339902,"results":[{"message":"<p>The GeographicalClassifier needs a categorical target variable. Your dataset does not incude a categorical target variable, so next you generate one for HOUSE_VALUE_MEDIAN as follows:<\/p>\n<ul>\n<li>House prices below the mean minus 0.5 standard deviation are classified as Low<\/li>\n<li>House prices above the mean plus 0.5 standard deviation are classified as High<\/li>\n<li>House prices between low and high are classified as Medium<\/li>\n<\/ul>\n<p>The first step is to create an array of categorical target values.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Classify HOUSE_VALUE_MEDIAN values","message":["%python","","y = house_values_sdf[\"HOUSE_VALUE_MEDIAN\"].get_values()","y_mean = y.mean()","y_std = y.std()","","def classify(val):","    if val < y_mean - y_std * 0.5:","        return 'Low'","    if val > y_mean + y_std * 0.5:","        return 'High'","    return 'Medium'","","y_class = [classify(val) for val in y]","","# Plot a histogram of categorical target values","plt.hist(y_class)"," "],"enabled":true,"result":{"startTime":1737652340469,"interpreter":"python.low","endTime":1737652353219,"results":[{"message":"(array([2362.,    0.,    0.,    0.,    0., 1242.,    0.,    0.,    0.,\n       2098.]), array([0. , 0.2, 0.4, 0.6, 0.8, 1. , 1.2, 1.4, 1.6, 1.8, 2. ]), <BarContainer object of 10 artists>)\n","type":"TEXT"},{"message":"<div style='width:auto;height:auto'><img src=data:image/png;base64,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94NjwTvPleOOO865Au/TueeeW71qtXDhwtx0002pVCq54IILaj3aUc8two+gs7MzP/3pTzNr1qxD1ufPn59f/epX+e9HjD3++ONJ3v6D+tvf/jZJ8tRTT+XJJ588bJ8TJ07Mc889lxdeeCGvv/76If8KB97dZz7zmZx00kl55JFHkiQbN26s8UQwcowdOzbjxo3LQw89lCS5/fbbq1ezzjnnnPzmN79JS0tLRo0alfHjx2fz5s05++yzaznyiOAK1kfQ1NRUveX3Ttdff32+//3vp7W1NW+99VY+97nP5e67787y5ctz+eWXZ8aMGZkxY0b1zYPv9IlPfCIrV67MmWeemcbGxpx66qkfx6HAiLdmzZpcccUVGTVqVM4777zqLUHgUK+++mqampqqj6+55pr09PTkyiuvzKuvvppp06Zl7dq1Sd7+Aazh4eGce+65SZKzzz47e/bsybhx42oy+0jik9yBuvDyyy9XP9+nq6srg4ODueWWW2o8FXCscgULqAv33HNPbrzxxrz55puZMmVK1q1bV+uRgGOYK1gAAIV5kzsAQGECCwCgMIEFAFCYwAIAKExgAQAUJrAAAAoTWAAAhQksAIDCBBYAQGECCwCgMIEFAFCYwAIAKExgAQAUJrAAAAoTWAAAhQksAIDCBBYAQGECCwCgMIEFAFCYwAIAKExgAQAUJrAAAAoTWAAAhQksAIDCBBYAQGECCwCgsP8F61kLsO3Tl3EAAAAASUVORK5CYII= style='width=auto;height:auto'><div>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","Next you create a SpatialDataFrame with the block group id (GEIOD), the newly created categorical target variable, and features to use for prediction."],"enabled":true,"result":{"startTime":1737652353753,"interpreter":"md.low","endTime":1737652354470,"results":[{"message":"<p>Next you create a SpatialDataFrame with the block group id (GEIOD), the newly created categorical target variable, and features to use for prediction.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Create SpatialDataFrame with categorical target variable and features","message":["%python","","house_values_sdf = house_values_sdf.add_column('HOUSE_VALUE_CLASS',y_class)","target = ['HOUSE_VALUE_CLASS']","features = ['BEDROOMS_TOTAL',","            'EDU_LEVEL_SCORE_MEDIAN',","            'POPULATION_DENSITY',","            'ROOMS_TOTAL',","            'COMPLETE_PLUMBING_PERC',","            'COMPLETE_KITCHEN_PERC',","            'HOUSE_AGE_MEDIAN',","            'RENTED_PERC',","            'UNITS_TOTAL']","","house_values_sdf = house_values_sdf[[\"GEOID\"] + target + features]","house_values_sdf = house_values_sdf.dropna()","z.show(house_values_sdf.head(50))"],"enabled":true,"result":{"startTime":1737652354985,"interpreter":"python.low","endTime":1737652367761,"results":[{"message":"GEOID\tHOUSE_VALUE_CLASS\tBEDROOMS_TOTAL\tEDU_LEVEL_SCORE_MEDIAN\tPOPULATION_DENSITY\tROOMS_TOTAL\tCOMPLETE_PLUMBING_PERC\tCOMPLETE_KITCHEN_PERC\tHOUSE_AGE_MEDIAN\tRENTED_PERC\tUNITS_TOTAL\tgeometry\n060372149021\tMedium\t1158\t20.0\t0.607\t2675\t1.0\t0.967\t39.0\t0.863\t24850.0\tPOLYGON ((-13178420.883 4038686.844, -13178415.429 4039069.331, -13178055.087 4039104.005, -13177934.64 4039064.089, -13177867.959 4039063.955, -13177757.308 4039017.454, -13177621.609 4039016.513, -13177610.589 4038659.697, -13177602.685 4038402.205, -13177599.345 4038344.822, -13177730.925 4038465.368, -13178420.327 4038490.365, -13178420.883 4038686.844))\n060372149022\tHigh\t1880\t20.0\t0.303\t4098\t1.0\t1.0\t35.0\t0.676\t20745.0\tPOLYGON ((-13178420.327 4038490.365, -13177730.925 4038465.368, -13177599.345 4038344.822, -13177528.769 4038218.229, -13177576.302 4038115.961, -13178298.432 4038163.265, -13178419.325 4038173.747, -13178420.327 4038490.365))\n060372170011\tHigh\t1149\t20.0\t0.251\t2470\t0.939\t0.966\t75.0\t0.327\t1090.5\tPOLYGON ((-13179224.61 4035337.076, -13179065.98 4035459.741, -13179056.629 4035846.15, -13178831.541 4035846.956, -13178717.216 4035847.225, -13178455.615 4035815.113, -13178482.109 4035598.798, -13178613.8 4035364.619, -13178677.029 4035085.168, -13179116.407 4035185.393, -13179183.088 4035245.045, -13179224.61 4035337.076))\n060372187012\tHigh\t1208\t17.0\t0.543\t2728\t1.0\t1.0\t75.0\t0.562\t3333.0\tPOLYGON ((-13173305.975 4034080.68, -13173256.215 4034153.626, -13173139.107 4034154.029, -13172552.565 4034156.447, -13172843.777 4033523.73, -13172856.022 4033497.132, -13173558.448 4033457.102, -13173305.975 4034080.68))\n060372197002\tMedium\t665\t15.0\t0.4\t1514\t1.0\t0.947\t75.0\t0.757\t3369.5\tPOLYGON ((-13174667.079 4033393.429, -13174153.117 4033422.982, -13173992.037 4033432.251, -13173558.448 4033457.102, -13173737.004 4033174.071, -13173926.693 4033173.265, -13174762.368 4033169.37, -13174667.079 4033393.429))\n060372199013\tMedium\t779\t15.0\t0.581\t1724\t1.0\t0.963\t67.0\t0.673\t1055.5\tPOLYGON ((-13176067.478 4033163.325, -13176023.284 4033337.951, -13175295.811 4033357.563, -13175358.373 4033166.683, -13175624.649 4033165.34, -13175758.566 4032681.504, -13176168.333 4032854.646, -13176067.478 4033163.325))\n060372199023\tLow\t533\t17.0\t0.486\t1151\t1.0\t1.0\t62.0\t0.417\t1008.0\tPOLYGON ((-13176841.037 4033513.386, -13176837.03 4033524.67, -13176731.053 4033497.535, -13176023.284 4033337.951, -13176067.478 4033163.325, -13176546.374 4033161.041, -13176973.507 4033159.026, -13176841.037 4033513.386))\n060372244101\tHigh\t1283\t18.0\t0.415\t2712\t1.0\t0.973\t52.0\t0.824\t8318.5\tPOLYGON ((-13167243.627 4033023.088, -13166964.549 4033555.835, -13166779.425 4033456.161, -13166613.893 4033764.722, -13166826.29 4033881.056, -13166190.767 4033913.163, -13166232.957 4033556.104, -13166346.949 4033618.568, -13166446.691 4033673.107, -13166483.872 4033603.12, -13166610.219 4033367.101, -13166836.866 4033273.071, -13167031.897 4032909.315, -13167243.627 4033023.088))\n060372318001\tMedium\t473\t10.0\t0.342\t1040\t1.0\t1.0\t53.0\t0.782\t1598.5\tPOLYGON ((-13166973.9 4029796.38, -13166969.559 4030290.568, -13166862.024 4030291.374, -13166686.25 4030292.582, -13166685.805 4029901.125, -13166685.471 4029555.068, -13166976.015 4029552.517, -13166973.9 4029796.38))\n060372345012\tMedium\t1460\t17.0\t1.4\t3241\t1.0\t0.936\t75.0\t0.267\t1372.5\tPOLYGON ((-13172676.352 4028309.38, -13172601.323 4028802.832, -13171842.013 4028805.92, -13171478.221 4028807.263, -13171480.892 4028134.562, -13171723.346 4028132.548, -13172366.216 4028127.177, -13172677.465 4028124.626, -13172676.352 4028309.38))\n060372410012\tLow\t962\t15.0\t1.034\t1857\t1.0\t0.919\t30.0\t0.721\t862.0\tPOLYGON ((-13166872.043 4019540.905, -13166766.512 4019541.173, -13166187.762 4019543.186, -13165826.864 4019545.466, -13165702.297 4019568.141, -13165704.747 4019045.706, -13165900.446 4019060.33, -13166188.986 4019127.813, -13166500.013 4019191.54, -13166932.489 4019205.225, -13166872.043 4019540.905))\n060372374013\tLow\t1231\t15.0\t0.624\t2616\t1.0\t0.986\t75.0\t0.279\t515.5\tPOLYGON ((-13168878.131 4026431.369, -13168634.342 4026431.1, -13168635.121 4025917.615, -13168636.234 4025391.802, -13168881.248 4025390.326, -13168878.131 4026431.369))\n060372374022\tLow\t954\t15.0\t0.54\t2087\t1.0\t1.0\t75.0\t0.278\t568.0\tPOLYGON ((-13169126.04 4025916.004, -13169124.593 4026307.727, -13169124.147 4026431.637, -13168878.131 4026431.369, -13168881.248 4025390.326, -13169127.932 4025388.849, -13169126.04 4025916.004))\n060372392013\tLow\t479\t15.0\t0.447\t1017\t1.0\t0.996\t58.0\t0.78\t777.0\tPOLYGON ((-13166912.786 4027345.766, -13166678.792 4027347.377, -13166679.571 4026804.315, -13166679.794 4026438.215, -13166927.925 4026436.067, -13166912.786 4027345.766))\n060375330021\tLow\t806\t14.0\t0.49\t1617\t0.954\t0.908\t75.0\t0.591\t392.5\tPOLYGON ((-13162789.289 4026172.676, -13162544.275 4026172.676, -13162542.828 4025410.729, -13162786.283 4025411.132, -13162789.289 4026172.676))\n060379001043\tLow\t2166\t15.0\t120.595\t4102\t1.0\t1.0\t32.0\t0.264\t740.0\tPOLYGON ((-13122376.529 4110430.081, -13122412.263 4110903.728, -13122368.069 4111494.259, -13122419.61 4111915.062, -13120391.257 4111890.579, -13119394.503 4111883.004, -13118509.179 4111881.922, -13116428.84 4111887.333, -13116405.463 4110954.583, -13116096.106 4110326.347, -13116093.212 4110091.967, -13116410.584 4109427.265, -13116413.144 4109385.883, -13116720.163 4109384.396, -13116719.829 4109032.249, -13117271.195 4109027.651, -13117271.529 4109212.378, -13118392.85 4109209.809, -13118389.844 4107921.925, -13118994.866 4107920.708, -13119376.023 4107847.015, -13119794.473 4107933.689, -13120387.918 4107948.833, -13122413.042 4107945.858, -13122423.172 4109081.609, -13122365.508 4109796.464, -13122456.568 4110332.703, -13122376.529 4110430.081))\n060379006022\tLow\t2494\t15.0\t25.434\t4831\t1.0\t0.978\t36.0\t0.593\t3341.5\tPOLYGON ((-13151221.635 4125714.263, -13150937.993 4125692.052, -13150607.708 4125693.948, -13150240.465 4125694.49, -13148203.541 4125744.058, -13148209.998 4125249.47, -13148227.92 4124246.141, -13148240.054 4123744.307, -13149723.386 4123735.776, -13150358.353 4123724.943, -13150481.361 4123724.537, -13150960.814 4123722.1, -13151102.19 4124811.645, -13151221.635 4125714.263))\n060375031052\tLow\t1270\t15.0\t2.322\t2515\t1.0\t0.933\t48.0\t0.515\t7468.5\tPOLYGON ((-13139912.354 4019975.076, -13139707.527 4019803.606, -13138927.066 4019150.621, -13138918.494 4019143.51, -13138933.3 4018438.108, -13139766.081 4018207.768, -13139760.737 4018223.061, -13139673.463 4018614.656, -13139921.371 4019736.522, -13139912.354 4019975.076))\n060375031062\tMedium\t468\t15.0\t0.395\t966\t1.0\t1.0\t46.0\t0.64\t877.0\tPOLYGON ((-13138918.494 4019143.51, -13138432.918 4018734.994, -13138413.994 4018718.895, -13138285.531 4018619.217, -13138366.795 4018596.679, -13138933.3 4018438.108, -13138918.494 4019143.51))\n060375313022\tLow\t978\t15.0\t0.982\t1926\t1.0\t1.0\t60.0\t0.563\t1132.0\tPOLYGON ((-13157102.644 4031529.623, -13155986.332 4031509.88, -13155743.433 4031445.816, -13155881.247 4031339.58, -13155881.469 4030905.647, -13156422.816 4030903.632, -13156426.49 4031339.311, -13157101.308 4031335.685, -13157102.644 4031529.623))\n060375330012\tLow\t1213\t15.0\t0.817\t2558\t1.0\t0.995\t57.0\t0.687\t731.0\tPOLYGON ((-13163272.416 4026119.381, -13162976.194 4026116.831, -13162868.326 4026174.287, -13162789.289 4026172.676, -13162786.283 4025411.132, -13163269.521 4025413.28, -13163272.416 4026119.381))\n060375403003\tLow\t323\t15.0\t1.823\t641\t1.0\t1.0\t60.0\t0.333\t200.0\tPOLYGON ((-13160867.803 4019760.94, -13160527.054 4019582.631, -13160340.149 4019482.14, -13160248.756 4019760.806, -13160185.971 4019619.795, -13159781.102 4019576.862, -13159341.279 4019536.075, -13159256.454 4019558.883, -13159236.639 4019480.396, -13159095.82 4018903.899, -13159059.975 4018744.519, -13159848.228 4019160.146, -13160386.347 4019364.611, -13160814.593 4019359.781, -13160858.452 4019697.747, -13160867.803 4019760.94))\n060375402023\tLow\t935\t15.0\t0.676\t2182\t0.97\t0.943\t58.0\t0.838\t3877.5\tPOLYGON ((-13158900.677 4019944.485, -13158887.764 4020100.796, -13158895.89 4020318.159, -13158771.546 4020305.546, -13158780.563 4020230.274, -13158290.868 4019596.45, -13158520.298 4019477.31, -13158932.403 4019504.277, -13158900.677 4019944.485))\n060375402031\tLow\t1245\t15.0\t2.269\t3001\t0.976\t1.0\t55.0\t0.652\t2750.5\tPOLYGON ((-13159095.82 4018903.899, -13158957.561 4019204.42, -13158547.015 4019161.085, -13158520.298 4019477.31, -13158290.868 4019596.45, -13158022.7 4019213.14, -13157867.632 4019147.803, -13158052.979 4018603.118, -13158138.249 4018364.324, -13158188.009 4018279.405, -13159059.975 4018744.519, -13159095.82 4018903.899))\n060375402032\tLow\t596\t15.0\t0.69\t1557\t0.942\t0.942\t56.0\t0.839\t1866.0\tPOLYGON ((-13159236.639 4019480.396, -13159084.465 4019515.279, -13158932.403 4019504.277, -13158520.298 4019477.31, -13158547.015 4019161.085, -13158957.561 4019204.42, -13159095.82 4018903.899, -13159236.639 4019480.396))\n060375403001\tLow\t1011\t15.0\t1.739\t2034\t1.0\t1.0\t66.0\t0.279\t429.0\tPOLYGON ((-13161247.403 4021164.303, -13161059.384 4021162.827, -13161022.426 4021163.095, -13160947.508 4020770.072, -13160526.609 4020715.729, -13160551.545 4020458.776, -13160380.335 4020439.991, -13160426.867 4020124.411, -13160527.054 4019582.631, -13160867.803 4019760.94, -13160944.057 4020358.68, -13161215.788 4020390.211, -13161196.307 4020468.839, -13161178.051 4020542.369, -13161164.581 4020597.248, -13161247.403 4021164.303))\n060375403002\tLow\t453\t16.0\t1.534\t1045\t1.0\t1.0\t56.0\t0.209\t285.0\tPOLYGON ((-13160426.867 4020124.411, -13160380.335 4020439.991, -13160073.539 4020399.47, -13159675.683 4020351.032, -13159809.044 4019721.897, -13159781.102 4019576.862, -13160185.971 4019619.795, -13160248.756 4019760.806, -13160340.149 4019482.14, -13160527.054 4019582.631, -13160426.867 4020124.411))\n060375405011\tLow\t556\t15.0\t0.845\t1073\t1.0\t1.0\t57.0\t0.293\t628.5\tPOLYGON ((-13159973.796 4018959.307, -13159848.228 4019160.146, -13159059.975 4018744.519, -13159025.577 4018234.598, -13159050.513 4018375.056, -13159615.348 4018538.053, -13159577.944 4018663.086, -13159979.14 4018794.157, -13159973.796 4018959.307))\n060375403004\tLow\t926\t15.0\t0.801\t2094\t0.951\t0.951\t52.0\t0.689\t2103.0\tPOLYGON ((-13159809.044 4019721.897, -13159675.683 4020351.032, -13159543.101 4020335.199, -13159463.063 4020325.27, -13159436.123 4020249.729, -13159365.213 4019976.284, -13159256.454 4019558.883, -13159341.279 4019536.075, -13159781.102 4019576.862, -13159809.044 4019721.897))\n060375404001\tLow\t640\t14.0\t0.629\t1171\t0.968\t0.944\t35.0\t0.487\t280.5\tPOLYGON ((-13161215.788 4020390.211, -13160944.057 4020358.68, -13160867.803 4019760.94, -13160858.452 4019697.747, -13161326.996 4019941.534, -13161215.788 4020390.211))\n060375404002\tLow\t594\t14.0\t0.851\t1094\t1.0\t0.987\t43.0\t0.605\t442.0\tPOLYGON ((-13161378.315 4019734.643, -13161326.996 4019941.534, -13160858.452 4019697.747, -13160814.593 4019359.781, -13160811.476 4019324.63, -13160930.365 4019289.748, -13161265.771 4019270.965, -13161339.464 4019272.575, -13161403.473 4019633.48, -13161378.315 4019734.643))\n060373012031\tMedium\t1649\t20.0\t0.543\t3710\t1.0\t1.0\t51.0\t0.77\t17361.0\tPOLYGON ((-13164744.059 4051514.543, -13164292.77 4051446.06, -13164291.1 4051213.842, -13164103.416 4051213.303, -13164103.638 4050799.6, -13164655.004 4050802.829, -13164657.007 4050904.403, -13164744.059 4051514.543))\n060373012032\tMedium\t2255\t18.0\t0.845\t5372\t1.0\t0.994\t42.0\t0.425\t31768.5\tPOLYGON ((-13165335.722 4051599.979, -13164758.976 4051516.83, -13164744.059 4051514.543, -13164657.007 4050904.403, -13164655.004 4050802.829, -13164811.63 4050797.716, -13165189.449 4050719.686, -13165218.726 4050880.052, -13165335.722 4051599.979))\n060375331051\tLow\t1124\t15.0\t0.585\t2645\t1.0\t0.976\t55.0\t0.864\t4028.0\tPOLYGON ((-13160099.921 4026769.946, -13159490.781 4026695.705, -13159483.545 4026231.61, -13159979.251 4026299.807, -13160092.908 4026333.905, -13160099.588 4026756.924, -13160099.921 4026769.946))\n060375332012\tLow\t937\t15.0\t0.915\t2049\t0.974\t0.974\t69.0\t0.653\t942.0\tPOLYGON ((-13159136.674 4026621.331, -13158412.095 4026532.189, -13158251.127 4026461.709, -13158247.009 4026121.932, -13158223.965 4026071.322, -13158404.414 4026095.486, -13159127.546 4026186.101, -13159136.674 4026621.331))\n060375402021\tLow\t880\t11.0\t0.409\t2123\t1.0\t0.985\t56.0\t0.945\t5497.0\tPOLYGON ((-13159463.063 4020325.27, -13159117.75 4020281.126, -13159112.072 4020347.543, -13158895.89 4020318.159, -13158887.764 4020100.796, -13158900.677 4019944.485, -13159302.763 4019994.263, -13159365.213 4019976.284, -13159436.123 4020249.729, -13159463.063 4020325.27))\n060375406002\tLow\t698\t15.0\t1.852\t1572\t1.0\t1.0\t52.0\t0.589\t338.5\tPOLYGON ((-13162310.393 4019336.302, -13161694.796 4019293.102, -13161339.464 4019272.575, -13161313.972 4019174.099, -13161222.245 4018690.32, -13161917.991 4018683.746, -13161979.44 4018685.893, -13162300.596 4018686.161, -13162310.393 4019336.302))\n060375407002\tLow\t1275\t15.0\t1.444\t2489\t1.0\t1.0\t67.0\t0.376\t499.0\tPOLYGON ((-13164004.898 4019334.424, -13163113.117 4019337.644, -13163114.231 4018567.835, -13163713.686 4018567.165, -13163928.199 4018567.701, -13163954.136 4019063.55, -13163953.468 4019135.729, -13163919.738 4019216.763, -13164005.009 4019323.825, -13164004.898 4019334.424))\n060371043103\tLow\t1278\t15.0\t1.778\t2216\t1.0\t1.0\t55.0\t0.222\t345.0\tPOLYGON ((-13184672.363 4064780.241, -13184146.601 4065926.067, -13184009.233 4066095.675, -13183987.637 4066118.307, -13183631.303 4065713.759, -13183426.253 4065479.496, -13183404.546 4065454.575, -13183429.37 4065432.618, -13184110.979 4064890.831, -13184698.301 4064734.981, -13184672.363 4064780.241))\n060371320022\tMedium\t839\t17.0\t1.688\t1423\t1.0\t1.0\t62.0\t0.429\t256.0\tPOLYGON ((-13192456.267 4055353.457, -13191970.246 4055354.13, -13191969.801 4054865.716, -13191483.892 4054866.389, -13191483.446 4054251.09, -13191483.224 4053889.086, -13192454.82 4053888.278, -13192455.154 4054254.858, -13192455.711 4054865.043, -13192456.267 4055353.457))\n060371321012\tLow\t856\t15.0\t0.601\t2009\t1.0\t0.963\t48.0\t0.878\t17963.5\tPOLYGON ((-13190511.85 4054867.331, -13190374.482 4054867.466, -13190268.839 4054867.601, -13190268.06 4053890.162, -13190511.182 4053890.028, -13190511.404 4054236.556, -13190511.85 4054867.331))\n060371341042\tMedium\t1491\t17.0\t0.91\t2717\t1.0\t1.0\t27.0\t0.4\t14712.0\tPOLYGON ((-13199752.369 4057786.285, -13199266.126 4057786.824, -13199264.345 4056810.211, -13199750.477 4056809.403, -13199752.369 4057786.285))\n060371371032\tLow\t1692\t17.0\t0.373\t3074\t1.0\t1.0\t29.0\t0.398\t36755.0\tPOLYGON ((-13202695.211 4051794.263, -13202696.659 4052083.543, -13202512.87 4052093.634, -13202385.187 4051763.317, -13202205.628 4051738.561, -13202205.517 4051564.324, -13202718.811 4051659.851, -13202695.211 4051794.263))\n060371344241\tHigh\t2404\t20.0\t4.685\t4372\t1.0\t1.0\t29.0\t0.161\t620.0\tPOLYGON ((-13210038.624 4056944.549, -13210036.843 4057912.154, -13210036.175 4058105.066, -13210036.175 4058116.912, -13210036.064 4058689.879, -13210036.064 4058842.279, -13209898.696 4058679.916, -13209440.616 4058573.021, -13209282.765 4058629.834, -13208991.776 4058685.974, -13208509.762 4058457.646, -13208232.688 4058477.167, -13207780.62 4058270.248, -13207360.277 4058269.71, -13207278.791 4058161.472, -13207204.541 4057960.079, -13207212.668 4057282.421, -13207204.875 4057131.118, -13207676.759 4057130.041, -13208523.566 4057122.503, -13208732.29 4057190.212, -13208870.772 4057352.958, -13209123.133 4056998.662, -13209121.574 4056872.669, -13209271.856 4056919.916, -13209689.86 4056627.148, -13209897.582 4056663.087, -13210039.07 4056600.496, -13210038.624 4056944.549))\n060371345211\tLow\t727\t15.0\t0.652\t1494\t1.0\t0.918\t50.0\t0.712\t3590.5\tPOLYGON ((-13202215.313 4056805.096, -13201856.085 4056805.904, -13201695.562 4056806.173, -13201695.451 4056762.56, -13201694.672 4056317.696, -13201694.115 4056073.533, -13201854.527 4056073.264, -13201855.083 4056317.427, -13202214.534 4056316.619, -13202215.313 4056805.096))\n060371390011\tMedium\t1491\t20.0\t0.588\t2948\t0.97\t1.0\t53.0\t0.6\t18908.5\tPOLYGON ((-13192453.484 4052481.012, -13192014.886 4052498.101, -13192031.138 4052141.804, -13192020.897 4051952.626, -13191472.982 4051950.07, -13191481.443 4051804.892, -13191481.331 4051699.273, -13191749.277 4051786.594, -13192452.928 4051797.627, -13192453.484 4052481.012))\n060371394011\tMedium\t1019\t20.0\t1.102\t1983\t1.0\t1.0\t36.0\t0.453\t10204.5\tPOLYGON ((-13195829.693 4051711.517, -13195366.715 4051500.82, -13195367.495 4052076.143, -13195229.125 4052046.138, -13194789.524 4051844.584, -13194788.856 4051205.231, -13194887.596 4051078.091, -13195537.146 4051077.284, -13195930.549 4051268.734, -13195829.693 4051711.517))\n060374308035\tHigh\t865\t20.0\t0.387\t1676\t1.0\t1.0\t55.0\t0.036\t224.0\tPOLYGON ((-13138463.197 4044890.999, -13138322.823 4044722.246, -13137768.564 4044739.592, -13137758.656 4044162.758, -13138451.62 4044152.539, -13138463.197 4044890.999))\n060374333051\tLow\t1522\t15.0\t1.129\t3036\t1.0\t0.933\t48.0\t0.814\t8215.5\tPOLYGON ((-13137613.384 4037723.562, -13137401.098 4038228.039, -13137278.201 4038525.978, -13137174.786 4038464.831, -13136837.154 4038317.406, -13137157.308 4037554.782, -13136916.079 4037499.552, -13136932.777 4037434.244, -13137470.895 4037579.373, -13137640.658 4037659.194, -13137613.384 4037723.562))\n060374315012\tMedium\t1469\t17.0\t0.957\t2829\t1.0\t0.966\t55.0\t0.401\t2988.5\tPOLYGON ((-13139792.129 4042154.016, -13139414.534 4042218.41, -13139487.893 4042652.371, -13139020.017 4042735.454, -13139012.336 4042690.417, -13139000.759 4042621.988, -13138886.323 4041844.152, -13139107.403 4041803.286, -13139339.059 4041763.63, -13139714.874 4041698.432, -13139792.129 4042154.016))\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Split the data into training and test sets","message":["%python","","train, test = house_values_sdf.split(ratio=(0.8, 0.2), seed=random_state)","","X_train = train.drop('GEOID').drop(target)","y_train = train[target]","","X_test = test.drop('GEOID').drop(target)","y_test = test[target]"],"enabled":true,"result":{"startTime":1737652368294,"interpreter":"python.low","endTime":1737652368854,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","","Next you train classification models and make predictions, first using a non-spatial scikit-learn algorithm and then using spatial algorithms that combine localized and global scikit-learn algorithms. For each algorithm, you test and evaluate model performance. You calculate the model's accuracy_score, which represents the percent of test predictions that are correct."," "],"enabled":true,"result":{"startTime":1737652369453,"interpreter":"md.low","endTime":1737652369904,"results":[{"message":"<p>Next you train classification models and make predictions, first using a non-spatial scikit-learn algorithm and then using spatial algorithms that combine localized and global scikit-learn algorithms. For each algorithm, you test and evaluate model performance. You calculate the model's accuracy_score, which represents the percent of test predictions that are correct.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Train a non-spatial RandomForestClassifier model","message":["%python","","rfc_model = SpatialPipeline([('model', RandomForestClassifier(n_estimators=10, random_state=random_state))]) ","rfc_model.fit(X_train, y_train)"],"enabled":true,"result":{"startTime":1737652370475,"interpreter":"python.low","endTime":1737652371200,"results":[{"message":"/usr/local/lib/python3.12/site-packages/sklearn/base.py:1473: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().\n  return fit_method(estimator, *args, **kwargs)\nSpatialPipeline(steps=[('model',\n                        RandomForestClassifier(n_estimators=10,\n                                               random_state=456))])\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Test and score the non-spatial RandomForestClassifier model","message":["%python","","predictions_test_rfc = rfc_model.predict(X_test)","","test_df = pd.DataFrame(y_test.get_values().flatten(), columns=['Target'])","test_df.insert(1, 'Prediction', predictions_test_rfc)","print('\\nExample results: ')","print(test_df.head(10))","","accuracy_test_rfc = round(accuracy_score(y_test.get_values(), predictions_test_rfc), 5)","print('\\nAccuracy score:', accuracy_test_rfc)",""," "],"enabled":true,"result":{"startTime":1737652371714,"interpreter":"python.low","endTime":1737652372274,"results":[{"message":"\nExample results: \n   Target Prediction\n0    High       High\n1  Medium     Medium\n2  Medium        Low\n3     Low        Low\n4     Low        Low\n5     Low        Low\n6  Medium     Medium\n7     Low        Low\n8     Low        Low\n9     Low        Low\n\nAccuracy score: 0.67584\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","Before creating spatial models, you create spatial weights which describe the spatial relationships of block groups, in this case nearest neighbors. The weights are used in spatial model training and prediction."," "],"enabled":true,"result":{"startTime":1737652373018,"interpreter":"md.low","endTime":1737652373486,"results":[{"message":"<p>Before creating spatial models, you create spatial weights which describe the spatial relationships of block groups, in this case nearest neighbors. The weights are used in spatial model training and prediction.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Create spatial weights for split data","message":["%python","","knn_w_def = KNNWeightsDefinition(k=25)","train_weights = SpatialWeights.create(X_train, knn_w_def)","test_weights = SpatialWeights.create(X_test, knn_w_def)"],"enabled":true,"result":{"startTime":1737652374009,"interpreter":"python.low","endTime":1737652374728,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","GeographicalClassifier uses a scikit-learn classification algorithm to create global and local models, where \"local\" is defined by spatial weights. Predictions are made using a combination of the global and local models. Because the algorithm requires the training of numerous local models, it is expected that the time to train is significantly greater than a non-spatial global model. By setting the training parameter n_jobs=-1, the workload is spread across available cores and will improve performance. ","","Next you create a model with GeographicalClassifier using RandomForestClassifier. You set local_weight=0.8 which means that 80% of the prediction result is affected by local models rather than the global model."],"enabled":true,"result":{"startTime":1737652375362,"interpreter":"md.low","endTime":1737652375853,"results":[{"message":"<p>GeographicalClassifier uses a scikit-learn classification algorithm to create global and local models, where &quot;local&quot; is defined by spatial weights. Predictions are made using a combination of the global and local models. Because the algorithm requires the training of numerous local models, it is expected that the time to train is significantly greater than a non-spatial global model. By setting the training parameter n_jobs=-1, the workload is spread across available cores and will improve performance.<\/p>\n<p>Next you create a model with GeographicalClassifier using RandomForestClassifier. You set local_weight=0.8 which means that 80% of the prediction result is affected by local models rather than the global model.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Train a GeographicalClassifier model using RandomForestClassifier","message":["%python","","grfc_model = GeographicalClassifier(model_cls=RandomForestClassifier, n_estimators=10, local_weight=0.80, random_state=random_state)","grfc_model.fit(X_train, y_train, n_jobs=-1, spatial_weights=train_weights)"],"enabled":true,"result":{"startTime":1737652376426,"interpreter":"python.low","endTime":1737652411084,"results":[{"message":"GeographicalClassifier(global_model=RandomForestClassifier(n_estimators=10,\n                                                           random_state=456),\n                       local_weight=0.8,\n                       model_cls=<class 'sklearn.ensemble._forest.RandomForestClassifier'>)\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Test and score GeographicalClassifier model using RandomForestClassifier","message":["%python","","predictions_test_grfc = grfc_model.predict(X_test)","","test_df = pd.DataFrame(test[['GEOID']].get_values().flatten(), columns=['GEOID'])","test_df.insert(1, 'Target', y_test.get_values().flatten())","test_df.insert(2, 'Prediction', predictions_test_grfc)","","print('\\nExample results: ')","print(test_df.head(10))","","accuracy_test_grfc = round(accuracy_score(y_test.get_values(), predictions_test_grfc), 5)","print('\\nAccuracy score:', accuracy_test_grfc)"," "],"enabled":true,"result":{"startTime":1737652411635,"interpreter":"python.low","endTime":1737652412950,"results":[{"message":"\nExample results: \n          GEOID  Target Prediction\n0  060372187012    High     Medium\n1  060372197002  Medium     Medium\n2  060372318001  Medium        Low\n3  060372374013     Low        Low\n4  060372392013     Low        Low\n5  060375330021     Low        Low\n6  060375031062  Medium        Low\n7  060375405011     Low        Low\n8  060375331051     Low        Low\n9  060375407002     Low        Low\n\nAccuracy score: 0.72202\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","Next you create a model with GeographicalClassifier using SupportVectorClassifier (SVC)."],"enabled":true,"result":{"startTime":1737652413474,"interpreter":"md.low","endTime":1737652414073,"results":[{"message":"<p>Next you create a model with GeographicalClassifier using SupportVectorClassifier (SVC).<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Train a GeographicalClassifier model using SupportVectorClassifier (SVC)","message":["%python","","gsvc_model = GeographicalClassifier(model_cls=SVC, probability=True, local_weight=0.8, random_state=random_state) ","gsvc_model.fit(X_train, y_train, n_jobs=-1, spatial_weights=train_weights)"],"enabled":true,"result":{"startTime":1737652414586,"interpreter":"python.low","endTime":1737652424410,"results":[{"message":"GeographicalClassifier(global_model=SVC(probability=True, random_state=456),\n                       local_weight=0.8,\n                       model_cls=<class 'sklearn.svm._classes.SVC'>)\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Test and score GeographicalClassifier model using SupportVectorClassifier (SVC)","message":["%python","","predictions_test_gsvc = gsvc_model.predict(X_test)","","test_df = pd.DataFrame(test[['GEOID']].get_values().flatten(), columns=['GEOID'])","test_df.insert(1, 'Target', y_test.get_values().flatten())","test_df.insert(2, 'Prediction', predictions_test_gsvc)","","print('\\nExample results: ')","print(test_df.head(10))","","accuracy_test_gsvc = round(accuracy_score(y_test.get_values(), predictions_test_gsvc), 5)","print('\\nAccuracy score:', accuracy_test_gsvc)"," "],"enabled":true,"result":{"startTime":1737652424897,"interpreter":"python.low","endTime":1737652425870,"results":[{"message":"\nExample results: \n          GEOID  Target Prediction\n0  060372187012    High     Medium\n1  060372197002  Medium     Medium\n2  060372318001  Medium        Low\n3  060372374013     Low        Low\n4  060372392013     Low        Low\n5  060375330021     Low        Low\n6  060375031062  Medium     Medium\n7  060375405011     Low        Low\n8  060375331051     Low        Low\n9  060375407002     Low        Low\n\nAccuracy score: 0.70604\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","Finally you compare the accurace scores of the non-spatial model and 2 spatial models. "],"enabled":true,"result":{"startTime":1737652426352,"interpreter":"md.low","endTime":1737652426813,"results":[{"message":"<p>Finally you compare the accurace scores of the non-spatial model and 2 spatial models.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Compare accuracy scores","message":["%python","","print('Accuracy scores:') ","print('Non-spatial RandomForestClassifier\\t\\t\\t', accuracy_test_rfc)","print('GeographicalClassifier using RandomForestClassifier\\t', accuracy_test_grfc)","print('GeographicalClassifier using SupportVectorClassifier\\t', accuracy_test_gsvc)"],"enabled":true,"result":{"startTime":1737652427294,"interpreter":"python.low","endTime":1737652427770,"results":[{"message":"Accuracy scores:\nNon-spatial RandomForestClassifier\t\t\t 0.67584\nGeographicalClassifier using RandomForestClassifier\t 0.72202\nGeographicalClassifier using SupportVectorClassifier\t 0.70604\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","","","","","","Observe that the spatial models improve the models prediction, as they capture regional variation in the behavior of the data. The underlying spatial relationships of block groups specified by spatial weights are key to spatial model behavior. To best define spatial weights, experimenting with various weights definitions and parameters is generally required. If spatial weights are not supplied for model training then a weights definition will be auto-seleted based on training and testing with numerous definitions. However, since many local models need to be trained, the training time is dramatically longer than non-spatial models."],"enabled":true,"result":{"startTime":1737652428334,"interpreter":"md.low","endTime":1737652428796,"results":[{"message":"<p>Observe that the spatial models improve the models prediction, as they capture regional variation in the behavior of the data. The underlying spatial relationships of block groups specified by spatial weights are key to spatial model behavior. To best define spatial weights, experimenting with various weights definitions and parameters is generally required. If spatial weights are not supplied for model training then a weights definition will be auto-seleted based on training and testing with numerous definitions. However, since many local models need to be trained, the training time is dramatically longer than non-spatial models.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","## End of Script"," "],"enabled":true,"result":{"startTime":1737652429375,"interpreter":"md.low","endTime":1737652429873,"results":[{"message":"<h2 id=\"end-of-script\">End of Script<\/h2>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"}],"version":"6","snapshot":false,"tags":null}]