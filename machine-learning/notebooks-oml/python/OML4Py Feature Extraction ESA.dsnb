[{"layout":null,"template":null,"templateConfig":null,"name":"OML4Py Feature Extraction ESA","description":null,"readOnly":false,"type":"low","paragraphs":[{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":null,"message":["%md"," "],"enabled":true,"result":{"startTime":1718663082306,"interpreter":"md.low","endTime":1718663082456,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","# Explicit Semantic Analysis (ESA) for Text Analytics","","Explicit Semantic Analysis (ESA) is an unsupervised algorithm for feature extraction of explicit features based on an existing knowledge base.  It is the process of understanding the meaning of a section of text as a combination of the concepts found in the text. Compared to other techniques such as Latent Dirichlet Association (LDA) or Term Frequency-Inverse Document Frequency (TF-IDF), ESA offers some unique benefits. Most notably, it improves text document categorization by calculating `semantic relatedness` (how similar in meaning two words or pieces of text are to each other) between the documents and a set of topics that are explicitly defined and described by humans.","","The Oracle Machine Learning for Python function *oml.esa* extracts text-based features from a corpus of documents and performs document similarity comparisons. All processing occurs inside Oracle Autonomous Database.","","In this notebook, we cover the basic usage of ESA, where we extract topics from the comments provided. ",""," - Create a small sample dataset"," - Use the ESA Model to predict a feature vector on test data"," - Identify top features"," - Document similarity"," - Change model settings","","Copyright (c) 2024 Oracle Corporation ","###### <a href=\"https://oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0<\/a>","---"],"enabled":true,"result":{"startTime":1718663082522,"interpreter":"md.low","endTime":1718663082610,"results":[{"message":"<h1 id=\"explicit-semantic-analysis-esa-for-text-analytics\">Explicit Semantic Analysis (ESA) for Text Analytics<\/h1>\n<p>Explicit Semantic Analysis (ESA) is an unsupervised algorithm for feature extraction of explicit features based on an existing knowledge base.  It is the process of understanding the meaning of a section of text as a combination of the concepts found in the text. Compared to other techniques such as Latent Dirichlet Association (LDA) or Term Frequency-Inverse Document Frequency (TF-IDF), ESA offers some unique benefits. Most notably, it improves text document categorization by calculating <code>semantic relatedness<\/code> (how similar in meaning two words or pieces of text are to each other) between the documents and a set of topics that are explicitly defined and described by humans.<\/p>\n<p>The Oracle Machine Learning for Python function <em>oml.esa<\/em> extracts text-based features from a corpus of documents and performs document similarity comparisons. All processing occurs inside Oracle Autonomous Database.<\/p>\n<p>In this notebook, we cover the basic usage of ESA, where we extract topics from the comments provided.<\/p>\n<ul>\n<li>Create a small sample dataset<\/li>\n<li>Use the ESA Model to predict a feature vector on test data<\/li>\n<li>Identify top features<\/li>\n<li>Document similarity<\/li>\n<li>Change model settings<\/li>\n<\/ul>\n<p>Copyright (c) 2024 Oracle Corporation<\/p>\n<h6 id=\"the-universal-permissive-license-upl-version-10\"><a href=\"https://oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0<\/a><\/h6>\n<hr />\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"For more information...","message":["%md","","* <a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a>","* <a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a>","* <a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a>","* <a href=\"https://www.oracle.com/goto/ml-explicit-semantic-analysis\" target=\"_blank\">OML Explicit Semantic Analysis"],"enabled":true,"result":{"startTime":1718663082681,"interpreter":"md.low","endTime":1718663082749,"results":[{"message":"<ul>\n<li><a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a><\/li>\n<li><a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a><\/li>\n<li><a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a><\/li>\n<li><a href=\"https://www.oracle.com/goto/ml-explicit-semantic-analysis\" target=\"_blank\">OML Explicit Semantic Analysis<\/li>\n<\/ul>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Import libraries","message":["%python","","import oml","import pandas as pd"],"enabled":true,"result":{"startTime":1718663082819,"interpreter":"python.low","endTime":1718663084813,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Create test and training data","message":["%python","","dat = oml.push(pd.DataFrame(","  {'COMMENTS':['Aids in Africa: Planning for a long war',","               'Mars rover maneuvers for rim shot',","               'Mars express confirms presence of water at Mars south pole',","               'NASA announces major Mars rover finding',","               'Drug access, Asia threat in focus at AIDS summit',","               'NASA Mars Odyssey THEMIS image: typical crater',","               'Road blocks for Aids'],","    'ID':[1,2,3,4,5,6,7]})).split(ratio=(0.7,0.3), seed = 1234)","","train_dat = dat[0]","test_dat = dat[1]"],"enabled":true,"result":{"startTime":1718663084879,"interpreter":"python.low","endTime":1718663085447,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Check the test data","message":["%python","","z.show(test_dat)"],"enabled":true,"result":{"startTime":1718663085512,"interpreter":"python.low","endTime":1718663085601,"results":[{"message":"COMMENTS\tID\nAids in Africa: Planning for a long war\t1\nNASA announces major Mars rover finding\t4\nRoad blocks for Aids\t7\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Check the training data","message":["%python","","z.show(train_dat)"],"enabled":true,"result":{"startTime":1718663085665,"interpreter":"python.low","endTime":1718663085755,"results":[{"message":"COMMENTS\tID\nMars rover maneuvers for rim shot\t2\nMars express confirms presence of water at Mars south pole\t3\nDrug access, Asia threat in focus at AIDS summit\t5\nNASA Mars Odyssey THEMIS image: typical crater\t6\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":"[{\"raw\":{\"height\":300,\"lastColumns\":[],\"version\":1}}]","hideInIFrame":false,"selectedVisualization":"raw","title":"View the help file for ESA","message":["%python","","help(oml.esa)"],"enabled":true,"result":{"startTime":1718663085843,"interpreter":"python.low","endTime":1718663086109,"results":[{"message":"Help on class esa in module oml.algo.esa:\n\nclass esa(oml.algo.model.odmModel)\n |  esa(model_name=None, model_owner=None, **params)\n |\n |  In-database `Explicit Semantic Analysis <https://www.oracle.com/machine-learning/explicit-semantic-analysis>`_ Model\n |\n |  Builds an Explicit Semantic Analysis (ESA) Model to be used for feature extraction.\n |  This function exposes the corresponding Oracle Machine Learning in-database algorithm.\n |  ESA uses concepts of an existing knowledge base as features rather than latent\n |  features derived by latent semantic analysis methods such as Singular\n |  Value Decomposition and Latent Dirichlet Allocation. Each row, for example,\n |  a document in the training data maps to a feature, that is, a concept.\n |  ESA works best with concepts represented by text documents.\n |  It has multiple applications in the area of text processing, most\n |  notably semantic relatedness (similarity) and explicit topic modeling.\n |  Text similarity use cases might involve, for example, resume matching, searching\n |  for similar blog postings, and so on.\n |\n |  :Attributes:\n |\n |      **features** : oml.DataFrame\n |\n |        Description of each feature extracted.\n |        It includes the following components:\n |\n |            - feature_id: The unique identifier of a feature as it appears in the training data\n |            - attribute_name: The attribute name\n |            - attribute_value: The attribute value\n |            - coefficient: The coefficient (weight) associated with the attribute in a particular feature.\n |\n |  Method resolution order:\n |      esa\n |      oml.algo.model.odmModel\n |      builtins.object\n |\n |  Methods defined here:\n |\n |  __init__(self, model_name=None, model_owner=None, **params)\n |      Initializes an instance of esa object.\n |\n |      Parameters\n |      ----------\n |      model_name : string or None (default)\n |          The name of an existing database Explicit Semantic Analysis model to create an oml.esa object from.\n |          The specified database model is not dropped when the oml.esa object is deleted.\n |      model_owner: string or None (default)\n |          The owner name of the existing Explicit Semantic Analysis model\n |          The current database user by default\n |      params : key-value pairs or dict\n |          Oracle Machine Learning parameter settings. Each list element's name and\n |          value refer to the parameter setting name and value, respectively.\n |          The setting value must be numeric or string. Refer to `Oracle Data Mining\n |          Model Settings <https://docs.oracle.com/en/database/oracle/oracle-database/19/dmprg/specifying-model-settings.html#GUID-F1083AFB-E357-4BC8-B629-1ABD85EBFA38>`_\n |          for applicable parameters and valid values. Global and Automatic Data\n |          Preparation Settings in Table 5-5 apply generally to the model.\n |          Mining Function Settings for Feature Extraction and `Algorithm-specific\n |          Settings <https://docs.oracle.com/en/database/oracle/oracle-database/19/arpls/DBMS_DATA_MINING.html#GUID-91FC543B-24E4-4D93-9D79-E95B1846F3B7>`_\n |          are applicable to Explicit Semantic Analysis model.\n |\n |  __repr__(self)\n |\n |  feature_compare(self, x, compare_cols=None, supplemental_cols=None)\n |      Compares features of data and generates relatedness.\n |\n |      Parameters\n |      ----------\n |      x : an OML object\n |          The data used to measure relatedness.\n |      compare_cols : str, a list of str or None (default)\n |          The column(s) used to measure data relatedness.\n |          If None, all the columns of ``x`` are compared to measure relatedness.\n |      supplemental_cols : a list of str or None (default)\n |          A list of columns to display along with the resulting 'SIMILARITY' column.\n |\n |      Returns\n |      -------\n |      pred : oml.DataFrame\n |          Contains a 'SIMILARITY' column that measures relatedness and supplementary columns if specified.\n |\n |  fit(self, x, model_name=None, case_id=None, ctx_settings=None)\n |      Fits an ESA Model according to the training data and parameter settings.\n |\n |      Parameters\n |      ----------\n |      x : an OML object\n |          Attribute values for building the model.\n |      model_name : string or None (default)\n |          User-specified model name.\n |          The user-specified database model is not dropped when oml.esa object is deleted.\n |          If None, a system-generated model name will be used.\n |          The system-generated model is dropped when oml.esa object is deleted\n |          unless oml.esa object is saved into a datastore.\n |      case_id : string or None (default)\n |          The column name used as case id for building the model.\n |      ctx_settings : dict or None (default)\n |          A list to specify Oracle Text attribute-specific settings.\n |          This argument is applicable to building models in Oracle Database 12.2 or later.\n |          The name of each list element refers to the text column while the list value\n |          is a scalar string specifying the attribute-specific text transformation.\n |          The valid entries in the string include TEXT, POLICY_NAME, TOKEN_TYPE, and\n |          MAX_FEATURES.\n |\n |  predict(self, x, supplemental_cols=None, topN_attrs=False)\n |      Makes predictions on new data.\n |\n |      Parameters\n |      ----------\n |      x : an OML object\n |        Attribute values used by the model to generate scores.\n |      supplemental_cols : oml.DataFrame, oml.Float, oml.String, or None (default)\n |          Data set presented with the prediction result.\n |          It must be concatenatable with ``x``.\n |      topN_attrs : boolean, positive integer, False (default)\n |          Returns the top N most important features with the corresponding weights.\n |          N is equal to the specified positive integer or 5 if topN_attrs is True.\n |\n |      Returns\n |      -------\n |      pred : oml.DataFrame\n |        Contains the features specified by ``supplemental_cols`` and the\n |        results. The results include the most likely feature and its probability.\n |\n |  transform(self, x, supplemental_cols=None, topN=None)\n |      Make predictions and return relevancy for each feature on new data.\n |\n |      Parameters\n |      ----------\n |      x : an OML object\n |        Attribute values used by the model to generate scores.\n |      supplemental_cols : oml.DataFrame, oml.Float, oml.String, or None (default)\n |          Data set presented with the prediction result.\n |          It must be concatenatable with ``x``.\n |      topN : positive integer or None (default)\n |          A positive integer that restricts the returned values to\n |          the specified number of features that have the highest topN values.\n |\n |      Returns\n |      -------\n |      pred : oml.DataFrame\n |        Contains the relevancy for each feature on new data and the specified ``supplemental_cols``.\n |\n |  ----------------------------------------------------------------------\n |  Methods inherited from oml.algo.model.odmModel:\n |\n |  export_sermodel(self, table=None, partition=None)\n |      Export model.\n |\n |      Parameters\n |      ----------\n |      table : string or None (default)\n |          A name for the new table where the serialized model is saved.\n |          If None, the serialized model will be saved to a temporary table.\n |      partition : string or None (default)\n |          Name of the partition that needs to be exported.\n |          If partition is None, all partitions are exported\n |\n |      Returns\n |      -------\n |      oml_bytes : an oml.Bytes object\n |        Contains the BLOB content from the model export\n |\n |  get_params(self, params=None, deep=False)\n |      Fetches parameters of the model.\n |\n |      Parameters\n |      ----------\n |      params : iterable of strings, None (default)\n |          Names of parameters to fetch. If ``params`` is None,\n |          fetches all settings.\n |      deep : boolean, False (default)\n |          Includes the computed and default parameters or not.\n |\n |      Returns\n |      -------\n |      settings : dict mapping str to str\n |\n |  set_params(self, **params)\n |      Changes parameters of the model.\n |\n |      Parameters\n |      ----------\n |      params : dict object mapping str to str\n |          The key should be the name of the setting, and the value should be\n |          the new setting.\n |\n |      Returns\n |      -------\n |      model : the model itself.\n |\n |  ----------------------------------------------------------------------\n |  Readonly properties inherited from oml.algo.model.odmModel:\n |\n |  model_owner\n |      The owner name of database mining model\n |\n |  ----------------------------------------------------------------------\n |  Data descriptors inherited from oml.algo.model.odmModel:\n |\n |  __dict__\n |      dictionary for instance variables\n |\n |  __weakref__\n |      list of weak references to the object\n |\n |  model_name\n |      The given name of database mining model\n |\n |  pivot_limit\n |      The maximum number of classes, clusters, or features for which the predicted probabilities are presented after pivoted\n\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Create a policy for text indexing","message":["%script","","-- Drop the policy if it exists","BEGIN ctx_ddl.drop_policy('ESA_TXT_POLICY'); ","   exception when others then NULL;","END;","","BEGIN ctx_ddl.create_policy('ESA_TXT_POLICY'); ","   exception when others then NULL;","END;"],"enabled":true,"result":{"startTime":1718663086185,"interpreter":"script.low","endTime":1718663090879,"results":[{"message":"\nPL/SQL procedure successfully completed.\n\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Specify model settings","message":["%python","","odm_settings = {'odms_text_policy_name': 'ESA_TXT_POLICY',","                '\"ODMS_TEXT_MIN_DOCUMENTS\"': 1,","                '\"ESAS_MIN_ITEMS\"': 1}","","ctx_settings = {'COMMENTS':","                'TEXT(POLICY_NAME:ESA_TXT_POLICY)(TOKEN_TYPE:STEM)'}"],"enabled":true,"result":{"startTime":1718663090964,"interpreter":"python.low","endTime":1718663091033,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Create an ESA model object ","message":["%python","","# Delete if ESA model exists","try:","    oml.drop(model = 'ESA_MOD')","except:","    print('No such model')","    ","esa_mod = oml.esa(**odm_settings)"],"enabled":true,"result":{"startTime":1718663091100,"interpreter":"python.low","endTime":1718663091167,"results":[{"message":"No such model\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"View the model settings","message":["%python","","esa_mod.settings"],"enabled":true,"result":{"startTime":1718663091233,"interpreter":"python.low","endTime":1718663091300,"results":[{"message":"{'odms_text_policy_name': 'ESA_TXT_POLICY', '\"odms_text_min_documents\"': 1, '\"esas_min_items\"': 1}\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":" Fit the model according to the training data and parameter settings","message":["%python","","esa_mod = esa_mod.fit(train_dat, case_id='ID', ctx_settings = ctx_settings)"],"enabled":true,"result":{"startTime":1718663091368,"interpreter":"python.low","endTime":1718663092457,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":"[{\"raw\":{\"height\":300,\"lastColumns\":[],\"version\":1}}]","hideInIFrame":false,"selectedVisualization":"raw","title":"Show the model details","message":["%python","","esa_mod"],"enabled":true,"result":{"startTime":1718663092523,"interpreter":"python.low","endTime":1718663092667,"results":[{"message":"\nAlgorithm Name: Explicit Semantic Analysis\n\nMining Function: FEATURE_EXTRACTION\n\nSettings: \n                    setting name                  setting value\n0                      ALGO_NAME  ALGO_EXPLICIT_SEMANTIC_ANALYS\n1                 ESAS_MIN_ITEMS                              1\n2             ESAS_TOPN_FEATURES                           1000\n3           ESAS_VALUE_THRESHOLD                      .00000001\n4                   ODMS_DETAILS                    ODMS_ENABLE\n5   ODMS_MISSING_VALUE_TREATMENT        ODMS_MISSING_VALUE_AUTO\n6                  ODMS_SAMPLING          ODMS_SAMPLING_DISABLE\n7         ODMS_TEXT_MAX_FEATURES                         300000\n8        ODMS_TEXT_MIN_DOCUMENTS                              1\n9          ODMS_TEXT_POLICY_NAME                 ESA_TXT_POLICY\n10                     PREP_AUTO                             ON\n\nGlobal Statistics: \n  attribute name  attribute value\n0       NUM_ROWS                4\n\nAttributes: \nCOMMENTS\n\nPartition: NO\n\nFeatures: \n\n    FEATURE_ID      ATTRIBUTE_NAME ATTRIBUTE_VALUE  COEFFICIENT\n0            2  COMMENTS.MANEUVERS            None     0.497330\n1            2       COMMENTS.MARS            None     0.103205\n2            2        COMMENTS.RIM            None     0.497330\n3            2      COMMENTS.ROVER            None     0.497330\n4            2       COMMENTS.SHOT            None     0.497330\n5            3   COMMENTS.CONFIRMS            None     0.404991\n6            3    COMMENTS.EXPRESS            None     0.404991\n7            3       COMMENTS.MARS            None     0.126065\n8            3       COMMENTS.POLE            None     0.404991\n9            3   COMMENTS.PRESENCE            None     0.404991\n10           3      COMMENTS.SOUTH            None     0.404991\n11           3      COMMENTS.WATER            None     0.404991\n12           5     COMMENTS.ACCESS            None     0.377964\n13           5       COMMENTS.AIDS            None     0.377964\n14           5       COMMENTS.ASIA            None     0.377964\n15           5       COMMENTS.DRUG            None     0.377964\n16           5      COMMENTS.FOCUS            None     0.377964\n17           5     COMMENTS.SUMMIT            None     0.377964\n18           5     COMMENTS.THREAT            None     0.377964\n19           6     COMMENTS.CRATER            None     0.406791\n20           6      COMMENTS.IMAGE            None     0.406791\n21           6       COMMENTS.MARS            None     0.084417\n22           6       COMMENTS.NASA            None     0.406791\n23           6    COMMENTS.ODYSSEY            None     0.406791\n24           6     COMMENTS.THEMIS            None     0.406791\n25           6    COMMENTS.TYPICAL            None     0.406791\n\n\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":"[{\"raw\":{\"height\":300,\"lastColumns\":[],\"version\":1}}]","hideInIFrame":false,"selectedVisualization":"raw","title":"Show the model details for each feature","message":["%python","","z.show(esa_mod.features.round(4))"],"enabled":true,"result":{"startTime":1718663092734,"interpreter":"python.low","endTime":1718663092821,"results":[{"message":"FEATURE_ID\tATTRIBUTE_NAME\tATTRIBUTE_VALUE\tCOEFFICIENT\n2\tCOMMENTS.MANEUVERS\tNone\t0.4973\n2\tCOMMENTS.MARS\tNone\t0.1032\n2\tCOMMENTS.RIM\tNone\t0.4973\n2\tCOMMENTS.ROVER\tNone\t0.4973\n2\tCOMMENTS.SHOT\tNone\t0.4973\n3\tCOMMENTS.CONFIRMS\tNone\t0.405\n3\tCOMMENTS.EXPRESS\tNone\t0.405\n3\tCOMMENTS.MARS\tNone\t0.1261\n3\tCOMMENTS.POLE\tNone\t0.405\n3\tCOMMENTS.PRESENCE\tNone\t0.405\n3\tCOMMENTS.SOUTH\tNone\t0.405\n3\tCOMMENTS.WATER\tNone\t0.405\n5\tCOMMENTS.ACCESS\tNone\t0.378\n5\tCOMMENTS.AIDS\tNone\t0.378\n5\tCOMMENTS.ASIA\tNone\t0.378\n5\tCOMMENTS.DRUG\tNone\t0.378\n5\tCOMMENTS.FOCUS\tNone\t0.378\n5\tCOMMENTS.SUMMIT\tNone\t0.378\n5\tCOMMENTS.THREAT\tNone\t0.378\n6\tCOMMENTS.CRATER\tNone\t0.4068\n6\tCOMMENTS.IMAGE\tNone\t0.4068\n6\tCOMMENTS.MARS\tNone\t0.0844\n6\tCOMMENTS.NASA\tNone\t0.4068\n6\tCOMMENTS.ODYSSEY\tNone\t0.4068\n6\tCOMMENTS.THEMIS\tNone\t0.4068\n6\tCOMMENTS.TYPICAL\tNone\t0.4068\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Predicted top 2 features","message":["%python","","z.show(esa_mod.transform(test_dat, ","                         supplemental_cols = test_dat[:, ['ID', 'COMMENTS']], ","                         topN = 2).sort_values(by = ['ID']).round(4))"],"enabled":true,"result":{"startTime":1718663092887,"interpreter":"python.low","endTime":1718663093543,"results":[{"message":"ID\tCOMMENTS\tTOP_1\tTOP_1_VAL\tTOP_2\tTOP_2_VAL\n1\tAids in Africa: Planning for a long war\t5\t1.0\tnan\tnan\n4\tNASA announces major Mars rover finding\t2\t0.7738\t6.0\t0.6329\n7\tRoad blocks for Aids\t5\t1.0\tnan\tnan\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"View the model name internal to the database","message":["%sql","","SELECT * from all_mining_models WHERE ALGORITHM='EXPLICIT_SEMANTIC_ANALYS'"],"enabled":true,"result":{"startTime":1718663093616,"interpreter":"sql.low","endTime":1718663093796,"results":[{"message":"OWNER\tMODEL_NAME\tMINING_FUNCTION\tALGORITHM\tALGORITHM_TYPE\tCREATION_DATE\tBUILD_DURATION\tMODEL_SIZE\tPARTITIONED\tCOMMENTS\nOMLUSER\tOPE$DM2189_146_00072\tFEATURE_EXTRACTION\tEXPLICIT_SEMANTIC_ANALYS\tNATIVE\t2022-07-19 00:47:40\t\t0\tNO\t\nOMLUSER\tOPE$DM11105_146_00082\tFEATURE_EXTRACTION\tEXPLICIT_SEMANTIC_ANALYS\tNATIVE\t2024-06-17 22:24:51\t\t0\tNO\t\nOMLUSER\tWIKI_MODEL\tFEATURE_EXTRACTION\tEXPLICIT_SEMANTIC_ANALYS\tNATIVE\t2023-11-08 19:36:42\t0\t0\tNO\t\nOMLUSER\tOPE$DM1202_146_00073\tFEATURE_EXTRACTION\tEXPLICIT_SEMANTIC_ANALYS\tNATIVE\t2022-03-15 22:17:25\t\t0\tNO\t\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Rename the model in the database","message":["%python","","esa_mod.model_name='ESA_MOD'"],"enabled":true,"result":{"startTime":1718663093868,"interpreter":"python.low","endTime":1718663094086,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"View new model name in the database","message":["%sql","","select * from USER_MINING_MODELS where model_name='ESA_MOD'"],"enabled":true,"result":{"startTime":1718663094155,"interpreter":"sql.low","endTime":1718663094226,"results":[{"message":"MODEL_NAME\tMINING_FUNCTION\tALGORITHM\tALGORITHM_TYPE\tCREATION_DATE\tBUILD_DURATION\tMODEL_SIZE\tPARTITIONED\tCOMMENTS\nESA_MOD\tFEATURE_EXTRACTION\tEXPLICIT_SEMANTIC_ANALYS\tNATIVE\t2024-06-17 22:24:51\t\t0\tNO\t\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":"[{\"raw\":{\"height\":300,\"lastColumns\":[],\"version\":1}}]","hideInIFrame":false,"selectedVisualization":"raw","title":"View renamed model in Python","message":["%python","","oml.esa(model_name = 'ESA_MOD') "],"enabled":true,"result":{"startTime":1718663094293,"interpreter":"python.low","endTime":1718663094606,"results":[{"message":"\nModel Name: ESA_MOD\n\nModel Owner: OMLUSER\n\nAlgorithm Name: Explicit Semantic Analysis\n\nMining Function: FEATURE_EXTRACTION\n\nSettings: \n                    setting name                  setting value\n0                      ALGO_NAME  ALGO_EXPLICIT_SEMANTIC_ANALYS\n1                 ESAS_MIN_ITEMS                              1\n2             ESAS_TOPN_FEATURES                           1000\n3           ESAS_VALUE_THRESHOLD                      .00000001\n4                   ODMS_DETAILS                    ODMS_ENABLE\n5   ODMS_MISSING_VALUE_TREATMENT        ODMS_MISSING_VALUE_AUTO\n6                  ODMS_SAMPLING          ODMS_SAMPLING_DISABLE\n7         ODMS_TEXT_MAX_FEATURES                         300000\n8        ODMS_TEXT_MIN_DOCUMENTS                              1\n9          ODMS_TEXT_POLICY_NAME                 ESA_TXT_POLICY\n10                     PREP_AUTO                             ON\n\nGlobal Statistics: \n  attribute name  attribute value\n0       NUM_ROWS                4\n\nAttributes: \nCOMMENTS\n\nPartition: NO\n\nFeatures: \n\n    FEATURE_ID      ATTRIBUTE_NAME ATTRIBUTE_VALUE  COEFFICIENT\n0            2  COMMENTS.MANEUVERS            None     0.497330\n1            2       COMMENTS.MARS            None     0.103205\n2            2        COMMENTS.RIM            None     0.497330\n3            2      COMMENTS.ROVER            None     0.497330\n4            2       COMMENTS.SHOT            None     0.497330\n5            3   COMMENTS.CONFIRMS            None     0.404991\n6            3    COMMENTS.EXPRESS            None     0.404991\n7            3       COMMENTS.MARS            None     0.126065\n8            3       COMMENTS.POLE            None     0.404991\n9            3   COMMENTS.PRESENCE            None     0.404991\n10           3      COMMENTS.SOUTH            None     0.404991\n11           3      COMMENTS.WATER            None     0.404991\n12           5     COMMENTS.ACCESS            None     0.377964\n13           5       COMMENTS.AIDS            None     0.377964\n14           5       COMMENTS.ASIA            None     0.377964\n15           5       COMMENTS.DRUG            None     0.377964\n16           5      COMMENTS.FOCUS            None     0.377964\n17           5     COMMENTS.SUMMIT            None     0.377964\n18           5     COMMENTS.THREAT            None     0.377964\n19           6     COMMENTS.CRATER            None     0.406791\n20           6      COMMENTS.IMAGE            None     0.406791\n21           6       COMMENTS.MARS            None     0.084417\n22           6       COMMENTS.NASA            None     0.406791\n23           6    COMMENTS.ODYSSEY            None     0.406791\n24           6     COMMENTS.THEMIS            None     0.406791\n25           6    COMMENTS.TYPICAL            None     0.406791\n\n\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Make predictions on the test data","message":["%python","","esa_pred = esa_mod.predict(test_dat, supplemental_cols = test_dat[:, ['ID', 'COMMENTS']])","z.show(esa_pred)"],"enabled":true,"result":{"startTime":1718663094682,"interpreter":"python.low","endTime":1718663094797,"results":[{"message":"ID\tCOMMENTS\tFEATURE_ID\n1\tAids in Africa: Planning for a long war\t5\n4\tNASA announces major Mars rover finding\t2\n7\tRoad blocks for Aids\t5\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Change the settings and refit the model","message":["%python","","new_setting = {'ESAS_VALUE_THRESHOLD': '0.01',","               'ODMS_TEXT_MAX_FEATURES': '2',","               'FEAT_NUM_FEATURES': '2',","               'ESAS_TOPN_FEATURES': '2'}","               "],"enabled":true,"result":{"startTime":1718663094864,"interpreter":"python.low","endTime":1718663094918,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":"Refit the model with new settings - 2 features maximum ","message":["%python","","# Delete if ESA model exists","try:","    oml.drop(model = 'ESA_MOD_2')","except:","    print('No such model')","    ","esa_mod.set_params(**new_setting).fit(train_dat, case_id = 'ID', ","                                      ctx_settings = ctx_settings,","                                      model_name='ESA_MOD_2')","","z.show(esa_mod.feature_compare(test_dat,","                        compare_cols = ['COMMENTS'],","                        supplemental_cols = ['COMMENTS']))"],"enabled":true,"result":{"startTime":1718663094988,"interpreter":"python.low","endTime":1718663096081,"results":[{"message":"No such model\n","type":"TEXT"},{"message":"COMMENTS_A\tCOMMENTS_B\tSIMILARITY\nAids in Africa: Planning for a long war\tNASA announces major Mars rover finding\t0.0\nAids in Africa: Planning for a long war\tRoad blocks for Aids\t1.0\nNASA announces major Mars rover finding\tRoad blocks for Aids\t0.0\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"List ESA model views","message":["%sql","","SELECT view_name, view_type FROM user_mining_model_views","WHERE model_name='ESA_MOD_2'","ORDER BY view_name;"],"enabled":true,"result":{"startTime":1718663096155,"interpreter":"sql.low","endTime":1718663096247,"results":[{"message":"VIEW_NAME\tVIEW_TYPE\nDM$VAESA_MOD_2\tExplicit Semantic Analysis Matrix\nDM$VFESA_MOD_2\tExplicit Semantic Analysis Features\nDM$VGESA_MOD_2\tGlobal Name-Value Pairs\nDM$VNESA_MOD_2\tNormalization and Missing Value Handling\nDM$VSESA_MOD_2\tComputed Settings\nDM$VWESA_MOD_2\tModel Build Alerts\nDM$VXESA_MOD_2\tText Features\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"The VA view shows associations among features (topics) and words","message":["%md","","*ATTRIBUTE_SUBNAME* refers to words, or tokens. The strength of the associations is measured by *COEFFICIENT*. Higher coefficient values indicate a stronger association."],"enabled":true,"result":{"startTime":1718663096314,"interpreter":"md.low","endTime":1718663096371,"results":[{"message":"<p><em>ATTRIBUTE_SUBNAME<\/em> refers to words, or tokens. The strength of the associations is measured by <em>COEFFICIENT<\/em>. Higher coefficient values indicate a stronger association.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":null,"message":["%sql","","SELECT * from dm$vaesa_mod_2 FETCH FIRST 10 ROWS ONLY"],"enabled":true,"result":{"startTime":1718663096437,"interpreter":"sql.low","endTime":1718663096507,"results":[{"message":"PARTITION_NAME\tFEATURE_ID\tATTRIBUTE_NAME\tATTRIBUTE_SUBNAME\tATTRIBUTE_VALUE\tCOEFFICIENT\n\t5\tCOMMENTS\tACCESS\t\t0.3779644730092272\n\t5\tCOMMENTS\tAIDS\t\t0.3779644730092272\n\t5\tCOMMENTS\tASIA\t\t0.3779644730092272\n\t3\tCOMMENTS\tCONFIRMS\t\t0.4049912817146355\n\t6\tCOMMENTS\tCRATER\t\t0.4067910617987843\n\t5\tCOMMENTS\tDRUG\t\t0.3779644730092272\n\t3\tCOMMENTS\tEXPRESS\t\t0.4049912817146355\n\t5\tCOMMENTS\tFOCUS\t\t0.3779644730092272\n\t6\tCOMMENTS\tIMAGE\t\t0.4067910617987843\n\t2\tCOMMENTS\tMANEUVERS\t\t0.4973300370260457\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Show the associations for selected words","message":["%sql","","SELECT ATTRIBUTE_SUBNAME, count(ATTRIBUTE_SUBNAME) FROM dm$vaesa_mod_2","WHERE ATTRIBUTE_SUBNAME='MARS'","GROUP BY ATTRIBUTE_SUBNAME"],"enabled":true,"result":{"startTime":1718663096572,"interpreter":"sql.low","endTime":1718663096684,"results":[{"message":"ATTRIBUTE_SUBNAME\tCOUNT(ATTRIBUTE_SUBNAME)\nMARS\t2\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Clean-up","message":["%python","","try:","    oml.drop(model = 'ESA_MOD')","except:","    print('No such model')","","try:","    oml.drop(model = 'ESA_MOD_2')","except:","    print('No such model')","    "],"enabled":true,"result":{"startTime":1718663096755,"interpreter":"python.low","endTime":1718663097651,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","## End of Script"],"enabled":true,"result":{"startTime":1718663097719,"interpreter":"md.low","endTime":1718663097770,"results":[{"message":"<h2 id=\"end-of-script\">End of Script<\/h2>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md"],"enabled":true,"result":{"startTime":1718663097839,"interpreter":"md.low","endTime":1718663097891,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":null,"row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"}],"version":"6","snapshot":false,"tags":null}]