[{"layout":null,"template":null,"templateConfig":null,"name":"OML4Py Feature Engineering Aggregation ","description":null,"readOnly":false,"type":"low","paragraphs":[{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":null,"title":null,"message":["%md"," "],"enabled":true,"result":{"startTime":1736203770140,"interpreter":"md.low","endTime":1736203770608,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","# OML4Py Feature Engineering: Aggregation","In this notebook, we demonstrate how to perform aggregation for min, max, mean, and count using OML4Py.","","We use the SH schema SALES table, which contains transaction records for each customer and products purchased. We create features by aggregating the amount sold for each customer and product pair.","","Copyright (c) 2026 Oracle Corporation ","###### <a href=\"https://oss.oracle.com/licenses/upl/\" target=\"_blank\">The Universal Permissive License (UPL), Version 1.0<\/a>"],"enabled":true,"result":{"startTime":1736203771059,"interpreter":"md.low","endTime":1736203771527,"results":[{"message":"<h1 id=\"oml4py-feature-engineering-aggregation\">OML4Py Feature Engineering: Aggregation<\/h1>\n<p>In this notebook, we demonstrate how to perform aggregation for min, max, mean, and count using OML4Py.<\/p>\n<p>We use the SH schema SALES table, which contains transaction records for each customer and products purchased. We create features by aggregating the amount sold for each customer and product pair.<\/p>\n<p>Copyright (c) 2026 Oracle Corporation<\/p>\n<h6 id=\"the-universal-permissive-license-upl-version-10\"><a href=\"https://oss.oracle.com/licenses/upl/\" target=\"_blank\">The Universal Permissive License (UPL), Version 1.0<\/a><\/h6>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"For more information ...","message":["%md","","* <a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a>","* <a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a>","* <a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a>","* <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/2/mlpug/cross-tabulate-data.html\" target=\"_blank\">OML4Py Cross-Tabulation<\/a>","* <a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/2/mlpug/combine-data.html\" target=\"_blank\">OML4Py Combining Data<\/a>"],"enabled":true,"result":{"startTime":1736203771989,"interpreter":"md.low","endTime":1736203772445,"results":[{"message":"<ul>\n<li><a href=\"https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/index.html\" target=\"_blank\">Oracle ADB Documentation<\/a><\/li>\n<li><a href=\"https://github.com/oracle-samples/oracle-db-examples/tree/main/machine-learning\" target=\"_blank\">OML folder on Oracle GitHub<\/a><\/li>\n<li><a href=\"https://www.oracle.com/machine-learning\" target=\"_blank\">OML Web Page<\/a><\/li>\n<li><a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/2/mlpug/cross-tabulate-data.html\" target=\"_blank\">OML4Py Cross-Tabulation<\/a><\/li>\n<li><a href=\"https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/2/mlpug/combine-data.html\" target=\"_blank\">OML4Py Combining Data<\/a><\/li>\n<\/ul>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Import Python libraries and suppress warnings","message":["%python","","import warnings","warnings.filterwarnings('ignore')","","import pandas as pd","import oml","from oml import automl"],"enabled":true,"result":{"startTime":1736203772898,"interpreter":"python.low","endTime":1736203775386,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Get a proxy object to SALES data and view a few records","message":["%python","","SALES_DF = oml.sync(query = 'select cust_id, prod_id, amount_sold from sh.sales')","","z.show(SALES_DF.head())"],"enabled":true,"result":{"startTime":1736203775835,"interpreter":"python.low","endTime":1736203776547,"results":[{"message":"CUST_ID\tPROD_ID\tAMOUNT_SOLD\n524.0\t13.0\t1205.99\n2128.0\t13.0\t1250.25\n3212.0\t13.0\t1250.25\n3375.0\t13.0\t1250.25\n5204.0\t13.0\t1250.25\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"View multiple records for each customer and product pair with count","message":["%python","","z.show(SALES_DF.crosstab(['CUST_ID', 'PROD_ID']).head(10))"],"enabled":true,"result":{"startTime":1736203776997,"interpreter":"python.low","endTime":1736203777893,"results":[{"message":"CUST_ID\tPROD_ID\tcount\n2\t13\t4\n2\t14\t12\n2\t15\t5\n2\t17\t9\n2\t18\t14\n2\t20\t1\n2\t23\t4\n2\t25\t3\n2\t26\t4\n2\t30\t9\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Compute cross tabulation using min, max, mean, and count for each customer and product","message":["%python","","MAX_DF   = SALES_DF.crosstab(['CUST_ID', 'PROD_ID'], values = 'AMOUNT_SOLD', aggfunc = oml.DataFrame.max)","MIN_DF   = SALES_DF.crosstab(['CUST_ID', 'PROD_ID'], values = 'AMOUNT_SOLD', aggfunc = oml.DataFrame.min)","MEAN_DF  = SALES_DF.crosstab(['CUST_ID', 'PROD_ID'], values = 'AMOUNT_SOLD', aggfunc = oml.DataFrame.mean)","COUNT_DF = SALES_DF.crosstab(['CUST_ID', 'PROD_ID'], values = 'AMOUNT_SOLD', aggfunc = oml.DataFrame.count)"],"enabled":true,"result":{"startTime":1736203778343,"interpreter":"python.low","endTime":1736203779546,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Join all results","message":["%python","","AGG_DF = MAX_DF.merge(MIN_DF,   on = ['CUST_ID', 'PROD_ID'], how = 'inner', suffixes =['', '']) ","AGG_DF = AGG_DF.merge(MEAN_DF,  on = ['CUST_ID', 'PROD_ID'], how = 'inner', suffixes =['', ''])","AGG_DF = AGG_DF.merge(COUNT_DF, on = ['CUST_ID', 'PROD_ID'], how = 'inner', suffixes =['', ''])"],"enabled":true,"result":{"startTime":1736203779997,"interpreter":"python.low","endTime":1736203780465,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"View aggregated data","message":["%python","","z.show(AGG_DF.round(2).head(10))"],"enabled":true,"result":{"startTime":1736203780910,"interpreter":"python.low","endTime":1736203783300,"results":[{"message":"CUST_ID\tPROD_ID\tmax(AMOUNT_SOLD)\tmin(AMOUNT_SOLD)\tmean(AMOUNT_SOLD)\tcount(AMOUNT_SOLD)\n3212.0\t13.0\t1250.25\t1205.99\t1232.34\t4.0\n3375.0\t13.0\t1250.25\t1250.25\t1250.25\t3.0\n13869.0\t13.0\t1250.25\t1205.99\t1234.33\t5.0\n2079.0\t13.0\t1232.16\t1205.99\t1218.82\t5.0\n9038.0\t13.0\t1222.87\t1205.99\t1212.1\t7.0\n25244.0\t13.0\t1237.31\t1210.21\t1226.84\t3.0\n42167.0\t13.0\t1210.21\t1210.21\t1210.21\t4.0\n7902.0\t13.0\t1232.16\t1205.99\t1216.78\t6.0\n12099.0\t13.0\t1232.99\t1205.99\t1224.98\t6.0\n25251.0\t13.0\t1222.87\t1205.99\t1209.51\t6.0\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","# End of Script"],"enabled":true,"result":{"startTime":1736203783749,"interpreter":"md.low","endTime":1736203784196,"results":[{"message":"<h1 id=\"end-of-script\">End of Script<\/h1>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md"],"enabled":true,"result":{"startTime":1736203784660,"interpreter":"md.low","endTime":1736203785109,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":true,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"}],"version":"6","snapshot":false,"tags":null}]