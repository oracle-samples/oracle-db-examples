[{"layout":null,"template":null,"templateConfig":null,"name":"OML4Py Spatial AI Geographical Regressor","description":null,"readOnly":false,"type":"low","paragraphs":[{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","# Geographical Regressor - Spatial AI in Oracle Machine Learning for Python (OML4Py)","","Oracle Machine Learning for Python (OML4Py) makes the Python environment ready for the enterprise. OML4Py integrates Python with Oracle Autonomous Database, enabling the use of Python for machine learning and visualization from database tables and views. Spatial AI is a feature of OML4Py providing algorithms and APIs to analyze, make predictions, and detect patterns from geospatial data. ","","The GeographicalRegressor uses a sklearn regressor to create a global model containing all training observations and multiple local models. Predictions are based on a weighted combination global and the local model. Because numerous local models are trained, the time to train a Geographical Regressor is significantly longer than training solely a global model. A geographical model may improve the quality of the predictions when there is spatial variance in the data.","","In this notebook, you train and compare non-spatial and GeographicalRegressor models based on sklearn RandomForestRegressor.  ","","","**Copyright (c) 2026 Oracle Corporation**","[The Universal Permissive License (UPL), Version 1.0](https://oss.oracle.com/licenses/upl/)"," "],"enabled":true,"result":{"startTime":1737652557611,"interpreter":"md.low","endTime":1737652558219,"results":[{"message":"<h1 id=\"geographical-regressor---spatial-ai-in-oracle-machine-learning-for-python-oml4py\">Geographical Regressor - Spatial AI in Oracle Machine Learning for Python (OML4Py)<\/h1>\n<p>Oracle Machine Learning for Python (OML4Py) makes the Python environment ready for the enterprise. OML4Py integrates Python with Oracle Autonomous Database, enabling the use of Python for machine learning and visualization from database tables and views. Spatial AI is a feature of OML4Py providing algorithms and APIs to analyze, make predictions, and detect patterns from geospatial data.<\/p>\n<p>The GeographicalRegressor uses a sklearn regressor to create a global model containing all training observations and multiple local models. Predictions are based on a weighted combination global and the local model. Because numerous local models are trained, the time to train a Geographical Regressor is significantly longer than training solely a global model. A geographical model may improve the quality of the predictions when there is spatial variance in the data.<\/p>\n<p>In this notebook, you train and compare non-spatial and GeographicalRegressor models based on sklearn RandomForestRegressor.<\/p>\n<p><strong>Copyright (c) 2026 Oracle Corporation<\/strong>\n<a href=\"https://oss.oracle.com/licenses/upl/\">The Universal Permissive License (UPL), Version 1.0<\/a><\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Before you begin","message":["%md","","Run the notebook **OML4Py Spatial AI Run-me-first** which loads data used in all sample notebooks."," "],"enabled":true,"result":{"startTime":1737652558842,"interpreter":"md.low","endTime":1737652559462,"results":[{"message":"<p>Run the notebook <strong>OML4Py Spatial AI Run-me-first<\/strong> which loads data used in all sample notebooks.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Load required libraries","message":["%python","","import os","import sys","import shutil","import math","import random","import matplotlib.pyplot as plt","import matplotlib.image as mpimg","from matplotlib import cm","import numpy as np","import pandas as pd","import warnings","import geopandas as gpd","","import oml","","","from shapely.geometry import Point, Polygon, LineString, box","from sklearn.preprocessing import RobustScaler","from sklearn.metrics import r2_score","from sklearn.ensemble import RandomForestRegressor","from sklearn.svm import SVR","","import oml","","# Oracle Spatial AI API","from oraclesai import SpatialDataFrame, DBSpatialDataset","from oraclesai.weights import SpatialWeights, KNNWeightsDefinition, DistanceBandWeightsDefinition","from oraclesai.analysis import MoranITest","from oraclesai.pipeline import SpatialPipeline","from oraclesai.regression import GeographicalRegressor","from oraclesai.classification import GeographicalClassifier","from oraclesai import enable_geodataframes","enable_geodataframes(z)","","random_state = 456","random.seed(random_state)"],"enabled":true,"result":{"startTime":1737652559958,"interpreter":"python.low","endTime":1737652563831,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","You will use housing data from the US Census for the City of Los Angeles to predict home values. The dataset includes house value and numerous features for regions called block groups."],"enabled":true,"result":{"startTime":1737652564358,"interpreter":"md.low","endTime":1737652564809,"results":[{"message":"<p>You will use housing data from the US Census for the City of Los Angeles to predict home values. The dataset includes house value and numerous features for regions called block groups.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Create SpatialDataFrame for LA_MEDIAN_HOUSE_VALES table","message":["%python","","houses_full = SpatialDataFrame.create(DBSpatialDataset( table='la_median_house_values'))","# convert to projected coordinate system as required fo spatial weights","houses_full = houses_full.to_crs('epsg:3857')","z.show(houses_full.head())"],"enabled":true,"result":{"startTime":1737652565346,"interpreter":"python.low","endTime":1737652565955,"results":[{"message":"GEOID\tHOUSE_VALUE_MEDIAN\tBEDROOMS_MEDIAN\tBEDROOMS_TOTAL\tCOMPLETE_KITCHEN_PERC\tCOMPLETE_PLUMBING_PERC\tEDU_LEVEL_SCORE_MEDIAN\tHOUSE_AGE_MEDIAN\tPOPULATION_DENSITY\tPOPULATION_TOTAL\tRENTED_PERC\tROOMS_MEDIAN\tROOMS_TOTAL\tUNITS_MEAN\tUNITS_MEDIAN\tUNITS_TOTAL\tYEARS_BUILT_MEDIAN\tgeometry\n060372149021\t771700\t1\t1158\t0.967\t1.0\t20\t39\t0.607\t1010\t0.863\t3.2\t2675\t29.654\t34.5\t24850.0\t1975.0\tPOLYGON ((-13178420.883 4038686.844, -13178415.429 4039069.331, -13178055.087 4039104.005, -13177934.64 4039064.089, -13177867.959 4039063.955, -13177757.308 4039017.454, -13177621.609 4039016.513, -13177610.589 4038659.697, -13177602.685 4038402.205, -13177599.345 4038344.822, -13177730.925 4038465.368, -13178420.327 4038490.365, -13178420.883 4038686.844))\n060372149022\t888800\t2\t1880\t1.0\t1.0\t20\t35\t0.303\t1568\t0.676\t3.4\t4098\t18.473\t14.5\t20745.0\t1979.0\tPOLYGON ((-13178420.327 4038490.365, -13177730.925 4038465.368, -13177599.345 4038344.822, -13177528.769 4038218.229, -13177576.302 4038115.961, -13178298.432 4038163.265, -13178419.325 4038173.747, -13178420.327 4038490.365))\n060372170011\t1554100\t3\t1149\t0.966\t0.939\t20\t75\t0.251\t1371\t0.327\t6.1\t2470\t2.666\t1.0\t1090.5\tnan\tPOLYGON ((-13179224.61 4035337.076, -13179065.98 4035459.741, -13179056.629 4035846.15, -13178831.541 4035846.956, -13178717.216 4035847.225, -13178455.615 4035815.113, -13178482.109 4035598.798, -13178613.8 4035364.619, -13178677.029 4035085.168, -13179116.407 4035185.393, -13179183.088 4035245.045, -13179224.61 4035337.076))\n060372187012\t860300\t2\t1208\t1.0\t1.0\t17\t75\t0.543\t1200\t0.562\t5.2\t2728\t6.915\t1.0\t3333.0\tnan\tPOLYGON ((-13173305.975 4034080.68, -13173256.215 4034153.626, -13173139.107 4034154.029, -13172552.565 4034156.447, -13172843.777 4033523.73, -13172856.022 4033497.132, -13173558.448 4033457.102, -13173305.975 4034080.68))\n060372197002\t654500\t2\t665\t0.947\t1.0\t15\t75\t0.4\t1055\t0.757\t3.3\t1514\t7.782\t2.0\t3369.5\tnan\tPOLYGON ((-13174667.079 4033393.429, -13174153.117 4033422.982, -13173992.037 4033432.251, -13173558.448 4033457.102, -13173737.004 4033174.071, -13173926.693 4033173.265, -13174762.368 4033169.37, -13174667.079 4033393.429))\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Select features and target variable","message":["%python","","feat_cols = [","    'BEDROOMS_TOTAL',","    'EDU_LEVEL_SCORE_MEDIAN',","    'POPULATION_DENSITY',","    'ROOMS_TOTAL',","    'COMPLETE_PLUMBING_PERC',","    'COMPLETE_KITCHEN_PERC',","    'HOUSE_AGE_MEDIAN',","    'RENTED_PERC',","    'UNITS_TOTAL'","]","","tgt_col = 'HOUSE_VALUE_MEDIAN'","","# select a subset of columns","houses = houses_full[[tgt_col] + feat_cols]","","# remove rows with null values","houses = houses.dropna()","","# show first rows","z.show(houses.head())"],"enabled":true,"result":{"startTime":1737652566517,"interpreter":"python.low","endTime":1737652567032,"results":[{"message":"HOUSE_VALUE_MEDIAN\tBEDROOMS_TOTAL\tEDU_LEVEL_SCORE_MEDIAN\tPOPULATION_DENSITY\tROOMS_TOTAL\tCOMPLETE_PLUMBING_PERC\tCOMPLETE_KITCHEN_PERC\tHOUSE_AGE_MEDIAN\tRENTED_PERC\tUNITS_TOTAL\tgeometry\n771700\t1158\t20\t0.607\t2675\t1.0\t0.967\t39\t0.863\t24850.0\tPOLYGON ((-13178420.883 4038686.844, -13178415.429 4039069.331, -13178055.087 4039104.005, -13177934.64 4039064.089, -13177867.959 4039063.955, -13177757.308 4039017.454, -13177621.609 4039016.513, -13177610.589 4038659.697, -13177602.685 4038402.205, -13177599.345 4038344.822, -13177730.925 4038465.368, -13178420.327 4038490.365, -13178420.883 4038686.844))\n888800\t1880\t20\t0.303\t4098\t1.0\t1.0\t35\t0.676\t20745.0\tPOLYGON ((-13178420.327 4038490.365, -13177730.925 4038465.368, -13177599.345 4038344.822, -13177528.769 4038218.229, -13177576.302 4038115.961, -13178298.432 4038163.265, -13178419.325 4038173.747, -13178420.327 4038490.365))\n1554100\t1149\t20\t0.251\t2470\t0.939\t0.966\t75\t0.327\t1090.5\tPOLYGON ((-13179224.61 4035337.076, -13179065.98 4035459.741, -13179056.629 4035846.15, -13178831.541 4035846.956, -13178717.216 4035847.225, -13178455.615 4035815.113, -13178482.109 4035598.798, -13178613.8 4035364.619, -13178677.029 4035085.168, -13179116.407 4035185.393, -13179183.088 4035245.045, -13179224.61 4035337.076))\n860300\t1208\t17\t0.543\t2728\t1.0\t1.0\t75\t0.562\t3333.0\tPOLYGON ((-13173305.975 4034080.68, -13173256.215 4034153.626, -13173139.107 4034154.029, -13172552.565 4034156.447, -13172843.777 4033523.73, -13172856.022 4033497.132, -13173558.448 4033457.102, -13173305.975 4034080.68))\n654500\t665\t15\t0.4\t1514\t1.0\t0.947\t75\t0.757\t3369.5\tPOLYGON ((-13174667.079 4033393.429, -13174153.117 4033422.982, -13173992.037 4033432.251, -13173558.448 4033457.102, -13173737.004 4033174.071, -13173926.693 4033173.265, -13174762.368 4033169.37, -13174667.079 4033393.429))\n","type":"TABLE"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Split the data into train, test, validation sets","message":["%python","","train, test, valid = houses.split(ratio=(0.6, 0.3, 0.1), seed=random_state)","","X_train = train.drop(tgt_col)","y_train = train[tgt_col].values","","X_test = test.drop(tgt_col)","y_test = test[tgt_col].values","","X_valid = valid.drop(tgt_col)","y_valid = valid[tgt_col].values"],"enabled":true,"result":{"startTime":1737652567585,"interpreter":"python.low","endTime":1737652576797,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Create spatial weights","message":["%python","","knn_w_def = KNNWeightsDefinition(k=3)","train_weights = SpatialWeights.create(X_train, knn_w_def)","valid_weights = SpatialWeights.create(X_valid, knn_w_def)","test_weights = SpatialWeights.create(X_test, knn_w_def)"],"enabled":true,"result":{"startTime":1737652577287,"interpreter":"python.low","endTime":1737652586076,"results":[],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Train a non-spatial RandomForestRegressor","message":["%python","","rf_model = SpatialPipeline([('model', RandomForestRegressor(n_estimators=10, random_state=random_state))])","rf_model.fit(X_train, y_train)"],"enabled":true,"result":{"startTime":1737652586578,"interpreter":"python.low","endTime":1737652587521,"results":[{"message":"SpatialPipeline(steps=[('model',\n                        RandomForestRegressor(n_estimators=10,\n                                              random_state=456))])\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","","","Next you train a GeographicalRegressor using RandomForestRegressor. Training takes considerably longer as it is training multiple local models based on the spatial weights. The fit() parameter n_jobs is used to specify the number of concurrent tasks that can be performed to train local models. The value -1 means that it will use all available CPUs. "],"enabled":true,"result":{"startTime":1737652588035,"interpreter":"md.low","endTime":1737652588478,"results":[{"message":"<p>Next you train a GeographicalRegressor using RandomForestRegressor. Training takes considerably longer as it is training multiple local models based on the spatial weights. The fit() parameter n_jobs is used to specify the number of concurrent tasks that can be performed to train local models. The value -1 means that it will use all available CPUs.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Train a GeographicalRegressor using RandomForestRegressor","message":["%python","","grf_model = GeographicalRegressor(model_cls=RandomForestRegressor, local_weight=0.8, n_estimators=10, random_state=random_state)","grf_model.fit(X_train, y=y_train, spatial_weights=train_weights, n_jobs=-1)"],"enabled":true,"result":{"startTime":1737652588962,"interpreter":"python.low","endTime":1737652612776,"results":[{"message":"GeographicalRegressor(global_model=RandomForestRegressor(n_estimators=10,\n                                                         random_state=456),\n                      local_weight=0.8,\n                      model_cls=<class 'sklearn.ensemble._forest.RandomForestRegressor'>)\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Review some predictions","message":["%python","","print(\"Test target variable\")","print(y_test[0:9]) ","print(\"\\nRandomForestRegressor\")","print(rf_model.predict(X_test)[0:9]) ","print(\"\\nGeographicalRegressor using RandomForestRegressor\")","print(grf_model.predict(X_test)[0:9])"],"enabled":true,"result":{"startTime":1737652613270,"interpreter":"python.low","endTime":1737652614977,"results":[{"message":"Test target variable\n[771700 888800 860300 477800 464600 480600 420200 384300 323300]\n\nRandomForestRegressor\n[734250. 927950. 675210. 697030. 423920. 483990. 435880. 420180. 361610.]\n\nGeographicalRegressor using RandomForestRegressor\n[ 970346. 1178294.  657074.  852374.  387832.  433982.  415832.  370196.\n  361642.]\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","Finally you compare model statistics:","* R-squared measures how well the model explains variation of the dependent variable from independent variables. Larger values indicate more reliable predictions.","* Spatial autocorrrelation in residuals measures the presence of a spatial pattern in prediction errors. Smaller values indicate more reliable predictions."],"enabled":true,"result":{"startTime":1737652615478,"interpreter":"md.low","endTime":1737652615952,"results":[{"message":"<p>Finally you compare model statistics:<\/p>\n<ul>\n<li>R-squared measures how well the model explains variation of the dependent variable from independent variables. Larger values indicate more reliable predictions.<\/li>\n<li>Spatial autocorrrelation in residuals measures the presence of a spatial pattern in prediction errors. Smaller values indicate more reliable predictions.<\/li>\n<\/ul>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Compare model statistics","message":["%python","","print('*** Non-spatial model ***')","","# validation","preds = rf_model.predict(X_valid)","r2 = r2_score(y_valid, preds)","print('Validation')","print('\\tR-squared:', r2)","","# test","print('Test results:')","preds = rf_model.predict(X_test)","r2 = r2_score(y_test, preds)","print('\\tR-squared:', r2)","","# check spatial autocorrelation in the residuals","residuals = y_test - preds","moran_i_result = MoranITest.create(residuals, test_weights)","print('\\tSpatial autocorrrelation in residuals:')","print('\\t\\tObserved I:', moran_i_result.i, '\\n\\t\\tExpected I:', moran_i_result.expected_i, '\\n\\t\\tp-value:', moran_i_result.p_value)","","print('\\n*** GeographicalRegressor model ***')","","# validation","preds = grf_model.predict(X_valid)","r2 = r2_score(y_valid, preds)","print('Validation')","print('\\tR-squared:', r2)","","# test","preds = grf_model.predict(X_test)","r2 = r2_score(y_test, preds)","print('Test')","print('\\tR-squared:', r2)","","# check spatial autocorrelation in the residuals","residuals = y_test - preds","moran_i_result = MoranITest.create(residuals, test_weights)","print('\\tSpatial autocorrrelation in residuals:')","print('\\t\\tObserved I:', moran_i_result.i, '\\n\\t\\tExpected I:', moran_i_result.expected_i, '\\n\\t\\tp-value:', moran_i_result.p_value)"," "],"enabled":true,"result":{"startTime":1737652616580,"interpreter":"python.low","endTime":1737652618820,"results":[{"message":"*** Non-spatial model ***\nValidation\n\tR-squared: 0.6340287277654035\nTest results:\n\tR-squared: 0.575448690511084\n\tSpatial autocorrrelation in residuals:\n\t\tObserved I: 0.1800356494006625 \n\t\tExpected I: -0.0005861664712778429 \n\t\tp-value: 0.001\n\n*** GeographicalRegressor model ***\nValidation\n\tR-squared: 0.7127030866785334\nTest\n\tR-squared: 0.7056500827057428\n\tSpatial autocorrrelation in residuals:\n\t\tObserved I: 0.1489903896453732 \n\t\tExpected I: -0.0005861664712778429 \n\t\tp-value: 0.001\n","type":"TEXT"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":false,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","","","","Observe that compared to a non-spatial RandomForestRegressor, GeographicalRegressor using RandomForestRegressor has a higher R-squared and lower spatial autocorrrelation in residuals, indicating that predictions will be more reliable.","","In summary, GeographicalRegressor models can improve predictions for situations where data behaves differently in different areas. One important parameter of a geographical is the description of the underlying spatial relationship which can be specified as spatial weights definitions or as spatial weights objects. For that, users need to have a prior knowledge of such spatial relationship, otherwise, it needs to be searched by trying different values. The Spatial AI API provide an automatic way to look for the spatial weights definition that better fits a model. Since GeographicalRegressor trains multiple local models, training time can be dramatically longer than regular non-spatial models."],"enabled":true,"result":{"startTime":1737652619312,"interpreter":"md.low","endTime":1737652619873,"results":[{"message":"<p>Observe that compared to a non-spatial RandomForestRegressor, GeographicalRegressor using RandomForestRegressor has a higher R-squared and lower spatial autocorrrelation in residuals, indicating that predictions will be more reliable.<\/p>\n<p>In summary, GeographicalRegressor models can improve predictions for situations where data behaves differently in different areas. One important parameter of a geographical is the description of the underlying spatial relationship which can be specified as spatial weights definitions or as spatial weights objects. For that, users need to have a prior knowledge of such spatial relationship, otherwise, it needs to be searched by trying different values. The Spatial AI API provide an automatic way to look for the spatial weights definition that better fits a model. Since GeographicalRegressor trains multiple local models, training time can be dramatically longer than regular non-spatial models.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","","## End of Script"],"enabled":true,"result":{"startTime":1737652620381,"interpreter":"md.low","endTime":1737652620871,"results":[{"message":"<h2 id=\"end-of-script\">End of Script<\/h2>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"}],"version":"6","snapshot":false,"tags":null}]